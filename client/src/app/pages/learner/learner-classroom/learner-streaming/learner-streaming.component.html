<div
  style="
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 200px;
    font-size: large;
    font-weight: bold;
  "
  *ngIf="!currentCourseId"
>
  There is no streaming at the moment. Please join one to continue.
</div>
<div class="classroom-container" *ngIf="currentCourseId">
  <div class="session-user shadow">
    <ng-container *ngIf="chatUserList.length">
      <dx-gallery
        [dataSource]="chatUserList"
        [height]="'100%'"
        [loop]="false"
        [width]="'100%'"
        [initialItemWidth]="100"
        [showNavButtons]="true"
        [showIndicator]="false"
      >
        <div class="participant shadow" *dxTemplate="let item of 'item'">
          <div class="participant-img">
            <img [src]="mapFileListToUrl(item?.id)" alt="..." />
            <!-- style="height: 100%; width: 100%" -->
          </div>
          <div class="display-name">
            {{ item?.displayName }}
          </div>
        </div>
      </dx-gallery>
    </ng-container>
  </div>
  <div class="session-blackboard box-shadow">
    <ng-container *ngIf="blackBoard.length">
      <dx-gallery
        [dataSource]="blackBoard"
        [height]="'100%'"
        [loop]="false"
        [width]="'100%'"
        [showNavButtons]="true"
        [showIndicator]="false"
        [initialItemWidth]="'80%'"
      >
        <div *dxTemplate="let item of 'item'">
          <ng-container *ngIf="isShowingLesson">
            <div
              [ngClass]="{
                'asset-container': item?.isFront === true,
                'asset-container-flip': item?.isFront === false
              }"
            >
              <div class="asset-card">
                <div class="asset-front" *ngIf="item?.isFront === true">
                  <div class="asset-title">
                    {{ item?.name }}
                  </div>
                  <div class="asset-body">
                    <dx-html-editor
                      readOnly="true"
                      [value]="item?.frontText"
                      [height]="'100%'"
                      [width]="'100%'"
                    >
                      <dxo-media-resizing [enabled]="true">
                      </dxo-media-resizing>
                    </dx-html-editor>
                  </div>
                </div>
                <div class="asset-back" *ngIf="item?.isFront === false">
                  <div class="asset-body">
                    <dx-html-editor
                      readOnly="true"
                      [height]="'100%'"
                      [width]="'100%'"
                      [value]="item?.backText"
                    >
                      <dxo-media-resizing [enabled]="true">
                      </dxo-media-resizing>
                    </dx-html-editor>
                  </div>
                </div>
                <div class="asset-button"></div>
              </div>
            </div>
          </ng-container>
          <ng-container *ngIf="isShowingQuestion">
            <div
              [ngClass]="{
                'question-container': isShowingAnswer === false,
                'question-container-flip': isShowingAnswer === true
              }"
            >
              <div class="question-card">
                <div class="question-front">
                  <div class="question-body">
                    <dx-html-editor
                      readOnly="true"
                      [value]="item?.content"
                      [height]="'100%'"
                      [width]="'100%'"
                    >
                      <dxo-media-resizing [enabled]="true">
                      </dxo-media-resizing>
                    </dx-html-editor>
                  </div>
                </div>
                <div class="asset-button"></div>
              </div>
              <div class="answer-container" *ngIf="isShowingAnswer === true">
                <div *ngFor="let answer of item?.answerResponses">
                  <dx-button
                    [ngClass]="{
                      'answer-body': isShowingAnswer === true,
                      'answer-body-correct':
                        isShowingCorrectAnswer === true &&
                        answer.isCorrect === true
                    }"
                    (onClick)="submitAnswer({ q: item, e: answer })"
                  >
                    <dx-html-editor
                      readOnly="true"
                      [value]="answer?.content"
                      [height]="'100%'"
                      [width]="'100%'"
                    >
                      <dxo-media-resizing [enabled]="true">
                      </dxo-media-resizing>
                    </dx-html-editor>
                  </dx-button>
                </div>
              </div>
            </div>
          </ng-container>
        </div>
      </dx-gallery>
    </ng-container>
  </div>
  <ng-container *ngIf="isShowingResult">
    <div class="result-view box-shadow">
      <div class="result-title neon">Test Result</div>
      <dx-scroll-view
        [scrollByContent]="true"
        [scrollByThumb]="true"
        bounceEnabled="true"
        [height]="280"
        [width]="350"
      >
        <div class="result-card shadow" *ngFor="let item of resultBoard">
          <div class="result-front">
            <div class="result-user">
              {{ item?.userAccountResponse.displayName }}
            </div>
            <div class="result-img">
              <img
                [src]="mapFileListToUrl(item?.userAccountResponse.id)"
                alt="..."
                style="height: 100%; width: 100%"
              />
            </div>
            <div class="result-body">
              <div class="answer-container shadow">
                Choice:
                <dx-html-editor
                  readOnly="true"
                  [value]="
                    item?.questionResponses[0].answerResponses[0].content
                  "
                  [height]="'100%'"
                  [width]="'100%'"
                >
                  <dxo-media-resizing [enabled]="true"> </dxo-media-resizing>
                </dx-html-editor>
              </div>
              <div class="answer-container shadow">
                Score: {{ item?.score }}
              </div>
            </div>
          </div>
          <div class="asset-button"></div>
        </div>
      </dx-scroll-view>
    </div>
  </ng-container>
</div>

<dx-popup
  id="webcam-popup"
  [title]="'Media Check'"
  [showTitle]="true"
  [shading]="true"
  [position]="'center'"
  [showCloseButton]="true"
  (onHiding)="closePopupSetting()"
  [dragEnabled]="true"
  [height]="'70%'"
  [width]="'60%'"
  [visible]="isPopupSettingVisible"
>
  <div *dxTemplate="let data of 'content'">
    <div *ngIf="!localStream">
      Please grant us permission to access camera and audio.
    </div>
    <div *ngIf="localStream" class="media-check">
      <video #localVideo id="localVideo" autoplay></video>
    </div>
  </div>
</dx-popup>
<dx-popup
  id="webcam-popup"
  [title]="'Webcam Setting'"
  [showTitle]="true"
  [shading]="true"
  [position]="'center'"
  [showCloseButton]="true"
  (onHiding)="closePopupSetting()"
  [dragEnabled]="true"
  [height]="'70%'"
  [width]="'60%'"
  [visible]="isPopupVideoVisible"
>
  <div *dxTemplate="let data of 'content'">
    <div class="content">
      <div class="videos">
        <video #localVideo id="localVideo" autoplay controls></video>
        <video #remoteVideo id="remoteVideo" autoplay controls></video>
      </div>
    </div>
  </div>
</dx-popup>

<app-chat-message-list
  [chatMessageList]="messageList"
  [sendMessage]="sendMessage"
  [closePopupChat]="closePopupChat"
  [title]="room.name"
  [userEntry]="userEntry"
  [isVisible]="isPopupChatVisible"
></app-chat-message-list>

<dx-speed-dial-action
  icon="comment"
  label="Show Chat"
  [index]="1"
  (onClick)="openPopupChat()"
>
</dx-speed-dial-action>

<dx-speed-dial-action
  icon="like"
  label="Leave Room"
  [index]="2"
  (onClick)="hangup()"
>
</dx-speed-dial-action>
