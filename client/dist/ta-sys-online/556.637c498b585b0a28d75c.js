(self.webpackChunkta_sys_online=self.webpackChunkta_sys_online||[]).push([[556],{92356:(e,t,s)=>{"use strict";s.r(t),s.d(t,{EditCourseListModule:()=>D});var o=s(61116),r=s(15419),i=s(23167),a=s(98633),n=s(65294),l=s(23651),c=(s(52279),s(62707)),h=s(82051),u=s.n(h),g=s(8619),d=s(61305),S=s(41142),p=s(42693);let m=(()=>{class e{constructor(e){this.http=e,this.apiUrl="https://ta-sys-online-server.azurewebsites.net/api/Course"}fetchCourse(e,t){const s=(new p.LE).set("PageNumber",e).set("PageSize",t);return console.log(s.toString()),this.http.get(this.apiUrl+"/paging",{params:s,reportProgress:!0,observe:"body"})}fetchCourseByLearnerID(e,t,s){const o=(new p.LE).set("PageNumber",e).set("PageSize",t).set("learnerID",s);return console.log(o.toString()),this.http.get(this.apiUrl+"/byLearnerID",{params:o,reportProgress:!0,observe:"body"})}searchCourseByName(e,t,s){const o=(new p.LE).set("value",e).set("PageNumber",t).set("PageSize",s);return console.log(o.toString()),this.http.post(this.apiUrl+"/searchByName",{},{params:o,reportProgress:!0,observe:"body"})}filterCourseByPrice(e,t,s,o){const r=(new p.LE).set("criteria",e).set("value",t).set("PageNumber",s).set("PageSize",o);return console.log(r.toString()),this.http.post(this.apiUrl,{},{params:r,reportProgress:!0,observe:"body"})}filterCourseByCategory(e,t,s){const o=(new p.LE).set("value",e).set("PageNumber",t).set("PageSize",s);return console.log(o.toString()),this.http.post(this.apiUrl+"/filterByCategory",{},{params:o,reportProgress:!0,observe:"body"})}sortCourseByName(e,t,s){const o=(new p.LE).set("value",e).set("PageNumber",t).set("PageSize",s);return console.log(o.toString()),this.http.post(this.apiUrl+"/sortByName",{},{params:o,reportProgress:!0,observe:"body"})}sortCourseByPrice(e,t,s){const o=(new p.LE).set("value",e).set("PageNumber",t).set("PageSize",s);return console.log(o.toString()),this.http.post(this.apiUrl+"/sortByPrice",{},{params:o,reportProgress:!0,observe:"body"})}uploadCourse(e){return this.http.post(this.apiUrl,e,{reportProgress:!0,observe:"body"})}generateRandomCourse(){return this.http.post(this.apiUrl+"/randomCourse",{reportProgress:!0,observe:"body"})}deleteAllCourses(){return this.http.post(this.apiUrl+"/deleteAll",{reportProgress:!0,observe:"body"})}deleteCourse(e){return this.http.delete(this.apiUrl+`/${e}`,{reportProgress:!0,observe:"body"})}getCourse(e){return this.http.get(this.apiUrl+`/${e}`,{reportProgress:!0,observe:"body"})}getCourseByMedicalCheckupID(e){const t=(new p.LE).set("medicalCheckupID",e);return console.log(t.toString()),this.http.post(this.apiUrl+"/byMedicalCheckupID",{},{params:t,reportProgress:!0,observe:"body"})}deleteSelectedCourses(e){return this.http.post(this.apiUrl+"/batch",e,{reportProgress:!0,observe:"body"})}updateCourse(e,t){return this.http.post(this.apiUrl+`/updateCourse/${t}`,e,{reportProgress:!0,observe:"body"})}fetchAll(){return this.http.get(this.apiUrl,{reportProgress:!0,observe:"body"})}}return e.\u0275fac=function(t){return new(t||e)(g.LFG(p.eN))},e.\u0275prov=g.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var y=s(10418);const f={courseList:[],selectedCourse:{},courseInstance:void 0,exportData:[],totalPages:0,currentPage:0,totalItems:0,responseMsg:""};let C=(()=>{class e extends d.b{constructor(e,t){super(f),this.courseService=e,this.store=t,this.$courseList=this.select(e=>e.courseList),this.$exportData=this.select(e=>e.exportData),this.$totalPages=this.select(e=>e.totalPages),this.$totalItems=this.select(e=>e.totalItems),this.$currentPage=this.select(e=>e.currentPage),this.$selectedCourse=this.select(e=>e.selectedCourse),this.$courseInstance=this.select(e=>e.courseInstance)}fillEmpty(e,t,s,o){let r=s;console.log("FILL INDEX");let i=e*t;console.log(i);for(var a=0;a<o.length;a++)r[i]=o[a],i++;return console.log("Filled array result"),console.log(r),r}initInfiniteData(e,t){return this.courseService.fetchCourse(e,t).toPromise().then(s=>{this.setState(0===e?{courseList:new Array(t)}:{courseList:new Array(e*t)}),console.log("Current flag: infite list"),console.log(this.state.courseList),this.setState({totalItems:s.totalRecords}),this.setState({totalPages:s.totalPages}),this.setState({currentPage:s.pageNumber})}).then(()=>{this.loadDataAsync(e,t)})}loadInfiniteDataAsync(e,t){this.setIsLoading(!0),this.courseService.fetchCourse(e,t).subscribe({next:e=>{this.setState({courseList:this.state.courseList.concat(e)}),console.log("Infinite list"),console.log(this.state.courseList),console.log("Server response"),console.log(e),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber}),this.setIsLoading(!1)},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}})}loadDataAsyncByLearnerID(e,t,s){this.setIsLoading(!0),this.courseService.fetchCourseByLearnerID(e,t,s).subscribe({next:s=>{this.setState({courseList:this.fillEmpty(e,t,this.state.courseList,s)}),console.log("Pure list"),console.log(this.state.courseList),console.log("Server response"),console.log(s),this.setState({totalItems:s.totalRecords}),this.setState({totalPages:s.totalPages}),this.setState({currentPage:s.pageNumber}),this.setIsLoading(!1)},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}})}initInfiniteDataByLearnerID(e,t,s){return this.courseService.fetchCourseByLearnerID(e,t,s).toPromise().then(e=>{this.setState({courseList:new Array(e.length)}),console.log("Current flag: infite list"),console.log(this.state.courseList),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber})}).then(()=>{this.loadDataAsyncByLearnerID(e,t,s)})}loadInfiniteDataAsyncByLearnerID(e,t,s){this.setIsLoading(!0),this.courseService.fetchCourseByLearnerID(e,t,s).subscribe({next:e=>{this.setState({courseList:this.state.courseList.concat(e)}),console.log("Infinite list"),console.log(this.state.courseList),console.log("Server response"),console.log(e),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber}),this.setIsLoading(!1)},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}})}initData(e,t){this.courseService.fetchCourse(e,t).toPromise().then(e=>{this.setState({courseList:new Array(e.totalRecords)}),console.log("Current flag: pure list"),console.log(this.state.courseList),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber})}).then(()=>{this.loadDataAsync(e,t)})}initFilterByCategoryData(e,t,s){this.store.showNotif("Filtered Mode On","custom"),this.courseService.filterCourseByCategory(e,0,5).toPromise().then(e=>{this.setState({courseList:new Array(e.totalRecords)}),console.log("Current flag: filtered list"),console.log(this.state.courseList),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber})}).then(()=>{this.filterCourseByCategory(e,t,s)})}initInfiniteFilterByCategoryData(e,t,s){this.store.showNotif("Filtered Mode On","custom"),this.courseService.filterCourseByCategory(e,t,s).toPromise().then(e=>{this.setState({courseList:new Array(s)}),console.log("Current flag: infinite filtered list"),console.log(this.state.courseList),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber})}).then(()=>{this.filterCourseByCategory(e,t,s)})}initSearchByNameData(e,t,s){this.store.showNotif("Searched Mode On","custom"),this.courseService.searchCourseByName(e,0,5).toPromise().then(e=>{this.setState({courseList:new Array(e.totalRecords)}),console.log("Current flag: searched list"),console.log(this.state.courseList),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber})}).then(()=>{this.searchCourseByName(e,t,s)})}initInfiniteSearchByNameData(e,t,s){this.store.showNotif("Searched Mode On","custom"),this.courseService.searchCourseByName(e,t,s).toPromise().then(e=>{0!==e.totalRecords?this.setState({courseList:new Array(s)}):this.store.showNotif("No result found!","custom"),console.log("Current flag: infitite searched list"),console.log(this.state.courseList),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber})}).then(()=>{this.searchCourseByName(e,t,s)})}initSortByPriceData(e,t,s){this.store.showNotif("Sort Mode On","custom"),this.courseService.sortCourseByPrice(e,0,5).toPromise().then(e=>{this.setState({courseList:new Array(e.totalRecords)}),console.log("Current flag: sort list"),console.log(this.state.courseList),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber})}).then(()=>{this.sortCourseByPrice(e,t,s)})}initInfiniteSortByPriceData(e,t,s){this.store.showNotif("Sort Mode On","custom"),this.courseService.sortCourseByPrice(e,t,s).toPromise().then(e=>{this.setState({courseList:new Array(s)}),console.log("Current flag: sort list"),console.log(this.state.courseList),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber})}).then(()=>{this.sortCourseByPrice(e,t,s)})}loadDataAsync(e,t){this.setIsLoading(!0),this.courseService.fetchCourse(e,t).subscribe({next:s=>{this.setState({courseList:this.fillEmpty(e-1,t,this.state.courseList,s.data)}),console.log("Pure list"),console.log(this.state.courseList),console.log("Server response"),console.log(s),this.setState({totalItems:s.totalRecords}),this.setState({totalPages:s.totalPages}),this.setState({currentPage:s.pageNumber}),this.setIsLoading(!1)},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}})}refresh(e,t){this.setIsLoading(!0),this.courseService.fetchCourse(e,t).subscribe({next:s=>{this.setState({courseList:this.fillEmpty(e,t,this.state.courseList,s)}),this.setState({totalItems:s.totalRecords}),this.setState({totalPages:s.totalPages}),this.setState({currentPage:s.pageNumber}),console.log("Pure list"),console.log(this.state.courseList),console.log("Server response"),console.log(s),this.store.showNotif("Refresh successfully","custom"),this.setIsLoading(!1)},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}})}setIsLoading(e){this.store.setIsLoading(e)}uploadCourse(e,t,s){this.confirmDialog("").then(o=>{o&&(this.setIsLoading(!0),this.courseService.uploadCourse(e).subscribe({next:e=>{this.setState({responseMsg:e}),this.setTotalItems(this.state.totalItems+1),console.log(e),this.loadDataAsync(t,s),this.setIsLoading(!1),this.store.showNotif(e.responseMessage,"custom")},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}}))})}updateCourse(e,t,s,o){this.confirmDialog("").then(r=>{r&&(this.setIsLoading(!0),this.courseService.updateCourse(e,t).subscribe({next:e=>{this.setState({responseMsg:e}),console.log(e),this.loadDataAsync(s,o),this.setIsLoading(!1),this.store.showNotif(e.responseMessage,"custom")},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}}))})}confirmDialog(e){return(0,S.iG)(""!=e?`<b>${e}</b>`:"<b>Are you sure?</b>","Confirm changes")}deleteSelectedCourses(e,t,s){this.confirmDialog("").then(o=>{o&&(this.setIsLoading(!0),this.courseService.deleteSelectedCourses(e).subscribe({next:e=>{this.setState({responseMsg:e}),console.log(e),this.loadDataAsync(t,s),console.log(this.state.courseList),this.setIsLoading(!1),this.store.showNotif(e.responseMessage,"custom")},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}}))})}deleteAllCourses(){this.confirmDialog("Delete all items?").then(e=>{e&&(this.setIsLoading(!0),this.courseService.deleteAllCourses().subscribe({next:e=>{this.setState({responseMsg:e}),this.setState({courseList:[]}),this.setState({totalPages:0}),this.setState({currentPage:0}),this.setState({totalItems:0}),console.log(e),this.setIsLoading(!1),this.store.showNotif(e.responseMessage,"custom")},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}}))})}deleteCourse(e,t,s){this.confirmDialog("").then(o=>{o&&(this.setIsLoading(!0),this.courseService.deleteCourse(e).subscribe({next:e=>{this.setState({responseMsg:e}),this.setTotalItems(this.state.totalItems-1),console.log(e),this.loadDataAsync(t,s),this.setIsLoading(!1),this.store.showNotif(e.responseMessage,"custom")},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}}))})}selectCourse(e){this.setState({selectedCourse:e})}setTotalPages(e){this.setState({totalPages:e})}setTotalItems(e){this.setState({totalItems:e})}setCurrentPage(e){this.setState({currentPage:e})}filterCourseByPrice(e,t,s,o){this.setIsLoading(!0),this.courseService.filterCourseByPrice(e,t,s,o).subscribe({next:e=>{this.setState({responseMsg:e}),this.setState({courseList:this.fillEmpty(s,o,this.state.courseList,e)}),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber}),this.setIsLoading(!1)},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}})}filterCourseByCategory(e,t,s){this.setIsLoading(!0),this.courseService.filterCourseByCategory(e,t,s).subscribe({next:e=>{this.setState({courseList:this.fillEmpty(t,s,this.state.courseList,e)}),console.log("Filtered list"),console.log(this.state.courseList),console.log("Server response"),console.log(e),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber}),this.setIsLoading(!1)},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}})}filterInfiniteCourseByCategory(e,t,s){this.setIsLoading(!0),this.courseService.filterCourseByCategory(e,t,s).subscribe({next:e=>{this.setState({courseList:this.state.courseList.concat(e)}),console.log("Filtered list"),console.log(this.state.courseList),console.log("Server response"),console.log(e),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber}),this.setIsLoading(!1)},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}})}searchCourseByName(e,t,s){this.setIsLoading(!0),this.courseService.searchCourseByName(e,t,s).subscribe({next:e=>{0!==e.totalRecords?this.setState({courseList:this.fillEmpty(t,s,this.state.courseList,e)}):this.store.showNotif("No result found!","custom"),console.log("Searched list"),console.log(this.state.courseList),console.log("Server response"),console.log(e),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber}),this.setIsLoading(!1)},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}})}searchInfiniteCourseByName(e,t,s){this.setIsLoading(!0),this.courseService.searchCourseByName(e,t,s).subscribe({next:e=>{0!==e.totalRecords?this.setState({courseList:this.state.courseList.concat(e)}):this.store.showNotif("No result found!","custome"),console.log("Infite searched list"),console.log(this.state.courseList),console.log("Server response"),console.log(e),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber}),this.setIsLoading(!1)},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}})}sortCourseByName(e,t,s){this.setIsLoading(!0),this.courseService.sortCourseByName(e,t,s).subscribe({next:e=>{this.setState({responseMsg:e}),this.setState({courseList:this.fillEmpty(t,s,this.state.courseList,e)}),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber}),console.log("Sorted list"),console.log(this.state.courseList),console.log("Server response"),console.log(e),this.setIsLoading(!1)},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}})}sortCourseByPrice(e,t,s){this.setIsLoading(!0),this.courseService.sortCourseByPrice(e,t,s).subscribe({next:e=>{this.setState({responseMsg:e}),this.setState({courseList:this.fillEmpty(t,s,this.state.courseList,e)}),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber}),console.log("Sorted list"),console.log(this.state.courseList),console.log("Server response"),console.log(e),this.setIsLoading(!1)},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}})}sortInfiniteCourseByPrice(e,t,s){this.setIsLoading(!0),this.courseService.sortCourseByPrice(e,t,s).subscribe({next:e=>{this.setState({courseList:this.state.courseList.concat(e)}),console.log("Infite sorted list"),console.log(this.state.courseList),console.log("Server response"),console.log(e),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber}),this.setIsLoading(!1)},error:e=>{this.setIsLoading(!1),this.store.showNotif(e.error.responseMessage,"error"),console.log(e)}})}getCourse(e){return this.setIsLoading(!0),this.courseService.getCourse(e).toPromise().then(e=>{this.setState({courseInstance:e}),console.log(e),this.setIsLoading(!1)})}getCourseByMedicalCheckupID(e){return this.setIsLoading(!0),this.courseService.getCourseByMedicalCheckupID(e).toPromise().then(e=>{this.setState({courseInstance:e}),console.log(e),this.setIsLoading(!1)})}setExportData(e){this.setState({courseList:e})}}return e.\u0275fac=function(t){return new(t||e)(g.LFG(m),g.LFG(y.d))},e.\u0275prov=g.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var I=s(69333),P=s(52177),L=s(86101),b=s(83584);function x(e,t){if(1&e&&(g.TgZ(0,"div"),g.TgZ(1,"div",30),g._uU(2),g.qZA(),g.qZA()),2&e){const e=g.oxw();g.xp6(2),g.Oqu(e.selectInfoText)}}function N(e,t){if(1&e&&(g.TgZ(0,"div"),g.TgZ(1,"span"),g._uU(2),g.qZA(),g.qZA()),2&e){const e=g.oxw();g.xp6(2),g.hij("Total Course: ",e.courseList.length," ")}}const w=function(){return{paddingLeft:"25px",paddingRight:"25px"}},v=[{path:"",component:(()=>{class e{constructor(e,t,s,o){this.courseStore=e,this.store=t,this.courseHTTP=s,this.router=o,this.discountList=[{_id:"-1",name:"(NONE)"},{_id:"0",name:"YES"},{_id:"1",name:"NO"}],this.pageSize=5,this.allowedPageSizes=[5,10,15],this.scrollingMode="standard"}onToolbarPreparing(e){e.toolbarOptions.items.unshift({location:"before",template:"totalCourseCount"},{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"normal",icon:"refresh",hint:"Fetch data from server",onClick:this.onRefresh.bind(this)}},{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"danger",icon:"trash",hint:"Delete all items",onClick:this.deleteAll.bind(this)}},{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"danger",icon:"parentfolder",hint:"Generate random 100+ items",onClick:this.onAddRandom.bind(this)}},{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"normal",icon:"exportpdf",hint:"Export to PDF",onClick:this.exportGridToPdf.bind(this)}},{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"normal",icon:"xlsxfile",hint:"Export to Excel",onClick:this.exportDataGridToExcel.bind(this)}},{location:"before",widget:"dxTextBox",options:{valueChangeEvent:"keyup",showClearButton:!0,onKeyUp:this.onSearchKeyupHandler.bind(this),onValueChanged:this.onSearchValueChanged.bind(this),mode:"search",placeholder:"Search id"}},{location:"center",locateInMenu:"auto",widget:"dxButton",options:{type:"normal",icon:"filter",disabled:!0,hint:"Filter with health insurance"}},{location:"center",locateInMenu:"auto",widget:"dxSelectBox",options:{items:this.discountList,valueExpr:"name",displayExpr:"name",placeholder:"Filter with health insurance",onValueChanged:this.onFilterChange.bind(this)}},{location:"center",locateInMenu:"auto",widget:"dxButton",options:{type:"normal",icon:"card",disabled:!0,hint:"Sort by total cost"}},{location:"center",locateInMenu:"auto",widget:"dxSelectBox",options:{items:[{_id:"-1",name:"(NONE)"},{_id:"0",name:"ASC"},{_id:"1",name:"DESC"}],valueExpr:"name",placeholder:"Sort by total cost",displayExpr:"name",onValueChanged:this.onSortValueChanged.bind(this)}})}onSearchKeyupHandler(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.isSearchingByName=!0,this.isFilteringByCategory=!1,this.isSortingByName=!1,console.log(this.currentSearchByNameValue),""!==this.currentSearchByNameValue?this.courseStore.initSearchByNameData(this.currentSearchByNameValue,this.dataGrid.instance.pageIndex(),this.pageSize):(this.store.showNotif("SEARCH MODE OFF","custom"),this.onRefresh())},1250)}onSearchValueChanged(e){this.currentSearchByNameValue=e.value}onSortValueChanged(e){this.isSortingByName=!0,this.isSearchingByName=!1,this.isFilteringByCategory=!1,this.currentSortByPriceValue=e.value,"(NONE)"!==e.value?this.courseStore.initSortByPriceData(e.value,this.dataGrid.instance.pageIndex(),this.pageSize):(this.store.showNotif("SORT MODE OFF","custom"),this.onRefresh())}onFilterChange(e){this.isFilteringByCategory=!0,this.isSearchingByName=!1,this.isSortingByName=!1,this.currentCategoryFilterValue=e.value,console.log(e.value),"(NONE)"!==e.value?this.courseStore.initFilterByCategoryData(e.value,this.dataGrid.instance.pageIndex(),this.pageSize):(this.store.showNotif("FILTER MODE OFF","custom"),this.onRefresh())}checkEditorMode(){return!0===this.isFilteringByCategory?"FILTER":!0===this.isSearchingByName?"SEARCH":!0===this.isSortingByName?"SORT":"NORMAL"}onOptionChanged(e){const t=this.checkEditorMode();if("paging.pageIndex"===e.fullName){const s=e.value+1;switch(console.log(`New page index: ${s}. Total items: ${this.courseList.length}`),t){case"NORMAL":this.paginatePureData(s);break;case"FILTER":this.paginateFilterData(s);break;case"SEARCH":this.paginateSearchData(s);break;case"SORT":this.paginateSortData(s)}}if("paging.pageSize"===e.fullName)switch(this.pageSize=e.value,console.log(`Page size changed to ${e.value}`),t){case"NORMAL":this.courseStore.loadDataAsync(this.currentIndexFromServer,e.value),this.goToPage(this.currentIndexFromServer);break;case"FILTER":this.courseStore.filterCourseByCategory(this.currentCategoryFilterValue,this.currentIndexFromServer,e.value),this.goToPage(this.currentIndexFromServer);break;case"SEARCH":this.courseStore.searchCourseByName(this.currentSearchByNameValue,this.currentIndexFromServer,e.value),this.goToPage(this.currentIndexFromServer);break;case"SORT":this.courseStore.sortCourseByPrice(this.currentSortByPriceValue,this.currentIndexFromServer,e.value),this.goToPage(this.currentIndexFromServer)}}paginatePureData(e){this.courseStore.loadDataAsync(e,this.pageSize)}paginateFilterData(e){0===e?(this.courseStore.filterCourseByCategory(this.currentCategoryFilterValue,e,this.pageSize),this.courseStore.filterCourseByCategory(this.currentCategoryFilterValue,e+1,this.pageSize)):(this.courseStore.filterCourseByCategory(this.currentCategoryFilterValue,e,this.pageSize),this.courseStore.filterCourseByCategory(this.currentCategoryFilterValue,e+1,this.pageSize),this.courseStore.filterCourseByCategory(this.currentCategoryFilterValue,e-1,this.pageSize))}paginateSearchData(e){0===e?(this.courseStore.searchCourseByName(this.currentSearchByNameValue,e,this.pageSize),this.courseStore.searchCourseByName(this.currentSearchByNameValue,e+1,this.pageSize)):(this.courseStore.searchCourseByName(this.currentSearchByNameValue,e,this.pageSize),this.courseStore.searchCourseByName(this.currentSearchByNameValue,e+1,this.pageSize),this.courseStore.searchCourseByName(this.currentSearchByNameValue,e-1,this.pageSize))}paginateSortData(e){0===e?(this.courseStore.sortCourseByPrice(this.currentSortByPriceValue,e,this.pageSize),this.courseStore.sortCourseByPrice(this.currentSortByPriceValue,e+1,this.pageSize)):(this.courseStore.sortCourseByPrice(this.currentSortByPriceValue,e,this.pageSize),this.courseStore.sortCourseByPrice(this.currentSortByPriceValue,e+1,this.pageSize),this.courseStore.sortCourseByPrice(this.currentSortByPriceValue,e-1,this.pageSize))}onEditingStart(){this.store.showNotif("Edit mode on","custom")}onInitNewRow(){this.store.showNotif("Blank row added, please fill in information","custom")}onSaved(e){if(e.changes.length)switch(e.changes[0].type){case"insert":this.courseStore.uploadCourse(e.changes[0].data,this.dataGrid.instance.pageIndex(),this.pageSize);break;case"update":console.log(e.changes[0]),this.courseStore.updateCourse(e.changes[0].data,e.changes[0].key,this.dataGrid.instance.pageIndex(),this.pageSize);break;case"remove":this.courseStore.deleteCourse(e.changes[0].key,this.dataGrid.instance.pageIndex(),this.pageSize)}else this.store.showNotif("No changes dectected","custom")}onEditCanceled(){this.store.showNotif("Editing cancelled","custom")}selectionChangedHandler(){this.selectedRows.length?(this.isSelectInfoVisible=!0,this.selectInfoText=`${this.selectedRows.length} rows selected`,this.selectedRows.forEach(e=>{console.log(e)})):this.isSelectInfoVisible=!1}changePageSize(e){this.dataGrid.instance.pageSize(e)}goToPage(e){this.dataGrid.instance.pageIndex(e)}deleteSelectedItems(){this.store.setIsLoading(!0);const e=this.checkEditorMode();this.selectedRows.length&&this.courseStore.confirmDialog("").then(t=>{t&&this.courseHTTP.deleteSelectedCourses(this.selectedRows).toPromise().then(()=>{switch(this.store.showNotif(`${this.selectedRows.length} items deleted`,"custom"),this.clearSelection(),e){case"NORMAL":this.courseStore.initData(this.dataGrid.instance.pageIndex(),this.pageSize);break;case"FILTER":this.courseStore.initFilterByCategoryData(this.currentCategoryFilterValue,this.dataGrid.instance.pageIndex(),this.pageSize);break;case"SORT":this.courseStore.initSortByPriceData(this.currentSortByPriceValue,this.dataGrid.instance.pageIndex(),this.pageSize);break;case"SEARCH":this.courseStore.initSearchByNameData(this.currentSearchByNameValue,this.dataGrid.instance.pageIndex(),this.pageSize)}this.isSelectInfoVisible=!1}).then(()=>{this.store.setIsLoading(!1)})})}clearSelection(){this.selectedRows=[]}onRefresh(){this.isFilteringByCategory=!1,this.isSearchingByName=!1,this.isSortingByName=!1,this.courseStore.initData(this.dataGrid.instance.pageIndex()+1,this.pageSize)}onAddRandom(){this.courseStore.confirmDialog("This will generate random 100+ items in database. Are you sure").then(e=>{e&&(this.isFilteringByCategory=!1,this.store.setIsLoading(!0),this.courseHTTP.generateRandomCourse().toPromise().then(()=>{this.courseStore.initData(this.dataGrid.instance.pageIndex(),this.pageSize)}).then(()=>{this.store.setIsLoading(!1),this.store.showNotif("Generated 100+ random items","custom")}))})}exportDataGridToExcel(){this.courseStore.confirmDialog("This will export all fetched data to excel. Are you sure?").then(e=>{e&&(this.store.setIsLoading(!0),this.courseHTTP.fetchAll().toPromise().then(e=>{this.courseStore.setExportData(e),console.log(e),setTimeout(()=>{const e=new c.Workbook,t=e.addWorksheet("Course List");(0,a.d)({component:this.dataGrid.instance,worksheet:t,autoFilterEnabled:!0}).then(()=>{e.xlsx.writeBuffer().then(e=>{u()(new Blob([e],{type:"application/octet-stream"}),"Course_List.xlsx"),this.store.setIsLoading(!1),this.store.showNotif("Export succesully","custom")})})},200)}))})}exportGridToPdf(e){this.courseStore.confirmDialog("This will export all data to pdf. Are you sure?").then(e=>{e&&(this.store.setIsLoading(!0),this.courseHTTP.fetchAll().toPromise().then(e=>{this.courseStore.setExportData(e),console.log(e),setTimeout(()=>{const e=new l.jsPDF;(0,n.d)({jsPDFDocument:e,component:this.dataGrid.instance}).then(()=>{e.save("Course_List.pdf"),this.store.setIsLoading(!1),this.store.showNotif("Export succesully","custom")})},200)}))})}deleteAll(){this.courseStore.deleteAllCourses()}navigateToStatistics(){this.router.navigate(["/statistics"])}sourceDataListener(){return this.courseStore.$courseList.subscribe(e=>{this.courseList=e})}currentPageListener(){return this.courseStore.$currentPage.subscribe(e=>{this.currentIndexFromServer=e})}ngOnInit(){this.sourceDataListener(),this.currentPageListener(),setTimeout(()=>{this.onRefresh()},150)}ngOnDestroy(){this.sourceDataListener().unsubscribe(),this.currentPageListener().unsubscribe(),this.onRefresh()}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(C),g.Y36(y.d),g.Y36(m),g.Y36(r.F0))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-edit-course-list"]],viewQuery:function(e,t){if(1&e&&g.Gf(i.e,5),2&e){let e;g.iGM(e=g.CRH())&&(t.dataGrid=e.first)}},decls:41,vars:30,consts:[[3,"ngStyle"],[3,"location","text"],["location","center","locateInMenu","auto",3,"visible"],[4,"dxTemplate"],["location","center","locateInMenu","auto"],["icon","trash","type","danger","hint","Delete current selected items",3,"visible","onClick"],["location","after","locateInMenu","auto"],["icon","arrowright","type","outline","text","Statistics","hint","Navigate to Statistics",3,"onClick"],["id","gridContainer","keyExpr","id",3,"dataSource","showBorders","allowColumnReordering","rowAlternationEnabled","columnHidingEnabled","selectedRowKeys","sorting","selectedRowKeysChange","onOptionChanged","onSelectionChanged","onEditingStart","onInitNewRow","onSaved","onEditCanceled","onToolbarPreparing"],[3,"allowUpdating","allowDeleting","allowAdding","useIcons","selectTextOnEditStart"],["mode","multiple",3,"selectAllMode","showCheckBoxesMode"],["expandMode","rowClick",3,"contextMenuEnabled"],["mode","select",3,"enabled"],[3,"pageSize"],[3,"visible","displayMode","allowedPageSizes","showPageSizeSelector","showNavigationButtons"],[3,"enabled"],["dataField","name"],["type","required"],["dataField","summary"],["dataField","duration"],["dataField","description"],["dataField","availableSlot"],["dataField","maxSlot"],["dataField","rating"],["dataField","feedback"],["dataField","ratingCount"],["dataField","cost"],["dataField","subjectId"],["dataField","instructorId"],[4,"dxTemplate","dxTemplateOf"],[2,"font-size","small"]],template:function(e,t){1&e&&(g.TgZ(0,"dx-toolbar",0),g._UZ(1,"dxi-item",1),g.TgZ(2,"dxi-item",2),g.YNc(3,x,3,1,"div",3),g.qZA(),g.TgZ(4,"dxi-item",4),g.TgZ(5,"dx-button",5),g.NdJ("onClick",function(){return t.deleteSelectedItems()}),g.qZA(),g.qZA(),g.TgZ(6,"dxi-item",6),g.TgZ(7,"dx-button",7),g.NdJ("onClick",function(){return t.navigateToStatistics()}),g.qZA(),g.qZA(),g.qZA(),g.TgZ(8,"dx-data-grid",8),g.NdJ("selectedRowKeysChange",function(e){return t.selectedRows=e})("onOptionChanged",function(e){return t.onOptionChanged(e)})("onSelectionChanged",function(){return t.selectionChangedHandler()})("onEditingStart",function(){return t.onEditingStart()})("onInitNewRow",function(){return t.onInitNewRow()})("onSaved",function(e){return t.onSaved(e)})("onEditCanceled",function(){return t.onEditCanceled()})("onToolbarPreparing",function(e){return t.onToolbarPreparing(e)}),g._UZ(9,"dxo-editing",9),g._UZ(10,"dxo-selection",10),g._UZ(11,"dxo-grouping",11),g._UZ(12,"dxo-column-chooser",12),g._UZ(13,"dxo-paging",13),g._UZ(14,"dxo-pager",14),g._UZ(15,"dxo-load-panel",15),g.TgZ(16,"dxi-column",16),g._UZ(17,"dxi-validation-rule",17),g.qZA(),g.TgZ(18,"dxi-column",18),g._UZ(19,"dxi-validation-rule",17),g.qZA(),g.TgZ(20,"dxi-column",19),g._UZ(21,"dxi-validation-rule",17),g.qZA(),g.TgZ(22,"dxi-column",20),g._UZ(23,"dxi-validation-rule",17),g.qZA(),g.TgZ(24,"dxi-column",21),g._UZ(25,"dxi-validation-rule",17),g.qZA(),g.TgZ(26,"dxi-column",22),g._UZ(27,"dxi-validation-rule",17),g.qZA(),g.TgZ(28,"dxi-column",23),g._UZ(29,"dxi-validation-rule",17),g.qZA(),g.TgZ(30,"dxi-column",24),g._UZ(31,"dxi-validation-rule",17),g.qZA(),g.TgZ(32,"dxi-column",25),g._UZ(33,"dxi-validation-rule",17),g.qZA(),g.TgZ(34,"dxi-column",26),g._UZ(35,"dxi-validation-rule",17),g.qZA(),g.TgZ(36,"dxi-column",27),g._UZ(37,"dxi-validation-rule",17),g.qZA(),g.TgZ(38,"dxi-column",28),g._UZ(39,"dxi-validation-rule",17),g.qZA(),g.YNc(40,N,3,1,"div",29),g.qZA()),2&e&&(g.Q6J("ngStyle",g.DdM(29,w)),g.xp6(1),g.Q6J("location","before")("text","Course Mananagement"),g.xp6(1),g.Q6J("visible",t.isSelectInfoVisible),g.xp6(3),g.Q6J("visible",t.isSelectInfoVisible),g.xp6(3),g.Q6J("dataSource",t.courseList)("showBorders",!0)("allowColumnReordering",!0)("rowAlternationEnabled",!0)("columnHidingEnabled",!0)("selectedRowKeys",t.selectedRows)("sorting",!1),g.xp6(1),g.Q6J("allowUpdating",!0)("allowDeleting",!0)("allowAdding",!0)("useIcons",!0)("selectTextOnEditStart",!0),g.xp6(1),g.Q6J("selectAllMode","page")("showCheckBoxesMode","onClick"),g.xp6(1),g.Q6J("contextMenuEnabled",!0),g.xp6(1),g.Q6J("enabled",!0),g.xp6(1),g.Q6J("pageSize",t.pageSize),g.xp6(1),g.Q6J("visible",!0)("displayMode","adaptive")("allowedPageSizes",t.allowedPageSizes)("showPageSizeSelector",!0)("showNavigationButtons",!0),g.xp6(1),g.Q6J("enabled",!0),g.xp6(25),g.Q6J("dxTemplateOf","totalCourseCount"))},directives:[I.G,o.PC,P.ZT3,L.p6,b.K,i.e,P.Uo8,P.Lz9,P.uCj,P.Auv,P.sXh,P.ilc,P.mKI,P.qvW,P.vrV],styles:[""]}),e})()}];let B=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[r.Bz.forChild(v)],r.Bz]}),e})(),D=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[o.ez,B,i.x,I.k,b.e]]}),e})()}}]);