(self.webpackChunkta_sys_online=self.webpackChunkta_sys_online||[]).push([[55],{73055:(t,e,o)=>{"use strict";o.r(e),o.d(e,{EditRoomListModule:()=>C});var s=o(61116),i=o(15419),r=o(47592),a=o(98633),n=o(65294),l=o(23651),h=(o(52279),o(62707)),c=o(82051),g=o.n(c),m=o(8619),d=o(61305),u=o(41142),S=o(42693);let p=(()=>{class t{constructor(t){this.http=t,this.apiUrl="https://ta-sys-online-server.azurewebsites.net/api/Room"}fetchRoom(t,e){const o=(new S.LE).set("page",t).set("size",e);return console.log(o.toString()),this.http.get(this.apiUrl,{params:o,reportProgress:!0,observe:"body"})}searchRoomByName(t,e,o){const s=(new S.LE).set("value",t).set("page",e).set("size",o);return console.log(s.toString()),this.http.post(this.apiUrl+"/searchByName",{},{params:s,reportProgress:!0,observe:"body"})}filterRoomByPrice(t,e,o,s){const i=(new S.LE).set("criteria",t).set("value",e).set("page",o).set("size",s);return console.log(i.toString()),this.http.post(this.apiUrl,{},{params:i,reportProgress:!0,observe:"body"})}filterRoomByCategory(t,e,o){const s=(new S.LE).set("value",t).set("page",e).set("size",o);return console.log(s.toString()),this.http.post(this.apiUrl+"/filterByCategory",{},{params:s,reportProgress:!0,observe:"body"})}sortRoomByName(t,e,o){const s=(new S.LE).set("value",t).set("page",e).set("size",o);return console.log(s.toString()),this.http.post(this.apiUrl+"/sortByName",{},{params:s,reportProgress:!0,observe:"body"})}sortRoomByPrice(t,e,o){const s=(new S.LE).set("value",t).set("page",e).set("size",o);return console.log(s.toString()),this.http.post(this.apiUrl+"/sortByPrice",{},{params:s,reportProgress:!0,observe:"body"})}uploadRoom(t){return this.http.post(this.apiUrl,t,{reportProgress:!0,observe:"body"})}generateRandomRoom(){return this.http.post(this.apiUrl+"/randomRoom",{},{reportProgress:!0,observe:"body"})}deleteAllRooms(){return this.http.post(this.apiUrl+"/deleteAll",{},{reportProgress:!0,observe:"body"})}deleteRoom(t){return this.http.delete(this.apiUrl+`/${t}`,{reportProgress:!0,observe:"body"})}getRoom(t){return this.http.get(this.apiUrl+`/${t}`,{reportProgress:!0,observe:"body"})}deleteSelectedRooms(t){return this.http.post(this.apiUrl+"/batch",t,{reportProgress:!0,observe:"body"})}updateRoom(t,e){return this.http.post(this.apiUrl+`/updateRoom/${e}`,t,{reportProgress:!0,observe:"body"})}fetchAll(){return this.http.post(this.apiUrl+"/fetchAll",{},{reportProgress:!0,observe:"body"})}}return t.\u0275fac=function(e){return new(e||t)(m.LFG(S.eN))},t.\u0275prov=m.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var y=o(86150);const f={roomList:[],selectedRoom:{},roomInstance:void 0,exportData:[],totalPages:0,currentPage:0,totalItems:0,responseMsg:""};let I=(()=>{class t extends d.b{constructor(t,e){super(f),this.roomService=t,this.store=e,this.$roomList=this.select(t=>t.roomList),this.$exportData=this.select(t=>t.exportData),this.$totalPages=this.select(t=>t.totalPages),this.$totalItems=this.select(t=>t.totalItems),this.$currentPage=this.select(t=>t.currentPage),this.$selectedRoom=this.select(t=>t.selectedRoom),this.$roomInstance=this.select(t=>t.roomInstance)}fillEmpty(t,e,o,s){let i=o,r=t*e;for(var a=0;a<s.length;a++)i[r]=s[a],r++;return console.log("Filled array result"),console.log(i),i}initData(t,e){this.roomService.fetchRoom(t,e).toPromise().then(t=>{this.setState({roomList:new Array(t.totalItems)}),console.log("Current flag: pure list"),console.log(this.state.roomList),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage})}).then(()=>{this.loadDataAsync(t,e)})}initInfiniteData(t,e){return this.roomService.fetchRoom(t,e).toPromise().then(t=>{this.setState({roomList:new Array(t.items.length)}),console.log("Current flag: infite list"),console.log(this.state.roomList),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage})}).then(()=>{this.loadDataAsync(t,e)})}loadInfiniteDataAsync(t,e){this.setIsLoading(!0),this.roomService.fetchRoom(t,e).subscribe({next:t=>{this.setState({roomList:this.state.roomList.concat(t.items)}),console.log("Infinite list"),console.log(this.state.roomList),console.log("Server response"),console.log(t),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}initFilterByCategoryData(t,e,o){this.store.showNotif("Filtered Mode On","custom"),this.roomService.filterRoomByCategory(t,0,5).toPromise().then(t=>{this.setState({roomList:new Array(t.totalItems)}),console.log("Current flag: filtered list"),console.log(this.state.roomList),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage})}).then(()=>{this.filterRoomByCategory(t,e,o)})}initInfiniteFilterByCategoryData(t,e,o){this.store.showNotif("Filtered Mode On","custom"),this.roomService.filterRoomByCategory(t,e,o).toPromise().then(t=>{this.setState({roomList:new Array(t.items.length)}),console.log("Current flag: infinite filtered list"),console.log(this.state.roomList),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage})}).then(()=>{this.filterRoomByCategory(t,e,o)})}initSearchByNameData(t,e,o){this.store.showNotif("Searched Mode On","custom"),this.roomService.searchRoomByName(t,0,5).toPromise().then(t=>{this.setState({roomList:new Array(t.totalItems)}),console.log("Current flag: searched list"),console.log(this.state.roomList),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage})}).then(()=>{this.searchRoomByName(t,e,o)})}initInfiniteSearchByNameData(t,e,o){this.store.showNotif("Searched Mode On","custom"),this.roomService.searchRoomByName(t,e,o).toPromise().then(t=>{0!==t.totalItems?this.setState({roomList:new Array(t.items.length)}):this.store.showNotif("No result found!","custom"),console.log("Current flag: infitite searched list"),console.log(this.state.roomList),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage})}).then(()=>{this.searchRoomByName(t,e,o)})}initSortByPriceData(t,e,o){this.store.showNotif("Sort Mode On","custom"),this.roomService.sortRoomByPrice(t,0,5).toPromise().then(t=>{this.setState({roomList:new Array(t.totalItems)}),console.log("Current flag: sort list"),console.log(this.state.roomList),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage})}).then(()=>{this.sortRoomByPrice(t,e,o)})}initInfiniteSortByPriceData(t,e,o){this.store.showNotif("Sort Mode On","custom"),this.roomService.sortRoomByPrice(t,e,o).toPromise().then(t=>{this.setState({roomList:new Array(t.items.length)}),console.log("Current flag: sort list"),console.log(this.state.roomList),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage})}).then(()=>{this.sortRoomByPrice(t,e,o)})}initSortByName(t,e,o){this.store.showNotif("Sort Mode On","custom"),this.roomService.sortRoomByName(t,0,5).toPromise().then(t=>{this.setState({roomList:new Array(t.totalItems)}),console.log("Current flag: sort list"),console.log(this.state.roomList),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage})}).then(()=>{this.sortRoomByName(t,e,o)})}loadDataAsync(t,e){this.setIsLoading(!0),this.roomService.fetchRoom(t,e).subscribe({next:o=>{this.setState({roomList:this.fillEmpty(t,e,this.state.roomList,o.items)}),console.log("Pure list"),console.log(this.state.roomList),console.log("Server response"),console.log(o),this.setState({totalItems:o.totalItems}),this.setState({totalPages:o.totalPages}),this.setState({currentPage:o.currentPage}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}refresh(t,e){this.setIsLoading(!0),this.roomService.fetchRoom(t,e).subscribe({next:o=>{this.setState({roomList:this.fillEmpty(t,e,this.state.roomList,o.items)}),this.setState({totalItems:o.totalItems}),this.setState({totalPages:o.totalPages}),this.setState({currentPage:o.currentPage}),console.log("Pure list"),console.log(this.state.roomList),console.log("Server response"),console.log(o),this.store.showNotif("Refresh successfully","custom"),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}setIsLoading(t){this.store.setIsLoading(t)}uploadRoom(t,e,o){this.confirmDialog("").then(s=>{s&&(this.setIsLoading(!0),this.roomService.uploadRoom(t).subscribe({next:t=>{this.setState({responseMsg:t}),this.setTotalItems(this.state.totalItems+1),console.log(t),this.loadDataAsync(e,o),this.setIsLoading(!1),this.store.showNotif(t.responseMessage,"custom")},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}}))})}updateRoom(t,e,o,s){this.confirmDialog("").then(i=>{i&&(this.setIsLoading(!0),this.roomService.updateRoom(t,e).subscribe({next:t=>{this.setState({responseMsg:t}),console.log(t),this.loadDataAsync(o,s),this.setIsLoading(!1),this.store.showNotif(t.responseMessage,"custom")},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}}))})}confirmDialog(t){return(0,u.iG)(""!=t?`<b>${t}</b>`:"<b>Are you sure?</b>","Confirm changes")}deleteSelectedRooms(t,e,o){this.confirmDialog("").then(s=>{s&&(this.setIsLoading(!0),this.roomService.deleteSelectedRooms(t).subscribe({next:t=>{this.setState({responseMsg:t}),console.log(t),this.loadDataAsync(e,o),console.log(this.state.roomList),this.setIsLoading(!1),this.store.showNotif(t.responseMessage,"custom")},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}}))})}deleteAllRooms(){this.confirmDialog("Delete all items?").then(t=>{t&&(this.setIsLoading(!0),this.roomService.deleteAllRooms().subscribe({next:t=>{this.setState({responseMsg:t}),this.setState({roomList:[]}),this.setState({totalPages:0}),this.setState({currentPage:0}),this.setState({totalItems:0}),console.log(t),this.setIsLoading(!1),this.store.showNotif(t.responseMessage,"custom")},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}}))})}deleteRoom(t,e,o){this.confirmDialog("").then(s=>{s&&(this.setIsLoading(!0),this.roomService.deleteRoom(t).subscribe({next:t=>{this.setState({responseMsg:t}),this.setTotalItems(this.state.totalItems-1),console.log(t),this.loadDataAsync(e,o),this.setIsLoading(!1),this.store.showNotif(t.responseMessage,"custom")},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}}))})}selectRoom(t){this.setState({selectedRoom:t})}setTotalPages(t){this.setState({totalPages:t})}setTotalItems(t){this.setState({totalItems:t})}setCurrentPage(t){this.setState({currentPage:t})}getRoom(t){return this.setIsLoading(!0),this.roomService.getRoom(t).toPromise().then(t=>{this.setState({roomInstance:t}),console.log(t),this.setIsLoading(!1)})}filterRoomByPrice(t,e,o,s){this.setIsLoading(!0),this.roomService.filterRoomByPrice(t,e,o,s).subscribe({next:t=>{this.setState({responseMsg:t}),this.setState({roomList:this.fillEmpty(o,s,this.state.roomList,t.items)}),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}filterRoomByCategory(t,e,o){this.setIsLoading(!0),this.roomService.filterRoomByCategory(t,e,o).subscribe({next:t=>{this.setState({roomList:this.fillEmpty(e,o,this.state.roomList,t.items)}),console.log("Filtered list"),console.log(this.state.roomList),console.log("Server response"),console.log(t),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}filterInfiniteRoomByCategory(t,e,o){this.setIsLoading(!0),this.roomService.filterRoomByCategory(t,e,o).subscribe({next:t=>{this.setState({roomList:this.state.roomList.concat(t.items)}),console.log("Filtered list"),console.log(this.state.roomList),console.log("Server response"),console.log(t),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}searchRoomByName(t,e,o){this.setIsLoading(!0),this.roomService.searchRoomByName(t,e,o).subscribe({next:t=>{this.setState({roomList:this.fillEmpty(e,o,this.state.roomList,t.items)}),console.log("Searched list"),console.log(this.state.roomList),console.log("Server response"),console.log(t),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}searchInfiniteRoomByName(t,e,o){this.setIsLoading(!0),this.roomService.searchRoomByName(t,e,o).subscribe({next:t=>{0!==t.totalItems?this.setState({roomList:this.state.roomList.concat(t.items)}):this.store.showNotif("No result found!","custome"),console.log("Infite searched list"),console.log(this.state.roomList),console.log("Server response"),console.log(t),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}sortRoomByName(t,e,o){this.setIsLoading(!0),this.roomService.sortRoomByName(t,e,o).subscribe({next:t=>{this.setState({responseMsg:t}),this.setState({roomList:this.fillEmpty(e,o,this.state.roomList,t.items)}),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage}),console.log("Sorted list"),console.log(this.state.roomList),console.log("Server response"),console.log(t),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}sortInfiniteRoomByPrice(t,e,o){this.setIsLoading(!0),this.roomService.sortRoomByPrice(t,e,o).subscribe({next:t=>{this.setState({roomList:this.state.roomList.concat(t.items)}),console.log("Infite sorted list"),console.log(this.state.roomList),console.log("Server response"),console.log(t),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}sortRoomByPrice(t,e,o){this.setIsLoading(!0),this.roomService.sortRoomByPrice(t,e,o).subscribe({next:t=>{this.setState({responseMsg:t}),this.setState({roomList:this.fillEmpty(e,o,this.state.roomList,t.items)}),this.setState({totalItems:t.totalItems}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.currentPage}),console.log("Sorted list"),console.log(this.state.roomList),console.log("Server response"),console.log(t),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}setExportData(t){this.setState({roomList:t})}}return t.\u0275fac=function(e){return new(e||t)(m.LFG(p),m.LFG(y.d))},t.\u0275prov=m.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var P=o(69333),L=o(52177),x=o(86101),w=o(83584);function R(t,e){if(1&t&&(m.TgZ(0,"div"),m.TgZ(1,"div",25),m._uU(2),m.qZA(),m.qZA()),2&t){const t=m.oxw();m.xp6(2),m.Oqu(t.selectInfoText)}}function b(t,e){if(1&t&&(m.TgZ(0,"div"),m.TgZ(1,"span"),m._uU(2),m.qZA(),m.qZA()),2&t){const t=m.oxw();m.xp6(2),m.hij("Total Room: ",t.roomList.length," ")}}const v=function(){return{paddingLeft:"25px",paddingRight:"25px"}},B=[{path:"",component:(()=>{class t{constructor(t,e,o,s){this.roomStore=t,this.store=e,this.roomHTTP=o,this.router=s,this.vacancyStatusList=[{name:"(NONE)"},{name:"FULL"},{name:"AVAILABLE"}],this.pageSize=5,this.allowedPageSizes=[5,10,15],this.scrollingMode="standard"}onToolbarPreparing(t){t.toolbarOptions.items.unshift({location:"before",template:"totalRoomCount"},{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"normal",icon:"refresh",hint:"Fetch data from server",onClick:this.onRefresh.bind(this)}},{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"danger",icon:"trash",hint:"Delete all items",onClick:this.deleteAll.bind(this)}},{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"danger",icon:"parentfolder",hint:"Generate random 100+ items",onClick:this.onAddRandom.bind(this)}},{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"normal",icon:"exportpdf",hint:"Export to PDF",onClick:this.exportGridToPdf.bind(this)}},{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"normal",icon:"xlsxfile",hint:"Export to Excel",onClick:this.exportDataGridToExcel.bind(this)}},{location:"before",widget:"dxTextBox",options:{valueChangeEvent:"keyup",showClearButton:!0,onKeyUp:this.onSearchKeyupHandler.bind(this),onValueChanged:this.onSearchValueChanged.bind(this),mode:"search",placeholder:"Search number"}},{location:"center",locateInMenu:"auto",widget:"dxButton",options:{type:"normal",icon:"filter",disabled:!0,hint:"Filter with vacancy status"}},{location:"center",locateInMenu:"auto",widget:"dxSelectBox",options:{items:this.vacancyStatusList,valueExpr:"name",displayExpr:"name",placeholder:"Filter with vacancy status",onValueChanged:this.onFilterChange.bind(this)}},{location:"center",locateInMenu:"auto",widget:"dxButton",options:{type:"normal",icon:"event",disabled:!0,hint:"Sort by total slot"}},{location:"center",locateInMenu:"auto",widget:"dxSelectBox",options:{items:[{_id:"-1",name:"(NONE)"},{_id:"0",name:"ASC"},{_id:"1",name:"DESC"}],valueExpr:"name",placeholder:"Sort by total slot",displayExpr:"name",onValueChanged:this.onSortValueChanged.bind(this)}})}getTotalLearner(t){if(t.learnerID)return t.learnerID.length}onSearchKeyupHandler(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.isSearchingByName=!0,this.isFilteringByCategory=!1,this.isSortingByName=!1,console.log(this.currentSearchByNameValue),""!==this.currentSearchByNameValue?this.roomStore.initSearchByNameData(this.currentSearchByNameValue,this.dataGrid.instance.pageIndex(),this.pageSize):(this.store.showNotif("SEARCH MODE OFF","custom"),this.onRefresh())},1250)}onSearchValueChanged(t){this.currentSearchByNameValue=t.value}onSortValueChanged(t){this.isSortingByName=!0,this.isSearchingByName=!1,this.isFilteringByCategory=!1,this.currentSortByPriceValue=t.value,"(NONE)"!==t.value?this.roomStore.initSortByPriceData(t.value,this.dataGrid.instance.pageIndex(),this.pageSize):(this.store.showNotif("SORT MODE OFF","custom"),this.onRefresh())}onFilterChange(t){this.isFilteringByCategory=!0,this.isSearchingByName=!1,this.isSortingByName=!1,this.currentCategoryFilterValue=t.value,console.log(t.value),"(NONE)"!==t.value?this.roomStore.initFilterByCategoryData(t.value,this.dataGrid.instance.pageIndex(),this.pageSize):(this.store.showNotif("FILTER MODE OFF","custom"),this.onRefresh())}checkEditorMode(){return!0===this.isFilteringByCategory?"FILTER":!0===this.isSearchingByName?"SEARCH":!0===this.isSortingByName?"SORT":"NORMAL"}onOptionChanged(t){const e=this.checkEditorMode();if("paging.pageIndex"===t.fullName){const o=t.value;switch(console.log(`New page index: ${o}. Total items: ${this.roomList.length}`),e){case"NORMAL":this.paginatePureData(o);break;case"FILTER":this.paginateFilterData(o);break;case"SEARCH":this.paginateSearchData(o);break;case"SORT":this.paginateSortData(o)}}if("paging.pageSize"===t.fullName)switch(this.pageSize=t.value,console.log(`Page size changed to ${t.value}`),e){case"NORMAL":this.roomStore.loadDataAsync(this.currentIndexFromServer,t.value),this.goToPage(this.currentIndexFromServer);break;case"FILTER":this.roomStore.filterRoomByCategory(this.currentCategoryFilterValue,this.currentIndexFromServer,t.value),this.goToPage(this.currentIndexFromServer);break;case"SEARCH":this.roomStore.searchRoomByName(this.currentSearchByNameValue,this.currentIndexFromServer,t.value),this.goToPage(this.currentIndexFromServer);break;case"SORT":this.roomStore.sortRoomByPrice(this.currentSortByPriceValue,this.currentIndexFromServer,t.value),this.goToPage(this.currentIndexFromServer)}}paginatePureData(t){0===t?(this.roomStore.loadDataAsync(t,this.pageSize),this.roomStore.loadDataAsync(t+1,this.pageSize)):(this.roomStore.loadDataAsync(t,this.pageSize),this.roomStore.loadDataAsync(t+1,this.pageSize),this.roomStore.loadDataAsync(t-1,this.pageSize))}paginateFilterData(t){0===t?(this.roomStore.filterRoomByCategory(this.currentCategoryFilterValue,t,this.pageSize),this.roomStore.filterRoomByCategory(this.currentCategoryFilterValue,t+1,this.pageSize)):(this.roomStore.filterRoomByCategory(this.currentCategoryFilterValue,t,this.pageSize),this.roomStore.filterRoomByCategory(this.currentCategoryFilterValue,t+1,this.pageSize),this.roomStore.filterRoomByCategory(this.currentCategoryFilterValue,t-1,this.pageSize))}paginateSearchData(t){0===t?(this.roomStore.searchRoomByName(this.currentSearchByNameValue,t,this.pageSize),this.roomStore.searchRoomByName(this.currentSearchByNameValue,t+1,this.pageSize)):(this.roomStore.searchRoomByName(this.currentSearchByNameValue,t,this.pageSize),this.roomStore.searchRoomByName(this.currentSearchByNameValue,t+1,this.pageSize),this.roomStore.searchRoomByName(this.currentSearchByNameValue,t-1,this.pageSize))}paginateSortData(t){0===t?(this.roomStore.sortRoomByPrice(this.currentSortByPriceValue,t,this.pageSize),this.roomStore.sortRoomByPrice(this.currentSortByPriceValue,t+1,this.pageSize)):(this.roomStore.sortRoomByPrice(this.currentSortByPriceValue,t,this.pageSize),this.roomStore.sortRoomByPrice(this.currentSortByPriceValue,t+1,this.pageSize),this.roomStore.sortRoomByPrice(this.currentSortByPriceValue,t-1,this.pageSize))}onEditingStart(){this.store.showNotif("Edit mode on","custom")}onInitNewRow(){this.store.showNotif("Blank row added, please fill in information","custom")}onSaved(t){if(t.changes.length)switch(t.changes[0].type){case"insert":this.roomStore.uploadRoom(t.changes[0].data,this.dataGrid.instance.pageIndex(),this.pageSize);break;case"update":console.log(t.changes[0]),this.roomStore.updateRoom(t.changes[0].data,t.changes[0].key,this.dataGrid.instance.pageIndex(),this.pageSize);break;case"remove":this.roomStore.deleteRoom(t.changes[0].key,this.dataGrid.instance.pageIndex(),this.pageSize)}else this.store.showNotif("No changes dectected","custom")}onEditCanceled(){this.store.showNotif("Editing cancelled","custom")}selectionChangedHandler(){this.selectedRows.length?(this.isSelectInfoVisible=!0,this.selectInfoText=`${this.selectedRows.length} rows selected`,this.selectedRows.forEach(t=>{console.log(t)})):this.isSelectInfoVisible=!1}changePageSize(t){this.dataGrid.instance.pageSize(t)}goToPage(t){this.dataGrid.instance.pageIndex(t)}deleteSelectedItems(){this.store.setIsLoading(!0);const t=this.checkEditorMode();this.selectedRows.length&&this.roomStore.confirmDialog("").then(e=>{e&&this.roomHTTP.deleteSelectedRooms(this.selectedRows).toPromise().then(()=>{switch(this.store.showNotif(`${this.selectedRows.length} items deleted`,"custom"),this.clearSelection(),t){case"NORMAL":this.roomStore.initData(this.dataGrid.instance.pageIndex(),this.pageSize);break;case"FILTER":this.roomStore.initFilterByCategoryData(this.currentCategoryFilterValue,this.dataGrid.instance.pageIndex(),this.pageSize);break;case"SORT":this.roomStore.initSortByPriceData(this.currentSortByPriceValue,this.dataGrid.instance.pageIndex(),this.pageSize);break;case"SEARCH":this.roomStore.initSearchByNameData(this.currentSearchByNameValue,this.dataGrid.instance.pageIndex(),this.pageSize)}this.isSelectInfoVisible=!1}).then(()=>{this.store.setIsLoading(!1)})})}clearSelection(){this.selectedRows=[]}onRefresh(){this.isFilteringByCategory=!1,this.isSearchingByName=!1,this.isSortingByName=!1,this.roomStore.initData(this.dataGrid.instance.pageIndex(),this.pageSize)}onAddRandom(){this.roomStore.confirmDialog("This will generate random 100+ items in database. Are you sure").then(t=>{t&&(this.isFilteringByCategory=!1,this.store.setIsLoading(!0),this.roomHTTP.generateRandomRoom().toPromise().then(()=>{this.roomStore.initData(this.dataGrid.instance.pageIndex(),this.pageSize)}).then(()=>{this.store.setIsLoading(!1),this.store.showNotif("Generated 100+ random items","custom")}))})}exportDataGridToExcel(){this.roomStore.confirmDialog("This will export all fetched data to excel. Are you sure?").then(t=>{t&&(this.store.setIsLoading(!0),this.roomHTTP.fetchAll().toPromise().then(t=>{this.roomStore.setExportData(t),console.log(t),setTimeout(()=>{const t=new h.Workbook,e=t.addWorksheet("Room List");(0,a.d)({component:this.dataGrid.instance,worksheet:e,autoFilterEnabled:!0}).then(()=>{t.xlsx.writeBuffer().then(t=>{g()(new Blob([t],{type:"application/octet-stream"}),"Room_List.xlsx"),this.store.setIsLoading(!1),this.store.showNotif("Export succesully","custom")})})},200)}))})}exportGridToPdf(t){this.roomStore.confirmDialog("This will export all data to pdf. Are you sure?").then(t=>{t&&(this.store.setIsLoading(!0),this.roomHTTP.fetchAll().toPromise().then(t=>{this.roomStore.setExportData(t),console.log(t),setTimeout(()=>{const t=new l.jsPDF;(0,n.d)({jsPDFDocument:t,component:this.dataGrid.instance}).then(()=>{t.save("Room_List.pdf"),this.store.setIsLoading(!1),this.store.showNotif("Export succesully","custom")})},200)}))})}deleteAll(){this.roomStore.deleteAllRooms()}navigateToEditBill(){this.router.navigate(["/edit_bill_list"])}sourceDataListener(){return this.roomStore.$roomList.subscribe(t=>{this.roomList=t})}currentPageListener(){return this.roomStore.$currentPage.subscribe(t=>{this.currentIndexFromServer=t})}ngOnInit(){this.sourceDataListener(),this.currentPageListener(),setTimeout(()=>{this.onRefresh()},150)}ngOnDestroy(){this.sourceDataListener().unsubscribe(),this.currentPageListener().unsubscribe(),this.onRefresh()}}return t.\u0275fac=function(e){return new(e||t)(m.Y36(I),m.Y36(y.d),m.Y36(p),m.Y36(i.F0))},t.\u0275cmp=m.Xpm({type:t,selectors:[["app-edit-room-list"]],viewQuery:function(t,e){if(1&t&&m.Gf(r.e,5),2&t){let t;m.iGM(t=m.CRH())&&(e.dataGrid=t.first)}},decls:29,vars:40,consts:[[3,"ngStyle"],[3,"location","text"],["location","center","locateInMenu","auto",3,"visible"],[4,"dxTemplate"],["location","center","locateInMenu","auto"],["icon","trash","type","danger","hint","Delete current selected items",3,"visible","onClick"],["location","after","locateInMenu","auto"],["icon","arrowright","type","outline","text","Bill Management","hint","Navigate to Edit Bill",3,"onClick"],["id","gridContainer","keyExpr","_id",3,"dataSource","showBorders","allowColumnReordering","rowAlternationEnabled","columnHidingEnabled","selectedRowKeys","sorting","selectedRowKeysChange","onOptionChanged","onSelectionChanged","onEditingStart","onInitNewRow","onSaved","onEditCanceled","onToolbarPreparing"],[3,"allowUpdating","allowDeleting","allowAdding","useIcons","selectTextOnEditStart"],["mode","multiple",3,"selectAllMode","showCheckBoxesMode"],["expandMode","rowClick",3,"contextMenuEnabled"],["mode","select",3,"enabled"],[3,"pageSize"],[3,"visible","displayMode","allowedPageSizes","showPageSizeSelector","showNavigationButtons"],[3,"enabled"],["dataField","number",3,"width"],["type","required"],["dataField","admissionDate","dataType","date",3,"width"],["dataField","dischargeDate","dataType","date",3,"width"],["dataField","totalSlot","dataType","number",3,"width"],["dataField","learnerID",3,"width","calculateDisplayValue","caption","allowEditing"],["dataField","vacancyStatus",3,"caption"],["displayExpr","name","valueExpr","name",3,"dataSource"],[4,"dxTemplate","dxTemplateOf"],[2,"font-size","small"]],template:function(t,e){1&t&&(m.TgZ(0,"dx-toolbar",0),m._UZ(1,"dxi-item",1),m.TgZ(2,"dxi-item",2),m.YNc(3,R,3,1,"div",3),m.qZA(),m.TgZ(4,"dxi-item",4),m.TgZ(5,"dx-button",5),m.NdJ("onClick",function(){return e.deleteSelectedItems()}),m.qZA(),m.qZA(),m.TgZ(6,"dxi-item",6),m.TgZ(7,"dx-button",7),m.NdJ("onClick",function(){return e.navigateToEditBill()}),m.qZA(),m.qZA(),m.qZA(),m.TgZ(8,"dx-data-grid",8),m.NdJ("selectedRowKeysChange",function(t){return e.selectedRows=t})("onOptionChanged",function(t){return e.onOptionChanged(t)})("onSelectionChanged",function(){return e.selectionChangedHandler()})("onEditingStart",function(){return e.onEditingStart()})("onInitNewRow",function(){return e.onInitNewRow()})("onSaved",function(t){return e.onSaved(t)})("onEditCanceled",function(){return e.onEditCanceled()})("onToolbarPreparing",function(t){return e.onToolbarPreparing(t)}),m._UZ(9,"dxo-editing",9),m._UZ(10,"dxo-selection",10),m._UZ(11,"dxo-grouping",11),m._UZ(12,"dxo-column-chooser",12),m._UZ(13,"dxo-paging",13),m._UZ(14,"dxo-pager",14),m._UZ(15,"dxo-load-panel",15),m.TgZ(16,"dxi-column",16),m._UZ(17,"dxi-validation-rule",17),m.qZA(),m.TgZ(18,"dxi-column",18),m._UZ(19,"dxi-validation-rule",17),m.qZA(),m.TgZ(20,"dxi-column",19),m._UZ(21,"dxi-validation-rule",17),m.qZA(),m.TgZ(22,"dxi-column",20),m._UZ(23,"dxi-validation-rule",17),m.qZA(),m._UZ(24,"dxi-column",21),m.TgZ(25,"dxi-column",22),m._UZ(26,"dxi-validation-rule",17),m._UZ(27,"dxo-lookup",23),m.qZA(),m.YNc(28,b,3,1,"div",24),m.qZA()),2&t&&(m.Q6J("ngStyle",m.DdM(39,v)),m.xp6(1),m.Q6J("location","before")("text","Room Mananagement"),m.xp6(1),m.Q6J("visible",e.isSelectInfoVisible),m.xp6(3),m.Q6J("visible",e.isSelectInfoVisible),m.xp6(3),m.Q6J("dataSource",e.roomList)("showBorders",!0)("allowColumnReordering",!0)("rowAlternationEnabled",!0)("columnHidingEnabled",!0)("selectedRowKeys",e.selectedRows)("sorting",!1),m.xp6(1),m.Q6J("allowUpdating",!0)("allowDeleting",!0)("allowAdding",!0)("useIcons",!0)("selectTextOnEditStart",!0),m.xp6(1),m.Q6J("selectAllMode","page")("showCheckBoxesMode","onClick"),m.xp6(1),m.Q6J("contextMenuEnabled",!0),m.xp6(1),m.Q6J("enabled",!0),m.xp6(1),m.Q6J("pageSize",e.pageSize),m.xp6(1),m.Q6J("visible",!0)("displayMode","adaptive")("allowedPageSizes",e.allowedPageSizes)("showPageSizeSelector",!0)("showNavigationButtons",!0),m.xp6(1),m.Q6J("enabled",!0),m.xp6(1),m.Q6J("width",150),m.xp6(2),m.Q6J("width",150),m.xp6(2),m.Q6J("width",150),m.xp6(2),m.Q6J("width",100),m.xp6(2),m.Q6J("width",150)("calculateDisplayValue",e.getTotalLearner)("caption","Total Learners")("allowEditing",!1),m.xp6(1),m.Q6J("caption","Vacancy Status"),m.xp6(2),m.Q6J("dataSource",e.vacancyStatusList),m.xp6(1),m.Q6J("dxTemplateOf","totalRoomCount"))},directives:[P.G,s.PC,L.ZT3,x.p6,w.K,r.e,L.Uo8,L.Lz9,L.uCj,L.Auv,L.sXh,L.ilc,L.mKI,L.qvW,L.vrV,L.w3U],styles:[""]}),t})()}];let N=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.oAB({type:t}),t.\u0275inj=m.cJS({imports:[[i.Bz.forChild(B)],i.Bz]}),t})(),C=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.oAB({type:t}),t.\u0275inj=m.cJS({imports:[[s.ez,N,r.x,P.k,w.e]]}),t})()}}]);