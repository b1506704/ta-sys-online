(self.webpackChunkta_sys_online=self.webpackChunkta_sys_online||[]).push([[491],{29491:(e,t,i)=>{"use strict";i.r(t),i.d(t,{FileManagementModule:()=>ds});var o=i(61116),s=i(46553),n=i(51973),r=i(99624),a=i(8619),l=i(40165),h=i(20818),d=i(81272),c=i(6282),p=i(81389),u=i(4216),m=i(34638),g=i(81028),_=i(97568),f=function(e,t,i){t=t||p.ZT,i=i||p.ZT,Array.isArray(e)||(e=[e]);var o=e.map((e,o)=>(0,c.gx)(e).then(i=>((0,d.mf)(t)&&t({item:e,index:o,result:i}),i),e=>(e||(e={}),e.index=o,(0,d.mf)(i)&&i(e),(new c.BH).resolve().promise())));return c.gx.apply(null,o)},C=function(e){for(var t=["B","KB","MB","GB","TB"],i=0,o=e;o>=1024&&i<=t.length-1;)o/=1024,i++;return o=Math.round(10*o)/10,"".concat(o," ").concat(t[i])},b=function(e,t,i){return i.forEach(i=>{(0,h.l)(!0,e,(0,d.$K)(t[i])?{[i]:t[i]}:{})}),e},I=function(e){var t=Object.keys(e),i=[];return t.forEach(t=>i.push(e[t])),{keys:t,values:i}},v=i(93471),y=i(38855),x=i(99248),S="/",D=e=>{var t=e.lastIndexOf(".");return-1!==t?e.substr(t):""},w=e=>{var t=e.lastIndexOf(S);return-1!==t?e.substr(t+S.length):e},M=(e,t)=>{if(!e||"/"===e)return[];for(var i=[],o="",s=0;s<e.length;s++){var n=e.charAt(s);if(n===S){var r=e.charAt(s+1);r!==S&&(o&&(i.push(o),o=""),n=r),s++}o+=n}if(o&&i.push(o),t)for(var a=0;a<i.length;a++)i[a]=O(0===a?"":i[a-1],T(i[a]));return i},T=function(e){return e.replace(/\//g,"//")},O=function(){var e="";return(0,x.S6)(arguments,(t,i)=>{i&&(e&&(e+=S),e+=i)}),e};class P{constructor(){((0,d.HD)(arguments[0])?this._publicCtor:this._internalCtor).apply(this,arguments)}_internalCtor(e,t,i,o){this.name=t||"",this.pathInfo=e&&[...e]||[],this.parentPath=this._getPathByPathInfo(this.pathInfo),this.relativeName=O(this.parentPath,t),this.key=o||this._getPathByPathInfo(this.getFullPathInfo(),!0),this.path=O(this.parentPath,t),this.pathKeys=this.pathInfo.map(e=>{var{key:t}=e;return t}),this.isRoot()||this.pathKeys.push(this.key),this._initialize(i)}_publicCtor(e,t,i){this.path=e||"",this.pathKeys=i||[];for(var o=[],s=M(e,!0),n=0;n<s.length-1;n++){var r=s[n],a={key:this.pathKeys[n]||r,name:w(r)};o.push(a)}this.pathInfo=o,this.relativeName=e,this.name=w(e),this.key=this.pathKeys.length?this.pathKeys[this.pathKeys.length-1]:e,this.parentPath=s.length>1?s[s.length-2]:"",this._initialize(t)}_initialize(e){this.isDirectory=!!e,this.size=0,this.dateModified=new Date,this.thumbnail="",this.tooltipText=""}getFullPathInfo(){var e=[...this.pathInfo];return this.isRoot()||e.push({key:this.key,name:this.name}),e}isRoot(){return""===this.path}getFileExtension(){return this.isDirectory?"":D(this.name)}equals(e){return e&&this.key===e.key}createClone(){var e=new P(this.pathInfo,this.name,this.isDirectory,this.key);return e.key=this.key,e.size=this.size,e.dateModified=this.dateModified,e.thumbnail=this.thumbnail,e.tooltipText=this.tooltipText,e.hasSubDirectories=this.hasSubDirectories,e.dataItem=this.dataItem,e}_getPathByPathInfo(e,t){return e.map(e=>t?T(e.name):e.name).join(S)}}const F=P,E=class{constructor(e){e=(0,p.IS)(e,{}),this._keyGetter=(0,v.vb)(this._getKeyExpr(e)),this._nameGetter=(0,v.vb)(this._getNameExpr(e)),this._isDirGetter=(0,v.vb)(this._getIsDirExpr(e)),this._sizeGetter=(0,v.vb)(this._getSizeExpr(e)),this._dateModifiedGetter=(0,v.vb)(this._getDateModifiedExpr(e)),this._thumbnailGetter=(0,v.vb)(e.thumbnailExpr||"thumbnail")}getItems(e){return[]}renameItem(e,t){}createDirectory(e,t){}deleteItems(e){}moveItems(e,t){}copyItems(e,t){}uploadFileChunk(e,t,i){}abortFileUpload(e,t,i){}downloadItems(e){}getItemsContent(e){}getFileUploadChunkSize(){return 2e5}_convertDataObjectsToFileItems(e,t){var i=[];return(0,x.S6)(e,(e,o)=>{var s=this._createFileItem(o,t);i.push(s)}),i}_createFileItem(e,t){var i=this._keyGetter(e),o=new F(t,this._nameGetter(e),!!this._isDirGetter(e),i);return o.size=this._sizeGetter(e),void 0===o.size&&(o.size=0),o.dateModified=y.Z.deserializeDate(this._dateModifiedGetter(e)),void 0===o.dateModified&&(o.dateModified=new Date),o.isDirectory&&(o.hasSubDirectories=this._hasSubDirs(e)),i||(o.key=o.relativeName),o.thumbnail=this._thumbnailGetter(e)||"",o.dataItem=e,o}_hasSubDirs(e){return!0}_getKeyExpr(e){return e.keyExpr||this._defaultKeyExpr}_defaultKeyExpr(e){if(2!==arguments.length)return Object.prototype.hasOwnProperty.call(e,"__KEY__")?e.__KEY__:null;e.__KEY__=arguments[1]}_getNameExpr(e){return e.nameExpr||"name"}_getIsDirExpr(e){return e.isDirectoryExpr||"isDirectory"}_getSizeExpr(e){return e.sizeExpr||"size"}_getDateModifiedExpr(e){return e.dateModifiedExpr||"dateModified"}_executeActionAsDeferred(e,t){var i=new c.BH;try{var o=e();(0,d.tI)(o)?(0,c.p4)(o).done(e=>i.resolve(t&&e||void 0)).fail(e=>i.reject(e)):i.resolve(t&&o||void 0)}catch(R){return i.reject(R)}return i.promise()}};var A=i(23249),k=i(56410),Z=i(57414),B=i(21618),U=i(83903),V=i(63893),K=i(62506),L=i.n(K);const R=class{constructor(e,t,i){this.errorCode=e,this.fileSystemItem=t,this.errorText=i}};var z=(0,B.Jj)();const $=class extends E{constructor(e){super(e=(0,p.IS)(e,{}));var t=e.data;if(t&&!Array.isArray(t))throw Z.R0.Error("E4006");var i=e.itemsExpr||"items";this._subFileItemsGetter=(0,v.vb)(i),this._subFileItemsSetter=this._getSetter(i);var o=e.contentExpr||"content";this._contentGetter=(0,v.vb)(o),this._contentSetter=this._getSetter(o);var s=this._getNameExpr(e);this._nameSetter=this._getSetter(s);var n=this._getIsDirExpr(e);this._getIsDirSetter=this._getSetter(n);var r=this._getKeyExpr(e);this._keySetter=this._getSetter(r);var a=this._getSizeExpr(e);this._sizeSetter=this._getSetter(a);var l=this._getDateModifiedExpr(e);this._dateModifiedSetter=this._getSetter(l),this._data=t||[]}getItems(e){return this._executeActionAsDeferred(()=>this._getItems(e),!0)}renameItem(e,t){return this._executeActionAsDeferred(()=>this._renameItemCore(e,t))}_renameItemCore(e,t){if(e){var i=this._findDataObject(e);this._nameSetter(i,t),e.name=t,e.key=this._ensureDataObjectKey(i)}}createDirectory(e,t){return this._executeActionAsDeferred(()=>{this._validateDirectoryExists(e),this._createDataObject(e,t,!0)})}deleteItems(e){return e.map(e=>this._executeActionAsDeferred(()=>this._deleteItem(e)))}moveItems(e,t){var i=this._findDataObject(t),o=this._getDirectoryDataItems(i);return e.map(e=>this._executeActionAsDeferred(()=>{this._checkAbilityToMoveOrCopyItem(e,t);var i=this._findDataObject(e);this._deleteItem(e),o.push(i)}))}copyItems(e,t){var i=this._findDataObject(t),o=this._getDirectoryDataItems(i);return e.map(e=>this._executeActionAsDeferred(()=>{this._checkAbilityToMoveOrCopyItem(e,t);var i=this._findDataObject(e),s=this._createCopy(i);o.push(s)}))}uploadFileChunk(e,t,i){if(t.chunkIndex>0)return t.customData.deferred;this._validateDirectoryExists(i);var o=t.customData.deferred=new c.BH,s=this._createFileReader();return s.readAsDataURL(e),s.onload=()=>{var t=s.result.split(",")[1],n=this._createDataObject(i,e.name,!1);this._sizeSetter(n,e.size),this._dateModifiedSetter(n,e.lastModifiedDate),this._contentSetter(n,t),o.resolve()},s.onerror=e=>o.reject(e),o}downloadItems(e){1===e.length?this._downloadSingleFile(e[0]):this._downloadMultipleFiles(e)}_downloadSingleFile(e){for(var t=this._getFileContent(e),i=z.atob(t),o=new ArrayBuffer(i.length),s=new Uint8Array(o),n=0;n<i.length;n++)s[n]=i.charCodeAt(n);var r=new z.Blob([o],{type:"application/octet-stream"});U.A.saveAs(e.name,null,r)}_downloadMultipleFiles(e){var t=new(function(){if(!L())throw V.Z.Error("E1041","JSZip");return L()}());e.forEach(e=>t.file(e.name,this._getFileContent(e),{base64:!0}));var i={type:"blob",compression:"DEFLATE",mimeType:"application/zip"},o=new c.BH;t.generateAsync?t.generateAsync(i).then(o.resolve):o.resolve(t.generate(i)),o.done(e=>U.A.saveAs("files.zip",null,e))}_getFileContent(e){var t=this._findDataObject(e);return this._contentGetter(t)||""}_validateDirectoryExists(e){if(!this._isFileItemExists(e)||this._isDirGetter(e.fileItem))throw new R(4,e)}_checkAbilityToMoveOrCopyItem(e,t){var i=this._findDataObject(e),o=this._getKeyFromDataObject(i,e.parentPath),s=t.getFullPathInfo(),n="";s.forEach(t=>{if(n=O(n,t.name),this._getDataObjectKey(t.key,n)===o)throw new R(32767,e)})}_createDataObject(e,t,i){var o={};this._nameSetter(o,t),this._getIsDirSetter(o,i),this._keySetter(o,String(new k.Z));var s=this._findDataObject(e);return this._getDirectoryDataItems(s).push(o),o}_createCopy(e){var t={};this._nameSetter(t,this._nameGetter(e)),this._getIsDirSetter(t,this._isDirGetter(e));var i=this._subFileItemsGetter(e);if(Array.isArray(i)){var o=[];i.forEach(e=>{var t=this._createCopy(e);o.push(t)}),this._subFileItemsSetter(t,o)}return t}_deleteItem(e){var t=this._findDataObject(e),i=this._findFileItemObj(e.pathInfo),o=this._getDirectoryDataItems(i),s=o.indexOf(t);o.splice(s,1)}_getDirectoryDataItems(e){if(!e)return this._data;var t=this._subFileItemsGetter(e);return Array.isArray(t)||this._subFileItemsSetter(e,t=[]),t}_getItems(e){this._validateDirectoryExists(e);var t=e.getFullPathInfo(),i=this._data;if(t&&t.length>0&&t[t.length-1].key){var o=this._findFileItemObj(t);i=o&&this._subFileItemsGetter(o)||[]}return this._ensureKeysForDuplicateNameItems(i),this._convertDataObjectsToFileItems(i,t)}_ensureKeysForDuplicateNameItems(e){var t={};e.forEach(e=>{var i=this._nameGetter(e);t[i]?this._ensureDataObjectKey(e):t[i]=!0})}_findDataObject(e){if(e.isRoot())return null;var t=this._findFileItemObj(e.getFullPathInfo());if(!t)throw new R(e.isDirectory?4:2,e);return t}_findFileItemObj(e){var t=this;Array.isArray(e)||(e=[]);for(var i="",o=null,s=this._data,n=function(n){(o=(0,A.sE)(s,o=>{var s=t._isDirGetter(o)||n===e.length-1;return t._getKeyFromDataObject(o,i)===e[n].key&&t._nameGetter(o)===e[n].name&&s}))&&(i=O(i,t._nameGetter(o)),s=t._subFileItemsGetter(o))},r=0;r<e.length&&(0===r||o);r++)n(r);return o}_getKeyFromDataObject(e,t){var i=this._keyGetter(e),o=O(t,this._nameGetter(e));return this._getDataObjectKey(i,o)}_getDataObjectKey(e,t){return e||t}_ensureDataObjectKey(e){var t=this._keyGetter(e);return t||(t=String(new k.Z),this._keySetter(e,t)),t}_hasSubDirs(e){var t=(0,p.IS)(this._subFileItemsGetter(e),[]);if(!Array.isArray(t))return!0;for(var i=0;i<t.length;i++)if(!0===this._isDirGetter(t[i]))return!0;return!1}_getSetter(e){return(0,d.mf)(e)?e:(0,v.OM)(e)}_isFileItemExists(e){return e.isDirectory&&e.isRoot()||!!this._findFileItemObj(e.getFullPathInfo())}_createFileReader(){return new z.FileReader}};var N=i(14878),H=i(94165),q=(0,B.Jj)(),G="GetDirContents",j="POST";const Q=class extends E{constructor(e){super(e=(0,p.IS)(e,{})),this._endpointUrl=e.endpointUrl,this._beforeAjaxSend=e.beforeAjaxSend,this._beforeSubmit=e.beforeSubmit,this._requestHeaders=e.requestHeaders,this._hasSubDirsGetter=(0,v.vb)(e.hasSubDirectoriesExpr||"hasSubDirectories")}getItems(e){var t=e.getFullPathInfo();return this._executeRequest(G,{pathInfo:t}).then(e=>this._convertDataObjectsToFileItems(e.result,t))}renameItem(e,t){return this._executeRequest("Rename",{pathInfo:e.getFullPathInfo(),isDirectory:e.isDirectory,name:t})}createDirectory(e,t){return this._executeRequest("CreateDir",{pathInfo:e.getFullPathInfo(),name:t})}deleteItems(e){return e.map(e=>this._executeRequest("Remove",{pathInfo:e.getFullPathInfo(),isDirectory:e.isDirectory}))}moveItems(e,t){return e.map(e=>this._executeRequest("Move",{sourcePathInfo:e.getFullPathInfo(),sourceIsDirectory:e.isDirectory,destinationPathInfo:t.getFullPathInfo()}))}copyItems(e,t){return e.map(e=>this._executeRequest("Copy",{sourcePathInfo:e.getFullPathInfo(),sourceIsDirectory:e.isDirectory,destinationPathInfo:t.getFullPathInfo()}))}uploadFileChunk(e,t,i){0===t.chunkIndex&&(t.customData.uploadId=new k.Z);var o={destinationPathInfo:i.getFullPathInfo(),chunkMetadata:JSON.stringify({UploadId:t.customData.uploadId,FileName:e.name,Index:t.chunkIndex,TotalCount:t.chunkCount,FileSize:e.size})},s={url:this._endpointUrl,headers:this._requestHeaders||{},method:j,dataType:"json",data:{chunk:t.chunkBlob,arguments:JSON.stringify(o),command:"UploadChunk"},upload:{onprogress:p.ZT,onloadstart:p.ZT,onabort:p.ZT},xhrFields:{},cache:!1},n=new c.BH;return this._beforeSendInternal(s),N.Z.sendRequest(s).done(e=>{!e.success&&n.reject(e)||n.resolve()}).fail(n.reject),n.promise()}abortFileUpload(e,t,i){return this._executeRequest("AbortUpload",{uploadId:t.customData.uploadId})}downloadItems(e){var t=this._getDownloadArgs(e),i=(0,l.Z)("<form>").css({display:"none"}).attr({method:j,action:t.url}),o={command:t.command,arguments:t.arguments};this._beforeSubmitInternal(o),this._appendFormDataInputsToForm(o,i),i.appendTo("body"),H.Z.trigger(i,"submit"),setTimeout(()=>i.remove())}getItemsContent(e){var t=this._getDownloadArgs(e),i={url:t.url,headers:this._requestHeaders||{},method:j,responseType:"arraybuffer",data:{command:t.command,arguments:t.arguments},upload:{onprogress:p.ZT,onloadstart:p.ZT,onabort:p.ZT},xhrFields:{},cache:!1};return this._beforeSendInternal(i),N.Z.sendRequest(i)}_getDownloadArgs(e){var t=e.map(e=>e.getFullPathInfo()),i=JSON.stringify({pathInfoList:t});return{url:this._endpointUrl,arguments:i,command:"Download"}}_getItemsIds(e){return e.map(e=>e.relativeName)}_executeRequest(e,t){var i=e===G?"GET":j,o=new c.BH,s={url:this._getEndpointUrl(e,t),headers:this._requestHeaders||{},method:i,dataType:"json",data:{},xhrFields:{},cache:!1};return this._beforeSendInternal(s),N.Z.sendRequest(s).then(e=>{!e.success&&o.reject(e)||o.resolve(e)},e=>o.reject(e)),o.promise()}_beforeSubmitInternal(e){(0,d.mf)(this._beforeSubmit)&&this._beforeSubmit({formData:e})}_beforeSendInternal(e){if((0,d.mf)(this._beforeAjaxSend)){var t={headers:e.headers,formData:e.data,xhrFields:e.xhrFields};this._beforeAjaxSend(t),e.headers=t.headers,e.data=t.formData,e.xhrFields=t.xhrFields}(0,d.Qr)(e.data)?delete e.data:(e.responseType||e.upload)&&(e.data=this._createFormData(e.data))}_createFormData(e){var t=new q.FormData;for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(0,d.$K)(e[i])&&t.append(i,e[i]);return t}_appendFormDataInputsToForm(e,t){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(0,d.$K)(e[i])&&(0,l.Z)("<input>").attr({type:"hidden",name:i,value:e[i]}).appendTo(t)}_getEndpointUrl(e,t){var i=this._getQueryString({command:e,arguments:JSON.stringify(t)}),o=this._endpointUrl&&this._endpointUrl.indexOf("?")>0?"&":"?";return this._endpointUrl+o+i}_getQueryString(e){for(var t=[],i=Object.keys(e),o=0;o<i.length;o++){var s=i[o],n=e[s];if(void 0!==n)if(null===n&&(n=""),Array.isArray(n))this._processQueryStringArrayParam(s,n,t);else{var r=this._getQueryStringPair(s,n);t.push(r)}}return t.join("&")}_processQueryStringArrayParam(e,t,i){(0,x.S6)(t,(t,o)=>{var s=this._getQueryStringPair(e,o);i.push(s)})}_getQueryStringPair(e,t){return encodeURIComponent(e)+"="+encodeURIComponent(t)}_hasSubDirs(e){var t=this._hasSubDirsGetter(e);return"boolean"!=typeof t||t}_getKeyExpr(e){return e.keyExpr||"key"}},J=class extends E{constructor(e){super(e=(0,p.IS)(e,{})),this._hasSubDirsGetter=(0,v.vb)(e.hasSubDirectoriesExpr||"hasSubDirectories"),this._getItemsFunction=this._ensureFunction(e.getItems,()=>[]),this._renameItemFunction=this._ensureFunction(e.renameItem),this._createDirectoryFunction=this._ensureFunction(e.createDirectory),this._deleteItemFunction=this._ensureFunction(e.deleteItem),this._moveItemFunction=this._ensureFunction(e.moveItem),this._copyItemFunction=this._ensureFunction(e.copyItem),this._uploadFileChunkFunction=this._ensureFunction(e.uploadFileChunk),this._abortFileUploadFunction=this._ensureFunction(e.abortFileUpload),this._downloadItemsFunction=this._ensureFunction(e.downloadItems),this._getItemsContentFunction=this._ensureFunction(e.getItemsContent)}getItems(e){var t=e.getFullPathInfo();return this._executeActionAsDeferred(()=>this._getItemsFunction(e),!0).then(e=>this._convertDataObjectsToFileItems(e,t))}renameItem(e,t){return this._executeActionAsDeferred(()=>this._renameItemFunction(e,t))}createDirectory(e,t){return this._executeActionAsDeferred(()=>this._createDirectoryFunction(e,t))}deleteItems(e){return e.map(e=>this._executeActionAsDeferred(()=>this._deleteItemFunction(e)))}moveItems(e,t){return e.map(e=>this._executeActionAsDeferred(()=>this._moveItemFunction(e,t)))}copyItems(e,t){return e.map(e=>this._executeActionAsDeferred(()=>this._copyItemFunction(e,t)))}uploadFileChunk(e,t,i){return this._executeActionAsDeferred(()=>this._uploadFileChunkFunction(e,t,i))}abortFileUpload(e,t,i){return this._executeActionAsDeferred(()=>this._abortFileUploadFunction(e,t,i))}downloadItems(e){return this._downloadItemsFunction(e)}getItemsContent(e){return this._executeActionAsDeferred(()=>this._getItemsContentFunction(e))}_hasSubDirs(e){var t=this._hasSubDirsGetter(e);return"boolean"!=typeof t||t}_getKeyExpr(e){return e.keyExpr||"key"}_ensureFunction(e,t){return t=t||p.ZT,(0,d.mf)(e)?e:t}};var W="Files";class Y{constructor(e){this._options=(0,h.l)({},e=e||{}),this._isInitialized=!1,this._dataLoading=!1,this._dataLoadingDeferred=null,this._rootDirectoryInfo=this._createRootDirectoryInfo(e.rootText),this._currentDirectoryInfo=this._rootDirectoryInfo,this._defaultIconMap=this._createDefaultIconMap(),this._setSecurityController(),this._setProvider(e.fileProvider),this._initialize()}_setSecurityController(){this._securityController=new X({allowedFileExtensions:this._options.allowedFileExtensions,maxFileSize:this._options.uploadMaxFileSize}),this._resetState()}setAllowedFileExtensions(e){(0,d.$K)(e)&&(this._options.allowedFileExtensions=e),this._setSecurityController(),this.refresh()}setUploadOptions(e){var{maxFileSize:t,chunkSize:i}=e;(0,d.$K)(i)&&(this._options.uploadChunkSize=i),(0,d.$K)(t)&&(this._options.uploadMaxFileSize=t,this._setSecurityController(),this.refresh())}_setProvider(e){this._fileProvider=this._createFileProvider(e),this._resetState()}updateProvider(e,t){return this._resetCurrentDirectory(),this._setProvider(e),this.refresh().then(()=>this.setCurrentPath(t))}_createFileProvider(e){if(e||(e=[]),Array.isArray(e))return new $({data:e});if(e instanceof E)return e;switch(e.type){case"remote":return new Q(e);case"custom":return new J(e)}return new $(e)}setCurrentPath(e){var t=M(e),i=O(...t);return this.getCurrentDirectory().fileItem.relativeName===i?(new c.BH).resolve().promise():this._setCurrentDirectoryByPathParts(t)}setCurrentPathByKeys(e){if(!(0,p.bY)(this.getCurrentDirectory().fileItem.pathKeys,e,0,!0))return this._setCurrentDirectoryByPathParts(e,!0)}getCurrentPath(){for(var e="",t=this.getCurrentDirectory();t&&!t.fileItem.isRoot();){var i=T(t.fileItem.name);e=O(i,e),t=t.parentDirectory}return e}getCurrentDirectory(){return this._currentDirectoryInfo}setCurrentDirectory(e,t){if(e&&(t&&(e=this._getActualDirectoryInfo(e)),!this._currentDirectoryInfo||this._currentDirectoryInfo!==e)){var i=this._currentDirectoryInfo.fileItem.key!==e.fileItem.key;this._currentDirectoryInfo=e,i&&this._isInitialized&&(this._dataLoading||this._raiseDataLoading("navigation"),this._raiseSelectedDirectoryChanged(e))}}_resetCurrentDirectory(){this._currentDirectoryInfo=this._rootDirectoryInfo}getCurrentItems(e){return this._dataLoadingDeferred?this._dataLoadingDeferred.then(()=>this._getCurrentItemsInternal(e)):this._getCurrentItemsInternal(e)}_getCurrentItemsInternal(e){var t=this.getCurrentDirectory();return this.getDirectoryContents(t).then(i=>{var o=this._separateItemsByType(i);return t.fileItem.hasSubDirectories=!!o.folders.length,e?o.files:i})}getDirectories(e,t){return this.getDirectoryContents(e,t).then(e=>e.filter(e=>e.fileItem.isDirectory))}_separateItemsByType(e){var t=[],i=[];return e.forEach(e=>e.fileItem.isDirectory?t.push(e):i.push(e)),{folders:t,files:i}}getDirectoryContents(e,t){if(!e)return(new c.BH).resolve([this._rootDirectoryInfo]).promise();if(e.itemsLoaded)return(new c.BH).resolve(e.items).promise();var i=e.getInternalKey(),o=this._loadedItems[i];return o||(o=this._getFileItems(e,t).then(t=>(e.items=(t=t||[]).map(t=>t.isDirectory&&this._createDirectoryInfo(t,e)||this._createFileInfo(t,e)),e.itemsLoaded=!0,e.items)),this._loadedItems[i]=o,o.always(()=>{delete this._loadedItems[i]}),o)}_getFileItems(e,t){var i=null;try{i=this._fileProvider.getItems(e.fileItem)}catch(R){return this._handleItemLoadError(e,R,t)}return(0,c.gx)(i).then(e=>this._securityController.getAllowedItems(e),i=>this._handleItemLoadError(e,i,t))}createDirectory(e,t){var i=this._createDirInfoByName(t,e),o=this._createEditActionInfo("create",i,e);return this._processEditAction(o,()=>this._fileProvider.createDirectory(e.fileItem,t).done(t=>(e.fileItem.isRoot()||(e.fileItem.hasSubDirectories=!0),t)),()=>this._resetDirectoryState(e,!0))}renameItem(e,t){var i=this._createEditActionInfo("rename",e,e.parentDirectory,{itemNewName:t});return this._processEditAction(i,()=>(e.fileItem.isDirectory||this._securityController.validateExtension(t),this._fileProvider.renameItem(e.fileItem,t)),()=>{var t=this._getActualDirectoryInfo(e.parentDirectory);this._resetDirectoryState(t),this.setCurrentDirectory(t)})}moveItems(e,t){var i=e.map(e=>e.fileItem),o=this._createEditActionInfo("move",e,t);return this._processEditAction(o,()=>this._fileProvider.moveItems(i,t.fileItem),()=>{t=this._getActualDirectoryInfo(t),e.forEach(e=>this._resetDirectoryState(e.parentDirectory,!0)),this._resetDirectoryState(t),this.setCurrentDirectory(t),t.expanded=!0})}copyItems(e,t){var i=e.map(e=>e.fileItem),o=this._createEditActionInfo("copy",e,t);return this._processEditAction(o,()=>this._fileProvider.copyItems(i,t.fileItem),()=>{t=this._getActualDirectoryInfo(t),this._resetDirectoryState(t),this.setCurrentDirectory(t),t.expanded=!0})}deleteItems(e){var t=e.map(e=>e.fileItem),i=this._createEditActionInfo("delete",e,e.length>0?e[0].parentDirectory:null);return this._processEditAction(i,()=>this._fileProvider.deleteItems(t),()=>{e.forEach(e=>{var t=this._getActualDirectoryInfo(e.parentDirectory);this._resetDirectoryState(t),this.setCurrentDirectory(t)})})}processUploadSession(e,t){var i=this._getItemInfosForUploaderFiles(e.files,t),o=this._createEditActionInfo("upload",i,t,{sessionInfo:e});return this._processEditAction(o,()=>e.deferreds,()=>this._resetDirectoryState(t,!0))}uploadFileChunk(e,t,i){return this._securityController.validateMaxFileSize(e.size),this._securityController.validateExtension(e.name),(0,c.gx)(this._fileProvider.uploadFileChunk(e,t,i))}abortFileUpload(e,t,i){return(0,c.gx)(this._fileProvider.abortFileUpload(e,t,i))}getFileUploadChunkSize(){var e=this._options.uploadChunkSize;return e&&e>0?e:this._fileProvider.getFileUploadChunkSize()}downloadItems(e){var t=e.map(e=>e.fileItem);this._fileProvider.downloadItems(t)}getItemContent(e){var t=e.map(e=>e.fileItem);return(0,c.gx)(this._fileProvider.getItemsContent(t))}_handleItemLoadError(e,t,i){e=this._getActualDirectoryInfo(e);var o=this._createEditActionInfo("getItems",e,e);return this._raiseEditActionStarting(o),this._raiseEditActionResultAcquired(o),this._raiseEditActionError(o,{errorCode:t.errorCode,errorText:t.errorText,fileItem:e.fileItem,index:0}),this._resetDirectoryState(e),e.expanded=!1,i||this.setCurrentDirectory(e.parentDirectory),(new c.BH).reject().promise()}_processEditAction(e,t,i){var o=null;this._raiseEditActionStarting(e);try{o=t()}catch(s){return this._raiseEditActionError(e,s),(new c.BH).reject().promise()}return Array.isArray(o)?o.length>1&&(e.singleRequest=!1):o=[o],this._raiseEditActionResultAcquired(e),f(o,t=>this._raiseCompleteEditActionItem(e,t),t=>this._raiseEditActionItemError(e,t)).then(()=>{i(),this._raiseCompleteEditAction(e)})}_createEditActionInfo(e,t,i,o){o=o||{};var s=(t=Array.isArray(t)?t:[t]).map(e=>e.fileItem);return{name:e,itemInfos:t,items:s,directory:i,customData:o,singleRequest:!0}}_getItemInfosForUploaderFiles(e,t){for(var i=this._getPathInfo(t),o=[],s=0;s<e.length;s++){var n=new F(i,e[s].name,!1),r=this._createFileInfo(n,t);o.push(r)}return o}refresh(){return this._lockRefresh?this._refreshDeferred:(this._lockRefresh=!0,this._executeDataLoad(()=>this._refreshDeferred=this._refreshInternal(),"refresh"))}_refreshInternal(){var e={items:this._rootDirectoryInfo.items},t=this._getDirectoryPathKeyParts(this.getCurrentDirectory());return this._resetDirectoryState(this._rootDirectoryInfo),this._loadItemsRecursive(this._rootDirectoryInfo,e).then(()=>{var e=this._findDirectoryByPathKeyParts(t);this.setCurrentDirectory(e),delete this._lockRefresh})}_loadItemsRecursive(e,t){var i=this;return this.getDirectories(e).then(e=>{for(var o=[],s=function(s){var n=(0,A.sE)(t.items,t=>e[s].fileItem.key===t.fileItem.key);if(!n)return"continue";e[s].expanded=n.expanded,e[s].expanded&&o.push(i._loadItemsRecursive(e[s],n))},n=0;n<e.length;n++)s(n);return f(o)},()=>null)}_initialize(){var e=this._options.currentPathKeys&&this._options.currentPathKeys.length?this.setCurrentPathByKeys(this._options.currentPathKeys):this.setCurrentPath(this._options.currentPath),t=()=>{this._isInitialized=!0,this._raiseInitialized()};e?(0,c.gx)(e).always(t):t()}_setCurrentDirectoryByPathParts(e,t){return this._executeDataLoad(()=>this._setCurrentDirectoryByPathPartsInternal(e,t),"navigation")}_setCurrentDirectoryByPathPartsInternal(e,t){return this._getDirectoryByPathParts(this._rootDirectoryInfo,e,t).then(e=>{for(var t=e.parentDirectory;t;t=t.parentDirectory)t.expanded=!0;this.setCurrentDirectory(e)})}_executeDataLoad(e,t){return this._dataLoadingDeferred?this._dataLoadingDeferred.then(()=>this._executeDataLoad(e,t)):(this._dataLoading=!0,this._dataLoadingDeferred=new c.BH,this._isInitialized&&this._raiseDataLoading(t),e().always(()=>{var e=this._dataLoadingDeferred;this._dataLoadingDeferred=null,this._dataLoading=!1,e.resolve()}))}_getDirectoryByPathParts(e,t,i){if(t.length<1)return(new c.BH).resolve(e).promise();var o=i?"key":"name";return this.getDirectories(e).then(e=>{var s=(0,A.sE)(e,e=>e.fileItem[o]===t[0]);if(!s)return(new c.BH).reject().promise();var n=[...t].splice(1);return this._getDirectoryByPathParts(s,n,i)})}_getDirectoryPathKeyParts(e){for(var t=[];e&&e.parentDirectory;)t.unshift(e.fileItem.key),e=e.parentDirectory;return t}_findDirectoryByPathKeyParts(e){var t=this._rootDirectoryInfo;if(0===e.length)return t;for(var i=0,o=t;o&&i<e.length;)(o=(0,A.sE)(t.items,t=>t.fileItem.key===e[i]))&&(t=o),i++;return t}_getActualDirectoryInfo(e){var t=this._getDirectoryPathKeyParts(e);return this._findDirectoryByPathKeyParts(t)}_createDirInfoByName(e,t){var i=this._getPathInfo(t),o=new F(i,e,!0);return this._createDirectoryInfo(o,t)}_createDirectoryInfo(e,t){return(0,h.l)(this._createFileInfo(e,t),{icon:"folder",expanded:e.isRoot(),items:[]})}_createFileInfo(e,t){return{fileItem:e,parentDirectory:t,icon:this._getFileItemDefaultIcon(e),getInternalKey(){return"FIK_".concat(this.fileItem.key)},getDisplayName(){return this.displayName||this.fileItem.name}}}_resetDirectoryState(e,t){t&&(e=this._getActualDirectoryInfo(e)),e.itemsLoaded=!1,e.items=[]}_getFileItemDefaultIcon(e){if(e.isDirectory)return"folder";var t=e.getFileExtension();return this._defaultIconMap[t]||"doc"}_createDefaultIconMap(){var e={".txt":"txtfile",".rtf":"rtffile",".doc":"docfile",".docx":"docxfile",".xls":"xlsfile",".xlsx":"xlsxfile",".ppt":"pptfile",".pptx":"pptxfile",".pdf":"pdffile"};return[".png",".gif",".jpg",".jpeg",".ico",".bmp"].forEach(t=>{e[t]="image"}),e}_createRootDirectoryInfo(e){var t=new F(null,"",!0),i=this._createDirectoryInfo(t,null);return i.displayName=e||W,i}setRootText(e){this._rootDirectoryInfo.displayName=e||W}_raiseInitialized(){this._options.onInitialized&&this._options.onInitialized({controller:this})}_raiseDataLoading(e){this._options.onDataLoading&&this._options.onDataLoading({operation:e})}_raiseSelectedDirectoryChanged(e){this._options.onSelectedDirectoryChanged&&this._options.onSelectedDirectoryChanged({selectedDirectoryInfo:e})}_raiseEditActionStarting(e){this._options.onEditActionStarting&&this._options.onEditActionStarting(e)}_raiseEditActionResultAcquired(e){this._options.onEditActionResultAcquired&&this._options.onEditActionResultAcquired(e)}_raiseEditActionError(e,t){this._options.onEditActionError&&this._options.onEditActionError(e,t)}_raiseEditActionItemError(e,t){this._options.onEditActionItemError&&this._options.onEditActionItemError(e,t)}_raiseCompleteEditActionItem(e,t){this._options.onCompleteEditActionItem&&this._options.onCompleteEditActionItem(e,t)}_raiseCompleteEditAction(e){this._options.onCompleteEditAction&&this._options.onCompleteEditAction(e)}_resetState(){this._selectedDirectory=null,this._rootDirectoryInfo.items=[],this._loadedItems={}}_getPathInfo(e){for(var t=[],i=e;i&&!i.fileItem.isRoot();i=i.parentDirectory)t.unshift({key:i.fileItem.key,name:i.fileItem.name});return t}on(e,t){var i="on".concat(e);this._options[i]=t}}class X{constructor(e){this._options=(0,h.l)({allowedFileExtensions:[],maxFileSize:0},e),this._extensionsMap={},this._allowedFileExtensions.forEach(e=>{this._extensionsMap[e.toUpperCase()]=!0})}getAllowedItems(e){return 0===this._allowedFileExtensions.length?e:e.filter(e=>e.isDirectory||this._isValidExtension(e.name))}validateExtension(e){if(!this._isValidExtension(e))throw new R(5,null)}validateMaxFileSize(e){if(this._maxFileSize&&e>this._maxFileSize)throw new R(6,null)}_isValidExtension(e){if(0===this._allowedFileExtensions.length)return!0;var t=D(e).toUpperCase();return this._extensionsMap[t]}get _allowedFileExtensions(){return this._options.allowedFileExtensions}get _maxFileSize(){return this._options.maxFileSize}}class ee{constructor(e){this._actions={},this._permissions=e||{},this._initCommands()}_initCommands(){this._commands=[{name:"create",text:u.Z.format("dxFileManager-commandCreate"),icon:"newfolder",enabled:this._permissions.create,noFileItemRequired:!0},{name:"rename",text:u.Z.format("dxFileManager-commandRename"),icon:"rename",enabled:this._permissions.rename,isSingleFileItemCommand:!0},{name:"move",text:u.Z.format("dxFileManager-commandMove"),icon:"movetofolder",enabled:this._permissions.move},{name:"copy",text:u.Z.format("dxFileManager-commandCopy"),icon:"copy",enabled:this._permissions.copy},{name:"delete",text:u.Z.format("dxFileManager-commandDelete"),icon:"trash",enabled:this._permissions.delete},{name:"download",text:u.Z.format("dxFileManager-commandDownload"),icon:"download",enabled:this._permissions.download},{name:"upload",text:u.Z.format("dxFileManager-commandUpload"),icon:"upload",enabled:this._permissions.upload,noFileItemRequired:!0},{name:"refresh",text:u.Z.format("dxFileManager-commandRefresh"),icon:"dx-filemanager-i dx-filemanager-i-refresh",enabled:!0,noFileItemRequired:!0},{name:"thumbnails",text:u.Z.format("dxFileManager-commandThumbnails"),icon:"mediumiconslayout",enabled:!0,noFileItemRequired:!0},{name:"details",text:u.Z.format("dxFileManager-commandDetails"),icon:"detailslayout",enabled:!0,noFileItemRequired:!0},{name:"clearSelection",text:u.Z.format("dxFileManager-commandClearSelection"),icon:"remove",enabled:!0},{name:"showNavPane",hint:u.Z.format("dxFileManager-commandShowNavPane"),icon:"menu",enabled:!1,noFileItemRequired:!0}],this._commandMap={},this._commands.forEach(e=>{this._commandMap[e.name]=e})}registerActions(e){this._actions=(0,h.l)(this._actions,e)}executeCommand(e,t){var i=(0,d.HD)(e)?e:e.name,o=this._actions[i];if(o)return o(t)}setCommandEnabled(e,t){var i=this.getCommandByName(e);i&&(i.enabled=t)}getCommandByName(e){return this._commandMap[e]}isCommandAvailable(e,t){var i=this.getCommandByName(e);if(!i||!i.enabled)return!1;if(i.noFileItemRequired)return!0;var o=t&&t.length||0;return 0!==o&&!t.some(e=>e.fileItem.isRoot()||e.fileItem.isParentFolder)&&("download"===e?t.every(e=>!e.fileItem.isDirectory):!i.isSingleFileItemCommand||1===o)}}var te=i(84019),ie={create:{},upload:{},download:{},rename:{},move:{},copy:{},delete:{},refresh:{beginGroup:!0}},oe=["beginGroup","closeMenuOnClick","disabled","icon","selectable","selected","text","visible"];const se=class extends g.Z{_initMarkup(){this._initActions(),this._isVisible=!1;var e=(0,l.Z)("<div>").appendTo(this.$element());this._contextMenu=this._createComponent(e,te.Z,{cssClass:"dx-filemanager-context-menu",showEvent:"",onItemClick:e=>this._onContextMenuItemClick(e.itemData.name,e),onShowing:e=>this._onContextMenuShowing(e),onShown:()=>this._onContextMenuShown(),onHidden:()=>this._onContextMenuHidden()}),super._initMarkup()}showAt(e,t,i,o){var{itemData:s,itemElement:n,isActionButton:r=!1}=o;this._isVisible&&this._onContextMenuHidden(),this._menuShowingContext={targetElement:n,itemData:s,fileItems:e,event:i,isActionButton:r};var a={of:t,at:"top left",my:"top left",offset:""};i?a.offset=i.offsetX+" "+i.offsetY:(a.my="left top",a.at="left bottom",a.boundaryOffset="1"),this._contextMenu.option({target:t,position:a}),this._contextMenu.show()}createContextMenuItems(e,t,i){this._targetFileItems=e,this._targetFileItem=(0,d.$K)(i)?i:null==e?void 0:e[0];var o=[];return(t||this.option("items")).forEach(t=>{var i=(0,d.HD)(t)?t:t.name,s=this._configureItemByCommandName(i,t,e,this._targetFileItem);this._isContextMenuItemAvailable(s,e)&&o.push(s)}),o}_isContextMenuItemAvailable(e,t){return this._isDefaultItem(e.name)&&e._autoHide?!(this._isIsolatedCreationItemCommand(e.name)&&t&&t.length)&&this._commandManager.isCommandAvailable(e.name,t):(0,p.IS)(e.visible,!0)}_isIsolatedCreationItemCommand(e){return("create"===e||"upload"===e)&&this.option("isolateCreationItemCommands")}_isDefaultItem(e){return!!ie[e]}_configureItemByCommandName(e,t,i,o){if(!this._isDefaultItem(e)){var s=(0,h.l)(!0,{},t);return s.originalItemData=t,this._addItemClickHandler(e,s),Array.isArray(t.items)&&(s.items=this.createContextMenuItems(i,t.items,o)),s}var n=this._createMenuItemByCommandName(e);return(0,h.l)(n,ie[e]),n.originalItemData=t,b(n,t,oe),(0,d.$K)(n.visible)||(n._autoHide=!0),e&&!n.name&&(0,h.l)(n,{name:e}),n}_createMenuItemByCommandName(e){var{text:t,icon:i}=this._commandManager.getCommandByName(e),o={name:e,text:t,icon:i};return this._addItemClickHandler(e,o),o}_addItemClickHandler(e,t){t.onItemClick=t=>this._onContextMenuItemClick(e,t)}_onContextMenuItemClick(e,t){var i,o=(0,h.l)(!0,{},t);if(o.itemData=t.itemData.originalItemData,o.fileSystemItem=null===(i=this._targetFileItem)||void 0===i?void 0:i.fileItem,o.viewArea=this.option("viewArea"),this._actions.onItemClick(o),this._isDefaultItem(e)){var s=this._isIsolatedCreationItemCommand(e)?null:this._targetFileItems;this._commandManager.executeCommand(e,s)}}_initActions(){this._actions={onContextMenuHidden:this._createActionByOption("onContextMenuHidden"),onContextMenuShowing:this._createActionByOption("onContextMenuShowing"),onItemClick:this._createActionByOption("onItemClick")}}_onContextMenuShowing(e){if(this._isVisible&&this._onContextMenuHidden(),e=(0,h.l)(e,this._menuShowingContext,{options:this.option(),cancel:!1}),this._actions.onContextMenuShowing(e),!e.cancel){var t=this.createContextMenuItems(this._menuShowingContext.fileItems,null,this._menuShowingContext.fileSystemItem);this._contextMenu.option("dataSource",t)}}_onContextMenuShown(){this._isVisible=!0}_onContextMenuHidden(){this._isVisible=!1,this._menuShowingContext={},this._contextMenu.option("visible",!1),this._raiseContextMenuHidden()}_raiseContextMenuHidden(){this._actions.onContextMenuHidden()}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{commandManager:null,onContextMenuHidden:null,onItemClick:null})}_optionChanged(e){var t=e.name;switch(t){case"commandManager":this.repaint();break;case"items":if(this._isVisible){var i=this.createContextMenuItems(this._targetFileItems);this._contextMenu.option("dataSource",i)}break;case"onItemClick":case"onContextMenuShowing":case"onContextMenuHidden":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}get _commandManager(){return this.option("commandManager")}};var ne=i(74935),re=i(90223),ae=i(50226);const le=class extends g.Z{_initMarkup(){this._createClickAction();var e=(0,l.Z)("<div>");this.$element().append(e).addClass("dx-filemanager-file-actions-button"),this._button=this._createComponent(e,ae.Z,{icon:"overflow",stylingMode:"text",onClick:e=>this._raiseClick(e)}),super._initMarkup()}_createClickAction(){this._clickAction=this._createActionByOption("onClick")}_raiseClick(e){this._clickAction(e)}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{cssClass:"",onClick:null})}_optionChanged(e){switch(e.name){case"cssClass":this.repaint();break;case"onClick":this._createClickAction();break;default:super._optionChanged(e)}}setActive(e){this.$element().toggleClass("dx-filemanager-file-actions-button-activated",e),setTimeout(()=>this._button.$element().toggleClass("dx-state-active",e))}};var he="dx-filemanager-focused-item";const de=class extends g.Z{_initMarkup(){this._initActions(),this._getCurrentDirectory=this.option("getCurrentDirectory"),this._createFileActionsButton=p.ZT,this._storeExpandedState=this.option("storeExpandedState")||!1;var e=(0,l.Z)("<div>").addClass("dx-filemanager-dirs-tree").appendTo(this.$element()),t={dataStructure:"plain",rootValue:"",createChildren:this._onFilesTreeViewCreateSubDirectories.bind(this),itemTemplate:this._createFilesTreeViewItemTemplate.bind(this),keyExpr:"getInternalKey",parentIdExpr:"parentDirectory.getInternalKey",displayExpr:e=>e.getDisplayName(),hasItemsExpr:"fileItem.hasSubDirectories",onItemClick:e=>this._actions.onDirectoryClick(e),onItemExpanded:e=>this._onFilesTreeViewItemExpanded(e),onItemCollapsed:e=>this._onFilesTreeViewItemCollapsed(e),onItemRendered:e=>this._onFilesTreeViewItemRendered(e),onContentReady:()=>this._actions.onFilesTreeViewContentReady()};this._contextMenu&&(this._contextMenu.option("onContextMenuHidden",()=>this._onContextMenuHidden()),t.onItemContextMenu=e=>this._onFilesTreeViewItemContextMenu(e),this._createFileActionsButton=(e,t)=>this._createComponent(e,le,t)),this._filesTreeView=this._createComponent(e,re.Z,t)}_initActions(){this._actions={onDirectoryClick:this._createActionByOption("onDirectoryClick"),onFilesTreeViewContentReady:this._createActionByOption("onFilesTreeViewContentReady")}}_render(){super._render();var e=this;setTimeout(()=>{e._updateFocusedElement()})}_onFilesTreeViewCreateSubDirectories(e){var t=this.option("getDirectories");return t&&t(e&&e.itemData||null,!0)}_onFilesTreeViewItemRendered(e){var{itemData:t}=e,i=this._getCurrentDirectory();i&&i.fileItem.equals(t.fileItem)&&(this._updateFocusedElement(),this._restoreScrollTopPosition())}_onFilesTreeViewItemExpanded(e){var{itemData:t}=e;this._storeExpandedState&&(t.expanded=!0)}_onFilesTreeViewItemCollapsed(e){var{itemData:t}=e;this._storeExpandedState&&(t.expanded=!1)}_createFilesTreeViewItemTemplate(e,t,i){var o=(0,l.Z)(i);o.closest(this._filesTreeViewItemSelector).data("item",e);var s=(0,ne.H)(e.icon),n=(0,l.Z)("<span>").text(e.getDisplayName()).addClass("dx-filemanager-dirs-tree-item-text"),r=(0,l.Z)("<div>");o.append(s,n,r),this._createFileActionsButton(r,{onClick:e=>this._onFileItemActionButtonClick(e)})}_onFilesTreeViewItemContextMenu(e){var{itemElement:t,event:i}=e;i.preventDefault(),i.stopPropagation();var o=(0,l.Z)(t).data("item");this._contextMenu.showAt([o],t,i,{itemData:o,itemElement:t})}_onFileItemActionButtonClick(e){var{component:t,element:i,event:o}=e;o.stopPropagation();var s=t.$element().closest(this._filesTreeViewItemSelector),n=s.data("item");this._contextMenu.showAt([n],i,o,{itemData:n,itemElement:s,isActionButton:!0}),this._activeFileActionsButton=t,this._activeFileActionsButton.setActive(!0)}_onContextMenuHidden(){this._activeFileActionsButton&&this._activeFileActionsButton.setActive(!1)}toggleNodeDisabledState(e,t){var i=this._getNodeByKey(e);if(i){var o=this._filesTreeView.option("items").map(e=>e.getInternalKey()).indexOf(i.getInternalKey());-1!==o&&this._filesTreeView.option("items[".concat(o,"].disabled"),t)}}_saveScrollTopPosition(){(0,B.Ym)()&&(this._scrollTopPosition=this._filesTreeView._scrollableContainer.scrollTop())}_restoreScrollTopPosition(){(0,B.Ym)()&&(0,d.kE)(this._scrollTopPosition)&&setTimeout(()=>this._filesTreeView._scrollableContainer.scrollTo(this._scrollTopPosition))}_updateFocusedElement(){var e=this._getCurrentDirectory(),t=this._getItemElementByKey(null==e?void 0:e.getInternalKey());this._$focusedElement&&this._$focusedElement.toggleClass(he,!1),this._$focusedElement=t||(0,l.Z)(),this._$focusedElement.toggleClass(he,!0)}_getNodeByKey(e){var t;return null===(t=this._filesTreeView)||void 0===t?void 0:t._getNode(e)}_getPublicNode(e){for(var t,i=[...null===(t=this._filesTreeView)||void 0===t?void 0:t.getNodes()];i.length;){var o=i.shift();if(o.itemData.getInternalKey()===e)return o;o.children.length&&i.push(...o.children)}}_getItemElementByKey(e){var t=this._getNodeByKey(e);if(t){var i=this._filesTreeView._getNodeElement(t);if(i)return i.children(this._filesTreeViewItemSelector)}return null}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{storeExpandedState:!1,initialFolder:null,contextMenu:null,getItems:null,getCurrentDirectory:null,onDirectoryClick:null})}_optionChanged(e){var t=e.name;switch(t){case"storeExpandedState":this._storeExpandedState=this.option(t);break;case"getItems":case"rootFolderDisplayName":case"initialFolder":case"contextMenu":this.repaint();break;case"getCurrentDirectory":this.getCurrentDirectory=this.option(t);break;case"onDirectoryClick":case"onFilesTreeViewContentReady":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}get _filesTreeViewItemSelector(){return".".concat("dx-treeview-item")}get _contextMenu(){return this.option("contextMenu")}toggleDirectoryExpandedState(e,t){var i=new c.BH,o=this._getPublicNode(null==e?void 0:e.getInternalKey());return o?o.expanded===t||o.itemsLoaded&&!o.itemData.fileItem.hasSubDirectories?i.resolve().promise():this._filesTreeView[t?"expandItem":"collapseItem"](e.getInternalKey()):i.reject().promise()}refresh(){this._$focusedElement=null,this._saveScrollTopPosition(),this._filesTreeView.option("dataSource",[])}updateCurrentDirectory(){this._disposed||(this._updateFocusedElement(),this._storeExpandedState&&this._updateExpandedStateToCurrentDirectory())}_updateExpandedStateToCurrentDirectory(){return this.toggleDirectoryExpandedStateRecursive(this._getCurrentDirectory().parentDirectory,!0)}toggleDirectoryExpandedStateRecursive(e,t){for(var i=[],o=e;o;o=o.parentDirectory)i.unshift(o);return this.toggleDirectoryLineExpandedState(i,t)}toggleDirectoryLineExpandedState(e,t){return e.length?this.toggleDirectoryExpandedState(e.shift(),t).then(()=>this.toggleDirectoryLineExpandedState(e,t)):(new c.BH).resolve().promise()}};var ce=i(33699),pe=i(12519),ue=i(14277),me=i(9690),ge=i(10451);const _e=class extends g.Z{_init(){this._initActions(),this._lockFocusedItemProcessing=!1,this._focusedItemKey=this.option("focusedItemKey"),super._init()}_initMarkup(){this.$element().addClass("dx-filemanager-files-view");var e=(0,ue.V4)(pe.u,"dxFileManager_open");H.Z.on(this.$element(),e,this._getItemSelector(),this._onItemDblClick.bind(this)),super._initMarkup()}_initActions(){this._actions={onError:this._createActionByOption("onError"),onSelectionChanged:this._createActionByOption("onSelectionChanged"),onFocusedItemChanged:this._createActionByOption("onFocusedItemChanged"),onSelectedItemOpened:this._createActionByOption("onSelectedItemOpened"),onContextMenuShowing:this._createActionByOption("onContextMenuShowing")}}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{selectionMode:"single",selectedItemKeys:[],focusedItemKey:void 0,contextMenu:null,getItems:null,getItemThumbnail:null,onError:null,onSelectionChanged:null,onFocusedItemChanged:null,onSelectedItemOpened:null,onContextMenuShowing:null})}_optionChanged(e){var t=e.name;switch(t){case"selectionMode":case"contextMenu":case"getItems":case"getItemThumbnail":this.repaint();break;case"selectedItemKeys":this._setSelectedItemKeys(e.value);break;case"focusedItemKey":this._lockFocusedItemProcessing||this._setFocusedItemKey(e.value);break;case"onError":case"onSelectedItemOpened":case"onSelectionChanged":case"onFocusedItemChanged":case"onContextMenuShowing":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}_getItems(){return this._getItemsInternal().done(e=>{this._itemCount=e.length,0===this._itemCount&&this._resetFocus();var t=this._findParentDirectoryItem(e);this._hasParentDirectoryItem=!!t,this._parentDirectoryItemKey=t?t.fileItem.key:null})}_getItemsInternal(){var e=this.option("getItems"),t=e?e():[];return(0,c.gx)(t)}_raiseOnError(e){this._actions.onError({error:e})}_raiseSelectionChanged(e){this._actions.onSelectionChanged(e)}_raiseFocusedItemChanged(e){this._actions.onFocusedItemChanged(e)}_raiseSelectedItemOpened(e){this._actions.onSelectedItemOpened({fileItemInfo:e})}_raiseContextMenuShowing(e){this._actions.onContextMenuShowing(e)}_tryRaiseSelectionChanged(e){var{selectedItemInfos:t,selectedItems:i,selectedItemKeys:o,currentSelectedItemKeys:s,currentDeselectedItemKeys:n}=e,r=this._findParentDirectoryItem(this.getSelectedItems());r&&this._deselectItem(r);var a=!this._hasParentDirectoryItem;(a=a||this._hasValidKeys(s)||this._hasValidKeys(n))&&(t=this._filterOutItemByPredicate(t,e=>e.fileItem.key===this._parentDirectoryItemKey),i=this._filterOutParentDirectory(i),o=this._filterOutParentDirectoryKey(o,!0),s=this._filterOutParentDirectoryKey(s,!0),n=this._filterOutParentDirectoryKey(n,!0),this._raiseSelectionChanged({selectedItemInfos:t,selectedItems:i,selectedItemKeys:o,currentSelectedItemKeys:s,currentDeselectedItemKeys:n}))}_onFocusedItemChanged(e){this._focusedItemKey!==e.itemKey&&(this._focusedItemKey=e.itemKey,this._lockFocusedItemProcessing=!0,this.option("focusedItemKey",e.itemKey),this._lockFocusedItemProcessing=!1,this._raiseFocusedItemChanged(e))}_resetFocus(){}_getItemThumbnail(e){var t=this.option("getItemThumbnail");return t?t(e):{thumbnail:""}}_getItemThumbnailContainer(e){var{thumbnail:t,cssClass:i}=this._getItemThumbnail(e),o=(0,ne.H)(t).addClass(this._getItemThumbnailCssClass());return i&&o.addClass(i),o}_getItemThumbnailCssClass(){return""}_getItemSelector(){}_onItemDblClick(e){}_isDesktop(){return"desktop"===me.Z.real().deviceType}_showContextMenu(e,t,i,o){this._contextMenu.showAt(e,t,i,o)}get _contextMenu(){return this.option("contextMenu")}_findParentDirectoryItem(e){for(var t=0;t<e.length;t++){var i=e[t];if(this._isParentDirectoryItem(i))return i}return null}_getFileItemsForContextMenu(e){var t=this.getSelectedItems();return this._isParentDirectoryItem(e)&&t.push(e),t}_isParentDirectoryItem(e){return e.fileItem.isParentFolder}_hasValidKeys(e){return e.length>1||1===e.length&&e[0]!==this._parentDirectoryItemKey}_filterOutParentDirectory(e,t){return this._filterOutItemByPredicate(e,e=>e.key===this._parentDirectoryItemKey,t)}_filterOutParentDirectoryKey(e,t){return this._filterOutItemByPredicate(e,e=>e===this._parentDirectoryItemKey,t)}_filterOutItemByPredicate(e,t,i){for(var o=e,s=-1,n=0;n<e.length;n++)if(t(e[n])){s=n;break}return-1!==s&&(i&&(o=[...e]),o.splice(s,1)),o}_isMultipleSelectionMode(){return"multiple"===this.option("selectionMode")}_deselectItem(e){}_setSelectedItemKeys(e){}_setFocusedItemKey(e){}_createDataSource(){return{store:new ge.Z({key:"fileItem.key",load:this._getItems.bind(this)})}}getSelectedItems(){}clearSelection(){}selectItem(){}};var fe={thumbnail:{caption:"",calculateSortValue:"isDirectory",width:36,alignment:"center",cssClass:"dx-filemanager-details-item-is-directory"},name:{caption:u.Z.format("dxFileManager-listDetailsColumnCaptionName")},dateModified:{caption:u.Z.format("dxFileManager-listDetailsColumnCaptionDateModified"),width:110,hidingPriority:1},size:{caption:u.Z.format("dxFileManager-listDetailsColumnCaptionFileSize"),width:90,alignment:"right",hidingPriority:0},isParentFolder:{caption:"isParentFolder",visible:!1,sortIndex:0,sortOrder:"asc"}};const Ce=class extends _e{_initMarkup(){this._itemCount=0,this._focusedItem=null,this._hasParentDirectoryItem=!1,this._parentDirectoryItemKey=null,this._selectAllCheckBox=null,this._selectAllCheckBoxUpdating=!1,this.$element().addClass("dx-filemanager-details"),this._createFilesView(),this._contextMenu.option("onContextMenuHidden",()=>this._onContextMenuHidden()),super._initMarkup()}_createFilesView(){var e=(0,l.Z)("<div>").appendTo(this.$element()),t=this._isMultipleSelectionMode()?"multiple":"none";this._filesView=this._createComponent(e,ce.Z,{dataSource:this._createDataSource(),hoverStateEnabled:!0,selection:{mode:t,showCheckBoxesMode:this._isDesktop()?"onClick":"none"},selectedRowKeys:this.option("selectedItemKeys"),focusedRowKey:this.option("focusedItemKey"),focusedRowEnabled:!0,allowColumnResizing:!0,scrolling:{mode:"virtual"},sorting:{mode:"single",showSortIndexes:!1},showColumnLines:!1,showRowLines:!1,columnHidingEnabled:!1,columns:this._createColumns(),onEditorPreparing:this._onEditorPreparing.bind(this),onRowPrepared:this._onRowPrepared.bind(this),onContextMenuPreparing:this._onContextMenuPreparing.bind(this),onSelectionChanged:this._onFilesViewSelectionChanged.bind(this),onFocusedRowChanged:this._onFilesViewFocusedRowChanged.bind(this),onOptionChanged:this._onFilesViewOptionChanged.bind(this),onContentReady:()=>{var e;return null===(e=this._refreshDeferred)||void 0===e?void 0:e.resolve()}})}_createColumns(){var e=this.option("detailColumns");e=(e=e.slice(0)).map(e=>{var t=e;return(0,d.HD)(e)&&(t={dataField:e}),this._getPreparedColumn(t)});var t=this.option("customizeDetailColumns");return(0,d.mf)(t)&&(e=t(e)),e.push(this._getPreparedColumn({dataField:"isParentFolder"})),e.forEach(e=>this._updateColumnDataField(e)),e}_getPreparedColumn(e){var t={},i="";if(this._isDefaultColumn(e.dataField)){var o=(0,h.l)(!0,{},fe[e.dataField]);switch(i=o.cssClass||"",e.dataField){case"thumbnail":o.cellTemplate=this._createThumbnailColumnCell.bind(this),o.calculateSortValue="fileItem.".concat(o.calculateSortValue);break;case"name":o.cellTemplate=this._createNameColumnCell.bind(this),o.caption=u.Z.format("dxFileManager-listDetailsColumnCaptionName");break;case"size":o.calculateCellValue=this._calculateSizeColumnCellValue.bind(this),o.caption=u.Z.format("dxFileManager-listDetailsColumnCaptionFileSize"),o.calculateSortValue=e=>e.fileItem.isDirectory?-1:e.fileItem.size;break;case"dateModified":o.caption=u.Z.format("dxFileManager-listDetailsColumnCaptionDateModified")}(0,h.l)(!0,t,o)}return b(t,e,["alignment","caption","dataField","dataType","hidingPriority","sortIndex","sortOrder","visible","visibleIndex","width"]),e.cssClass&&(i="".concat(i," ").concat(e.cssClass)),i&&(t.cssClass=i),t}_updateColumnDataField(e){var t=this._isDefaultColumn(e.dataField)?"":"dataItem.";return e.dataField="fileItem."+t+e.dataField,e}_isDefaultColumn(e){return!!fe[e]}_onFileItemActionButtonClick(e){var{component:t,element:i,event:o}=e;o.stopPropagation();var s=t.$element().closest(this._getItemSelector()),n=s.data("item");this._selectItem(n);var r={itemData:n,itemElement:s,isActionButton:!0},a=this._getFileItemsForContextMenu(n);this._showContextMenu(a,i,o,r),this._activeFileActionsButton=t,this._activeFileActionsButton.setActive(!0)}_onContextMenuHidden(){this._activeFileActionsButton&&this._activeFileActionsButton.setActive(!1)}_getItemThumbnailCssClass(){return"dx-filemanager-details-item-thumbnail"}_getItemSelector(){return".".concat("dx-data-row")}_onItemDblClick(e){var t=(0,l.Z)(e.currentTarget).data("item");this._raiseSelectedItemOpened(t)}_isAllItemsSelected(){var e=this._hasParentDirectoryItem?this._itemCount-1:this._itemCount,t=this._filesView.option("selectedRowKeys");return!!t.length&&(t.length>=e||void 0)}_onEditorPreparing(e){var{component:t,command:i,row:o,parentType:s,editorOptions:n}=e;this._filesView||(this._filesView=t),"select"===i&&o?this._isParentDirectoryItem(o.data)&&(n.disabled=!0):"headerRow"===s&&(n.onInitialized=e=>{var{component:t}=e;this._selectAllCheckBox=t},n.value=this._isAllItemsSelected(),n.onValueChanged=e=>this._onSelectAllCheckBoxValueChanged(e))}_onSelectAllCheckBoxValueChanged(e){var{event:t,previousValue:i,value:o}=e;t?this._isAllItemsSelected()!==o&&(o?this._filesView.selectAll():this._filesView.deselectAll(),t.preventDefault()):i&&!this._selectAllCheckBoxUpdating&&this._selectAllCheckBox&&this._selectAllCheckBox.option("value",i)}_onRowPrepared(e){var{rowType:t,rowElement:i,data:o}=e;if("data"===t){var s=(0,l.Z)(i);s.data("item",o),this._isParentDirectoryItem(o)&&s.addClass("dx-filemanager-parent-directory-item")}}_onContextMenuPreparing(e){if(this._isDesktop()){var t=null,i={};e.row&&"data"===e.row.rowType&&(this._selectItem(i=e.row.data),t=this._getFileItemsForContextMenu(i));var o=(0,h.l)({},{targetElement:"content"===e.target&&(0,d.$K)(e.row)?this._filesView.getRowElement(e.rowIndex):void 0,itemData:i,options:this._contextMenu.option(),event:e.event,isActionButton:!1,cancel:!1});this._raiseContextMenuShowing(o),e.items=o.cancel?[]:this._contextMenu.createContextMenuItems(t,null,i)}}_onFilesViewSelectionChanged(e){var{component:t,selectedRowsData:i,selectedRowKeys:o,currentSelectedRowKeys:s,currentDeselectedRowKeys:n}=e;this._filesView=this._filesView||t,this._selectAllCheckBox&&(this._selectAllCheckBoxUpdating=!0,this._selectAllCheckBox.option("value",this._isAllItemsSelected()),this._selectAllCheckBoxUpdating=!1);var r=i.map(e=>e.fileItem);this._tryRaiseSelectionChanged({selectedItemInfos:i,selectedItems:r,selectedItemKeys:o,currentSelectedItemKeys:s,currentDeselectedItemKeys:n})}_onFilesViewFocusedRowChanged(e){var t,i;this._isMultipleSelectionMode()||this._selectItemSingleSelection(null===(i=e.row)||void 0===i?void 0:i.data);var o=(null===(t=e.row)||void 0===t?void 0:t.data.fileItem)||null;this._onFocusedItemChanged({item:o,itemKey:null==o?void 0:o.key,itemElement:e.rowElement})}_onFilesViewOptionChanged(e){var{fullName:t}=e;t.indexOf("sortOrder")>-1&&this._filesView.columnOption("isParentFolder",{sortOrder:"asc",sortIndex:0})}_resetFocus(){this._setFocusedItemKey(void 0)}_createThumbnailColumnCell(e,t){this._getItemThumbnailContainer(t.data).appendTo(e)}_createNameColumnCell(e,t){var i=(0,l.Z)("<div>"),o=(0,l.Z)("<span>").text(t.data.fileItem.name).addClass("dx-filemanager-details-item-name"),s=(0,l.Z)("<div>").append(o,i).addClass("dx-filemanager-details-item-name-wrapper");(0,l.Z)(e).append(s),this._createComponent(i,le,{onClick:e=>this._onFileItemActionButtonClick(e)})}_calculateSizeColumnCellValue(e){return e.fileItem.isDirectory?"":C(e.fileItem.size)}_selectItem(e){(this._isMultipleSelectionMode()?this._selectItemMultipleSelection:this._selectItemSingleSelection).call(this,e)}_deselectItem(e){this._filesView.deselectRows([e.fileItem.key])}_selectItemSingleSelection(e){if(!this._focusedItem||!e||this._focusedItem.fileItem.key!==e.fileItem.key){var t=this._focusedItem;this._focusedItem=e;var i=[];t&&i.push(t.fileItem.key);var o=[],s=[];e&&!this._isParentDirectoryItem(e)&&(o.push(e.fileItem),s.push(e.fileItem.key)),this._raiseSelectionChanged({selectedItems:o,selectedItemKeys:s,currentSelectedItemKeys:[...s],currentDeselectedItemKeys:i})}}_selectItemMultipleSelection(e){var{fileItem:t}=e;if(!this._filesView.isRowSelected(t.key)){var i=this._filesView.getController("selection").isSelectionWithCheckboxes();this._filesView.selectRows([t.key],i)}}_setSelectedItemKeys(e){this._filesView.option("selectedRowKeys",e)}_setFocusedItemKey(e){var t;null===(t=this._filesView)||void 0===t||t.option("focusedRowKey",e)}clearSelection(){this._isMultipleSelectionMode()?this._filesView.clearSelection():this._filesView.option("focusedRowIndex",-1)}refresh(e){var t={dataSource:this._createDataSource()};return e&&Object.prototype.hasOwnProperty.call(e,"focusedItemKey")&&((0,d.$K)(e.focusedItemKey)?t.focusedRowKey=e.focusedItemKey:t.focusedRowIndex=-1),this._filesView.option(t),this._refreshDeferred=new c.BH,this._refreshDeferred.promise()}getSelectedItems(){return this._isMultipleSelectionMode()?this._filesView.getSelectedRowsData():this._focusedItem&&!this._isParentDirectoryItem(this._focusedItem)?[this._focusedItem]:[]}};var be=i(15905),Ie=i(40945),ve=i(53873),ye=i(8380),xe=i(71556),Se=i(42613),De=(0,ue.V4)(Ie.Z.name,"dxFileManagerThumbnailsListBox");class we{constructor(e,t,i,o){this._layoutModel=null,this._scrollView=e,this._$viewPort=t,this._$itemContainer=i,this._$item=o}updateItems(e){this._$item=e}reset(){this._layoutModel=null}getLayoutModel(){return this._layoutModel||(this._layoutModel=this._createLayoutModel()),this._layoutModel}_createLayoutModel(){if(!this._$item)return null;var e=this._$item.outerWidth(!0);if(0===e)return null;var t=this._$item.outerHeight(!0),i=this._$itemContainer.innerWidth(),o=this._$viewPort.innerHeight(),s=this._scrollView.scrollTop();return{itemWidth:e,itemHeight:t,viewPortWidth:i,viewPortHeight:o,viewPortScrollTop:s,viewPortScrollBottom:s+o,itemPerRowCount:Math.floor(i/e),rowPerPageRate:o/t}}createItemLayoutModel(e){var t=this.getLayoutModel();if(!t)return null;var i=Math.floor(e/t.itemPerRowCount),o=i*t.itemHeight;return{itemRowIndex:i,itemColumnIndex:e%t.itemPerRowCount,itemTop:o,itemBottom:o+t.itemHeight}}scrollToItem(e){var t=this.getLayoutModel();if(t){var i=Math.floor(e/t.itemPerRowCount)*t.itemHeight,o=i+t.itemHeight,s=t.viewPortScrollTop;i<t.viewPortScrollTop?s=i:o>t.viewPortScrollBottom&&(s=o-t.viewPortHeight),this._scrollView.scrollTo(s)}}}const Me=class extends xe.Z{_initMarkup(){this._initActions(),this._lockFocusedItemProcessing=!1,this.$element().addClass("dx-filemanager-thumbnails-view-port"),this._renderScrollView(),this._renderItemsContainer(),this._createScrollViewControl(),super._initMarkup(),this.onFocusedItemChanged=this._onFocusedItemChanged.bind(this),this._layoutUtils=new we(this._scrollView,this.$element(),this._$itemContainer,this.itemElements().first()),this._syncFocusedItemKey()}_initActions(){this._actions={onItemEnterKeyPressed:this._createActionByOption("onItemEnterKeyPressed"),onFocusedItemChanged:this._createActionByOption("onFocusedItemChanged")}}_initTemplates(){super._initTemplates(),this._itemThumbnailTemplate=this.option("itemThumbnailTemplate"),this._getTooltipText=this.option("getTooltipText"),this._templateManager.addDefaultTemplates({item:new ve.c((function(e,t,i){var o=this._getDefaultItemTemplate(i,e);e.append(o)}).bind(this),["fileItem"],this.option("integrationOptions.watchMethod"))})}_createScrollViewControl(){this._scrollView||(this._scrollView=this._createComponent(this._$scrollView,ye.Z,{scrollByContent:!0,scrollByThumb:!0,useKeyboard:!1,showScrollbar:"onHover"}))}_renderScrollView(){this._$scrollView||(this._$scrollView=(0,l.Z)("<div>").appendTo(this.$element()))}_renderItemsContainer(){this._$itemContainer||(this._$itemContainer=(0,l.Z)("<div>").addClass("dx-filemanager-thumbnails-container").appendTo(this._$scrollView))}_render(){super._render(),this._detachEventHandlers(),this._attachEventHandlers()}_clean(){this._detachEventHandlers(),super._clean()}_supportedKeys(){return(0,h.l)(super._supportedKeys(),{upArrow(e){this._beforeKeyProcessing(e),this._processArrowKeys(-1,!1,e)},downArrow(e){this._beforeKeyProcessing(e),this._processArrowKeys(1,!1,e)},home(e){this._beforeKeyProcessing(e),this._processHomeEndKeys(0,!0,e)},end(e){this._beforeKeyProcessing(e),this._processHomeEndKeys(this._getItemsLength()-1,!0,e)},pageUp(e){this._beforeKeyProcessing(e),this._processPageChange(!0,e)},pageDown(e){this._beforeKeyProcessing(e),this._processPageChange(!1,e)},enter(e){this._beforeKeyProcessing(e),this._actions.onItemEnterKeyPressed(this._getFocusedItem())},A(e){this._beforeKeyProcessing(e),(0,ue.j1)(e)&&this.selectAll()}})}_beforeKeyProcessing(e){e.preventDefault(),this._layoutUtils.reset()}_processArrowKeys(e,t,i){var o=this._getFocusedItem();if(o){if(!t){var s=this._layoutUtils.getLayoutModel();if(!s)return;e*=s.itemPerRowCount}var n=this._getIndexByItem(o)+e;this._focusItemByIndex(n,!0,i)}}_processHomeEndKeys(e,t,i){this._focusItemByIndex(e,t,i)}_processPageChange(e,t){var i=this._getFocusedItem();if(i){var o=this._layoutUtils.getLayoutModel();if(o){var s=this._layoutUtils.createItemLayoutModel(this._getIndexByItem(i)),n=(e?Math.ceil:Math.floor)(s.itemRowIndex-(e?o.rowPerPageRate:-o.rowPerPageRate))*o.itemPerRowCount+s.itemColumnIndex;n<0?n=0:n>=this._getItemsLength()&&(n=this._getItemsLength()-1),this._focusItemByIndex(n,!0,t)}}}_processLongTap(e){var t=this._closestItemElement((0,l.Z)(e.target)),i=this._getIndexByItemElement(t);this._selection.changeItemSelection(i,{control:!0})}_attachEventHandlers(){"multiple"===this.option("selectionMode")&&H.Z.on(this._itemContainer(),De,".".concat(this._itemContentClass()),e=>{this._processLongTap(e),e.stopPropagation()}),H.Z.on(this._itemContainer(),"mousedown selectstart",e=>{e.shiftKey&&e.preventDefault()})}_detachEventHandlers(){H.Z.off(this._itemContainer(),De),H.Z.off(this._itemContainer(),"mousedown selectstart")}_itemContainer(){return this._$itemContainer}_itemClass(){return"dx-filemanager-thumbnails-item"}_itemDataKey(){return"dxFileManagerItemData"}_getDefaultItemTemplate(e,t){t.attr("title",this._getTooltipText(e));var i=this._itemThumbnailTemplate(e),o=(0,l.Z)("<div>").addClass("dx-filemanager-thumbnails-item-spacer"),s=(0,l.Z)("<div>").addClass("dx-filemanager-thumbnails-item-name").text(e.fileItem.name);t.append(i,o,s)}_itemSelectHandler(e){var t={};"multiple"===this.option("selectionMode")&&(this._isPreserveSelectionMode||(this._isPreserveSelectionMode=(0,ue.j1)(e)||e.shiftKey),t={control:this._isPreserveSelectionMode,shift:e.shiftKey});var i=this._getIndexByItemElement(e.currentTarget);this._selection.changeItemSelection(i,t)}_initSelectionModule(){super._initSelectionModule();var e=(0,h.l)(this._selection.options,{selectedKeys:this.option("selectedItemKeys"),onSelectionChanged:e=>{this.option("selectedItems",this._getItemsByKeys(e.selectedItemKeys,e.selectedItems)),this._updateSelectedItems(e)}});this._selection=new Se.Z(e)}_updateSelectedItems(e){var t=e.addedItemKeys,i=e.removedItemKeys;if(this._rendered&&(t.length||i.length)){var o=this._selectionChangePromise;if(!this._rendering){var s,n=[],r=[];this._editStrategy.beginCache();for(var a=0;a<i.length;a++)s=this._getIndexByKey(i[a]),r.push(s),this._removeSelection(s);for(var l=0;l<t.length;l++)s=this._getIndexByKey(t[l]),n.push(s),this._addSelection(s);this._editStrategy.endCache(),this._updateSelection(n,r)}(0,c.gx)(o).done(()=>this._fireSelectionChangeEvent(e))}}_fireSelectionChangeEvent(e){this._createActionByOption("onSelectionChanged",{excludeValidators:["disabled","readOnly"]})(e)}_updateSelection(e,t){0===this.getSelectedItems().length&&(this._isPreserveSelectionMode=!1)}_normalizeSelectedItems(){var e=this._getKeysByItems(this.option("selectedItems")),t=this._selection.getSelectedItemKeys();return this._compareKeys(t,e)||this._selection.setSelection(e),(new c.BH).resolve().promise()}_focusOutHandler(){}_getItems(){return this.option("items")||[]}_getItemsLength(){return this._getItems().length}_getIndexByItemElement(e){return this._editStrategy.getNormalizedIndex(e)}_getItemByIndex(e){return this._getItems()[e]}_getFocusedItem(){return this.getItemByItemElement(this.option("focusedElement"))}_focusItem(e,t){this.option("focusedElement",this.getItemElementByItem(e)),t&&this._layoutUtils.scrollToItem(this._getIndexByItem(e))}_focusItemByIndex(e,t,i){if(e>=0&&e<this._getItemsLength()){var o=this._getItemByIndex(e);this._focusItem(o,t,i)}}_syncFocusedItemKey(){this._syncFocusedItemKeyDeferred||(this._syncFocusedItemKeyDeferred=new c.BH);var e=this._syncFocusedItemKeyDeferred;if(this._dataSource&&this._dataSource.isLoading())return e.promise();var t=this.option("focusedItemKey");if((0,d.$K)(t)){var i=this.option("items"),o=(0,A.sE)(i,e=>this.keyOf(e)===t);o?(this._focusItem(o,!0),e.resolve()):(this.option("focusedItemKey",void 0),e.reject())}else e.resolve();return this._syncFocusedItemKeyDeferred=null,e.promise()}_onFocusedItemChanged(){var e=this._getFocusedItem(),t=this.keyOf(e);t!==this.option("focusedItemKey")&&(this._lockFocusedItemProcessing=!0,this.option("focusedItemKey",t),this._lockFocusedItemProcessing=!1,this._raiseFocusedItemChanged(e))}_raiseFocusedItemChanged(e){var t={item:e,itemElement:this.option("focusedElement")};this._actions.onFocusedItemChanged(t)}_changeItemSelection(e,t){if(this.isItemSelected(e)!==t){var i=this.getItemElementByItem(e),o=this._getIndexByItemElement(i);this._selection.changeItemSelection(o,{control:this._isPreserveSelectionMode})}}_chooseSelectOption(){return"selectedItemKeys"}getSelectedItems(){return this._selection.getSelectedItems()}getItemElementByItem(e){return this._editStrategy.getItemElement(e)}getItemByItemElement(e){return this._getItemByIndex(this._getIndexByItemElement(e))}selectAll(){"multiple"===this.option("selectionMode")&&(this._selection.selectAll(),this._isPreserveSelectionMode=!0)}selectItem(e){this._changeItemSelection(e,!0)}deselectItem(e){this._changeItemSelection(e,!1)}clearSelection(){this._selection.deselectAll()}_optionChanged(e){switch(e.name){case"items":this._layoutUtils&&this._layoutUtils.updateItems(this.itemElements().first()),super._optionChanged(e);break;case"focusedItemKey":if(this._lockFocusedItemProcessing)break;(0,d.$K)(e.value)?this._syncFocusedItemKey().done(()=>{var e=this._getFocusedItem();this._raiseFocusedItemChanged(e)}):(this.option("focusedElement",null),this._raiseFocusedItemChanged(null));break;case"onItemEnterKeyPressed":case"onFocusedItemChanged":this._actions[e.name]=this._createActionByOption(e.name);break;default:super._optionChanged(e)}}},Te=class extends _e{_initMarkup(){super._initMarkup(),this.$element().addClass("dx-filemanager-thumbnails");var e=(0,ue.V4)(be.u,"dxFileManager_thumbnails");H.Z.on(this.$element(),e,this._onContextMenu.bind(this)),this._createItemList()}_createItemList(){var e=this._isMultipleSelectionMode()?"multiple":"single",t=(0,l.Z)("<div>").appendTo(this.$element());this._itemList=this._createComponent(t,Me,{dataSource:this._createDataSource(),selectionMode:e,selectedItemKeys:this.option("selectedItemKeys"),focusedItemKey:this.option("focusedItemKey"),activeStateEnabled:!0,hoverStateEnabled:!0,loopItemFocus:!1,focusStateEnabled:!0,onItemEnterKeyPressed:this._tryOpen.bind(this),itemThumbnailTemplate:this._getItemThumbnailContainer.bind(this),getTooltipText:this._getTooltipText.bind(this),onSelectionChanged:this._onItemListSelectionChanged.bind(this),onFocusedItemChanged:this._onItemListFocusedItemChanged.bind(this),onContentReady:()=>{var e;return null===(e=this._refreshDeferred)||void 0===e?void 0:e.resolve()}})}_onContextMenu(e){if(e.preventDefault(),e.stopPropagation(),this._isDesktop()){var t=null,i=(0,l.Z)(e.target).closest(this._getItemSelector()),o=null;i.length>0&&(o=this._itemList.getItemByItemElement(i),this._itemList.selectItem(o),t=this._getFileItemsForContextMenu(o)),this._showContextMenu(t,e.target,e,{itemData:o,itemElement:i.length?i:void 0})}}_getItemThumbnailCssClass(){return"dx-filemanager-thumbnails-item-thumbnail"}_getItemSelector(){return".".concat("dx-filemanager-thumbnails-item")}_getTooltipText(e){var t=e.fileItem;if(t.tooltipText)return t.tooltipText;var i="".concat(t.name,"\r\n");return t.isDirectory||(i+="".concat(u.Z.format("dxFileManager-listThumbnailsTooltipTextSize"),": ").concat(C(t.size),"\r\n")),i+"".concat(u.Z.format("dxFileManager-listThumbnailsTooltipTextDateModified"),": ").concat(t.dateModified)}_onItemDblClick(e){var t=(0,l.Z)(e.currentTarget),i=this._itemList.getItemByItemElement(t);this._tryOpen(i)}_tryOpen(e){e&&this._raiseSelectedItemOpened(e)}_getItemsInternal(){return super._getItemsInternal().then(e=>{var t=new c.BH;return setTimeout(()=>t.resolve(e)),t.promise()})}_disableDragging(){return!1}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{focusStateEnabled:!0})}_onItemListSelectionChanged(e){var{addedItemKeys:t,removedItemKeys:i}=e,o=this.getSelectedItems(),s=o.map(e=>e.fileItem),n=s.map(e=>e.key);this._tryRaiseSelectionChanged({selectedItemInfos:o,selectedItems:s,selectedItemKeys:n,currentSelectedItemKeys:t,currentDeselectedItemKeys:i})}_onItemListFocusedItemChanged(e){var{item:t,itemElement:i}=e;this._isMultipleSelectionMode()||this._selectItemSingleSelection(t);var o=(null==t?void 0:t.fileItem)||null;this._onFocusedItemChanged({item:o,itemKey:null==o?void 0:o.key,itemElement:i||void 0})}_setSelectedItemKeys(e){this._itemList.option("selectedItemKeys",e)}_setFocusedItemKey(e){this._itemList.option("focusedItemKey",e)}refresh(e){var t={dataSource:this._createDataSource()};return e&&Object.prototype.hasOwnProperty.call(e,"focusedItemKey")&&(t.focusedItemKey=e.focusedItemKey),this._itemList.option(t),this._refreshDeferred=new c.BH,this._refreshDeferred.promise()}_deselectItem(e){var t=this._itemList.getItemElementByItem(e);this._itemList.unselectItem(t)}_selectItemSingleSelection(e){e?this._itemList.selectItem(e):this._itemList.clearSelection()}clearSelection(){this._itemList.clearSelection()}getSelectedItems(){return this._itemList.getSelectedItems()}};var Oe=i(37513),Pe=i(51626),Fe="dx-buttongroup-item-has-width",Ee=xe.Z.inherit({_initTemplates(){this.callBase(),this._templateManager.addDefaultTemplates({item:new ve.c((e,t,i)=>{this._prepareItemStyles(e);var o=this.option("buttonTemplate");this._createComponent(e,ae.Z,(0,h.l)({},i,t,this._getBasicButtonOptions(),{_templateData:this._hasCustomTemplate(o)?i:{},template:i.template||o}))},["text","type","icon","disabled","visible","hint"],this.option("integrationOptions.watchMethod"))})},_getBasicButtonOptions(){return{focusStateEnabled:!1,onClick:null,hoverStateEnabled:this.option("hoverStateEnabled"),activeStateEnabled:this.option("activeStateEnabled"),stylingMode:this.option("stylingMode")}},_getDefaultOptions:function(){return(0,h.l)(this.callBase(),{itemTemplateProperty:null})},_hasCustomTemplate(e){return(0,d.mf)(e)||this.option("integrationOptions.templates")[e]},_prepareItemStyles(e){var t=e.data("dxItemIndex");0===t&&e.addClass("dx-buttongroup-first-item");var i=this.option("items");i&&t===i.length-1&&e.addClass("dx-buttongroup-last-item"),e.addClass("dx-shape-standard")},_renderItemContent(e){return e.container=(0,l.Z)(e.container).parent(),this.callBase(e)},_renderItemContentByNode:function(e,t){return e.container=(0,l.Z)(e.container.children().first()),this.callBase(e,t)},_focusTarget(){return this.$element().parent()},_keyboardEventBindingTarget(){return this._focusTarget()},_refreshContent(){this._prepareContent(),this._renderContent()},_itemClass:()=>"dx-buttongroup-item",_itemSelectHandler:function(e){"single"===this.option("selectionMode")&&this.isItemSelected(e.currentTarget)||this.callBase(e)}}),Ae=g.Z.inherit({_getDefaultOptions(){return(0,h.l)(this.callBase(),{hoverStateEnabled:!0,focusStateEnabled:!0,selectionMode:"single",selectedItems:[],selectedItemKeys:[],stylingMode:"contained",keyExpr:"text",items:[],buttonTemplate:"content",onSelectionChanged:null,onItemClick:null})},_init(){this.callBase(),this._createItemClickAction()},_createItemClickAction(){this._itemClickAction=this._createActionByOption("onItemClick")},_initMarkup(){this.setAria("role","group"),this.$element().addClass("dx-buttongroup"),this._renderButtons(),this._syncSelectionOptions(),this.callBase()},_fireSelectionChangeEvent:function(e,t){this._createActionByOption("onSelectionChanged",{excludeValidators:["disabled","readOnly"]})({addedItems:e,removedItems:t})},_renderButtons(){var e=(0,l.Z)("<div>").addClass("dx-buttongroup-wrapper").appendTo(this.$element()),t=this.option("selectedItems"),i={selectionMode:this.option("selectionMode"),items:this.option("items"),keyExpr:this.option("keyExpr"),buttonTemplate:this.option("buttonTemplate"),scrollingEnabled:!1,selectedItemKeys:this.option("selectedItemKeys"),focusStateEnabled:this.option("focusStateEnabled"),hoverStateEnabled:this.option("hoverStateEnabled"),activeStateEnabled:this.option("activeStateEnabled"),stylingMode:this.option("stylingMode"),accessKey:this.option("accessKey"),tabIndex:this.option("tabIndex"),noDataText:"",selectionRequired:!1,onItemRendered:e=>{var t=this.option("width");(0,d.$K)(t)&&(0,l.Z)(e.itemElement).addClass(Fe)},onSelectionChanged:e=>{this._syncSelectionOptions(),this._fireSelectionChangeEvent(e.addedItems,e.removedItems)},onItemClick:e=>{this._itemClickAction(e)}};(0,d.$K)(t)&&t.length&&(i.selectedItems=t),this._buttonsCollection=this._createComponent(e,Ee,i)},_syncSelectionOptions(){this._setOptionWithoutOptionChange("selectedItems",this._buttonsCollection.option("selectedItems")),this._setOptionWithoutOptionChange("selectedItemKeys",this._buttonsCollection.option("selectedItemKeys"))},_optionChanged(e){switch(e.name){case"stylingMode":case"selectionMode":case"keyExpr":case"buttonTemplate":case"items":case"activeStateEnabled":case"focusStateEnabled":case"hoverStateEnabled":case"tabIndex":this._invalidate();break;case"selectedItemKeys":case"selectedItems":this._buttonsCollection.option(e.name,e.value);break;case"onItemClick":this._createItemClickAction();break;case"onSelectionChanged":break;case"width":this.callBase(e),this._buttonsCollection.itemElements().toggleClass(Fe,!!e.value);break;default:this.callBase(e)}}});(0,m.Z)("dxButtonGroup",Ae);const ke=Ae;var Ze=i(76161),Be=i(63435),Ue=i(47991),Ve=i(6296),Ke=i(37594),Le=i(65263),Re=i(57971),ze="dx-dropdownbutton",$e="dx-dropdownbutton-action",Ne="dx-dropdownbutton-toggle",He=g.Z.inherit({_getDefaultOptions(){return(0,h.l)(this.callBase(),{itemTemplate:"item",keyExpr:"this",displayExpr:"this",selectedItem:null,selectedItemKey:null,stylingMode:"outlined",deferRendering:!0,noDataText:u.Z.format("dxCollectionWidget-noDataText"),useSelectMode:!1,splitButton:!1,showArrowIcon:!0,text:"",icon:void 0,onButtonClick:null,onSelectionChanged:null,onItemClick:null,opened:!1,items:null,dataSource:null,focusStateEnabled:!0,hoverStateEnabled:!0,dropDownOptions:{},dropDownContentTemplate:"content",wrapItemText:!1,useItemTextAsTitle:!0,grouped:!1,groupTemplate:"group",buttonGroupOptions:{}})},_setOptionsByReference(){this.callBase(),(0,h.l)(this._optionsByReference,{selectedItem:!0})},_init(){this.callBase(),this._createItemClickAction(),this._createActionClickAction(),this._createSelectionChangedAction(),this._initDataSource(),this._compileKeyGetter(),this._compileDisplayGetter(),this._itemsToDataSource(this.option("items")),this._options.cache("buttonGroupOptions",this.option("buttonGroupOptions")),this._options.cache("dropDownOptions",this.option("dropDownOptions"))},_initTemplates(){this._templateManager.addDefaultTemplates({content:new Pe.k(e=>{var t=(0,l.Z)(e.container),i=(0,l.Z)("<div>").appendTo(t);this._list=this._createComponent(i,Be.Z,this._listOptions()),this._list.registerKeyHandler("escape",this._escHandler.bind(this)),this._list.registerKeyHandler("tab",this._escHandler.bind(this)),this._list.registerKeyHandler("leftArrow",this._escHandler.bind(this)),this._list.registerKeyHandler("rightArrow",this._escHandler.bind(this))})}),this.callBase()},_itemsToDataSource:function(e){this._dataSource||(this._dataSource=new Ke.o({store:new Le.Z({key:this._getKey(),data:e}),pageSize:0}))},_getKey:function(){var e,t=this.option("keyExpr"),i=null===(e=this._dataSource)||void 0===e?void 0:e.key();return!(0,d.$K)(i)||(0,d.$K)(t)&&"this"!==t?t:i},_compileKeyGetter(){this._keyGetter=(0,v.vb)(this._getKey())},_compileDisplayGetter(){this._displayGetter=(0,v.vb)(this.option("displayExpr"))},_initMarkup(){this.callBase(),this.$element().addClass(ze),this._renderButtonGroup(),this._updateArrowClass(),(0,d.$K)(this.option("selectedItemKey"))&&this._loadSelectedItem().done(this._updateActionButton.bind(this))},_renderFocusTarget:p.ZT,_render(){this.option("deferRendering")&&!this.option("opened")||this._renderPopup(),this.callBase()},_renderContentImpl(){return this._popup&&this._renderPopupContent(),this.callBase()},_loadSelectedItem(){var e;null===(e=this._loadSingleDeferred)||void 0===e||e.reject();var t=new c.BH;if(this._list&&void 0!==this._lastSelectedItemData){var i=this.option("useSelectMode")?this._list.option("selectedItem"):this._lastSelectedItemData;return t.resolve(i)}this._lastSelectedItemData=void 0;var o=this.option("selectedItemKey");return this._loadSingle(this._getKey(),o).done(t.resolve).fail(()=>{t.resolve(null)}),this._loadSingleDeferred=t,t.promise()},_createActionClickAction(){this._actionClickAction=this._createActionByOption("onButtonClick")},_createSelectionChangedAction(){this._selectionChangedAction=this._createActionByOption("onSelectionChanged")},_createItemClickAction(){this._itemClickAction=this._createActionByOption("onItemClick")},_fireSelectionChangedAction(e){var{previousValue:t,value:i}=e;this._selectionChangedAction({item:i,previousItem:t})},_fireItemClickAction(e){var{event:t,itemElement:i,itemData:o}=e;return this._itemClickAction({event:t,itemElement:i,itemData:this._actionItem||o})},_actionButtonConfig(){return{text:this.option("text"),icon:this.option("icon"),elementAttr:{class:$e}}},_getButtonGroupItems(){var e=[];return e.push(this._actionButtonConfig()),this.option("splitButton")&&e.push({icon:"spindown",elementAttr:{class:Ne}}),e},_buttonGroupItemClick(e){var{event:t,itemData:i}=e,o=i.elementAttr.class===$e;i.elementAttr.class===Ne?this.toggle():o&&(this._actionClickAction({event:t,selectedItem:this.option("selectedItem")}),this.option("splitButton")||this.toggle())},_buttonGroupOptions(){return(0,h.l)({items:this._getButtonGroupItems(),focusStateEnabled:this.option("focusStateEnabled"),hoverStateEnabled:this.option("hoverStateEnabled"),onItemClick:this._buttonGroupItemClick.bind(this),width:"100%",height:"100%",stylingMode:this.option("stylingMode"),selectionMode:"none",tabIndex:this.option("tabIndex"),onKeyboardHandled:e=>this._keyboardHandler(e),buttonTemplate:(e,t)=>{var{text:i,icon:o}=e;if(this.option("splitButton")||!this.option("showArrowIcon"))return"content";var s=(0,ne.H)(o),n=i?(0,l.Z)("<span>").text(i).addClass("dx-button-text"):void 0,r=(0,ne.H)("spindown").addClass("dx-icon-right");(0,l.Z)(t).append(s,n,r)}},this._options.cache("buttonGroupOptions"))},_renderPopupContent(){var e=this._popup.$content(),t=this._getTemplateByOption("dropDownContentTemplate");return e.empty(),this._popupContentId="dx-"+new k.Z,this.setAria("id",this._popupContentId,e),t.render({container:(0,Ue.u)(e),model:this.option("items")||this._dataSource})},_popupOptions(){var e=this.option("rtlEnabled")?"right":"left";return(0,h.l)({dragEnabled:!1,focusStateEnabled:!1,deferRendering:this.option("deferRendering"),closeOnOutsideClick:e=>{var t=this.$element();return!(0,l.Z)(e.target).closest(".".concat(ze)).is(t)},showTitle:!1,animation:{show:{type:"fade",duration:0,from:0,to:1},hide:{type:"fade",duration:400,from:1,to:0}},width:()=>(0,Re.m)(this.$element()),height:"auto",shading:!1,position:{of:this.$element(),collision:"flipfit",my:e+" top",at:e+" bottom"}},this._options.cache("dropDownOptions"),{visible:this.option("opened")})},_listOptions(){var e=this.option("selectedItemKey"),t=this.option("useSelectMode");return{selectionMode:t?"single":"none",wrapItemText:this.option("wrapItemText"),focusStateEnabled:this.option("focusStateEnabled"),hoverStateEnabled:this.option("hoverStateEnabled"),useItemTextAsTitle:this.option("useItemTextAsTitle"),onContentReady:()=>this._fireContentReadyAction(),selectedItemKeys:(0,d.$K)(e)&&t?[e]:[],grouped:this.option("grouped"),groupTemplate:this.option("groupTemplate"),keyExpr:this._getKey(),noDataText:this.option("noDataText"),displayExpr:this.option("displayExpr"),itemTemplate:this.option("itemTemplate"),items:this.option("items"),dataSource:this._dataSource,onItemClick:e=>{this.option("useSelectMode")||(this._lastSelectedItemData=e.itemData),this.option("selectedItemKey",this._keyGetter(e.itemData)),!1!==this._fireItemClickAction(e)&&(this.toggle(!1),this._buttonGroup.focus())}}},_upDownKeyHandler(){return this._popup&&this._popup.option("visible")&&this._list?this._list.focus():this.open(),!0},_escHandler(){return this.close(),this._buttonGroup.focus(),!0},_tabHandler(){return this.close(),!0},_renderPopup(){var e=(0,l.Z)("<div>");this.$element().append(e),this._popup=this._createComponent(e,Ze.Z,this._popupOptions()),this._popup.$content().addClass("dx-dropdownbutton-content"),this._popup.$wrapper().addClass("dx-dropdownbutton-popup-wrapper"),this._popup.on("hiding",this._popupHidingHandler.bind(this)),this._popup.on("showing",this._popupShowingHandler.bind(this)),this._bindInnerWidgetOptions(this._popup,"dropDownOptions")},_popupHidingHandler(){this.option("opened",!1),this.setAria({expanded:!1,owns:void 0})},_popupOptionChanged:function(e){var t=g.Z.getOptionsFromContainer(e);this._setPopupOption(t);var i=Object.keys(t);-1===i.indexOf("width")&&-1===i.indexOf("height")||this._dimensionChanged()},_dimensionChanged:function(){void 0===(0,Re.T)(this.option("dropDownOptions.width"))&&this._setPopupOption("width",()=>(0,Re.m)(this.$element()))},_setPopupOption:function(e,t){this._setWidgetOption("_popup",arguments)},_popupShowingHandler(){this.option("opened",!0),this.setAria({expanded:!0,owns:this._popupContentId})},_renderButtonGroup(){var e=this._buttonGroup&&this._buttonGroup.$element()||(0,l.Z)("<div>");this._buttonGroup||this.$element().append(e),this._buttonGroup=this._createComponent(e,ke,this._buttonGroupOptions()),this._buttonGroup.registerKeyHandler("downArrow",this._upDownKeyHandler.bind(this)),this._buttonGroup.registerKeyHandler("tab",this._tabHandler.bind(this)),this._buttonGroup.registerKeyHandler("upArrow",this._upDownKeyHandler.bind(this)),this._buttonGroup.registerKeyHandler("escape",this._escHandler.bind(this)),this._bindInnerWidgetOptions(this._buttonGroup,"buttonGroupOptions")},_updateArrowClass(){var e=this.option("splitButton")||this.option("showArrowIcon");this.$element().toggleClass("dx-dropdownbutton-has-arrow",e)},toggle(e){return this._popup||(this._renderPopup(),this._renderContent()),this._popup.toggle(e)},open(){return this.toggle(!0)},close(){return this.toggle(!1)},_setListOption(e,t){this._list&&this._list.option(e,t)},_getDisplayValue(e){var t=(0,d.PO)(e)?this._displayGetter(e):e;return(0,d.PO)(t)?"":String((0,p.IS)(t,""))},_updateActionButton(e){this.option("useSelectMode")&&this.option({text:this._getDisplayValue(e),icon:(0,d.PO)(e)?e.icon:void 0}),this._setOptionWithoutOptionChange("selectedItem",e),this._setOptionWithoutOptionChange("selectedItemKey",this._keyGetter(e))},_clean(){this._list&&this._list.$element().remove(),this._popup&&this._popup.$element().remove()},_selectedItemKeyChanged(e){this._setListOption("selectedItemKeys",this.option("useSelectMode")&&(0,d.$K)(e)?[e]:[]);var t=this.option("selectedItem");this._loadSelectedItem().done(e=>{this._updateActionButton(e),this._displayGetter(t)!==this._displayGetter(e)&&this._fireSelectionChangedAction({previousValue:t,value:e})})},_actionButtonOptionChanged(e){var{name:t,value:i}=e,o={};o[t]=i,this._buttonGroup.option("items[0]",(0,h.l)({},this._actionButtonConfig(),o)),this._popup&&this._popup.repaint()},_selectModeChanged(e){if(e){this._setListOption("selectionMode","single");var t=this.option("selectedItemKey");this._setListOption("selectedItemKeys",(0,d.$K)(t)?[t]:[])}else this._setListOption("selectionMode","none"),this.option({selectedItemKey:void 0,selectedItem:void 0})},_updateItemCollection(e){var t=this.option("selectedItemKey");this._setListOption("selectedItem",null),this._setWidgetOption("_list",[e]),(0,d.$K)(t)&&this._loadSelectedItem().done(e=>{this._setListOption("selectedItemKeys",[t]),this._setListOption("selectedItem",e)}).fail(e=>{this._setListOption("selectedItemKeys",[])}).always(this._updateActionButton.bind(this))},_updateDataSource:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._dataSource.items();this._dataSource=void 0,this._itemsToDataSource(e),this._updateKeyExpr()},_updateKeyExpr:function(){this._compileKeyGetter(),this._setListOption("keyExpr",this._getKey())},focus:function(){this._buttonGroup.focus()},_optionChanged(e){var t,{name:i,value:o}=e;switch(i){case"useSelectMode":this._selectModeChanged(o);break;case"splitButton":this._updateArrowClass(),this._renderButtonGroup();break;case"displayExpr":this._compileDisplayGetter(),this._setListOption(i,o),this._updateActionButton(this.option("selectedItem"));break;case"keyExpr":this._updateDataSource();break;case"buttonGroupOptions":this._innerWidgetOptionChanged(this._buttonGroup,e);break;case"dropDownOptions":if("dropDownOptions.visible"===e.fullName)break;void 0!==e.value.visible&&delete e.value.visible,this._popupOptionChanged(e),this._innerWidgetOptionChanged(this._popup,e);break;case"opened":this.toggle(o);break;case"focusStateEnabled":case"hoverStateEnabled":this._setListOption(i,o),this._buttonGroup.option(i,o),this.callBase(e);break;case"items":this._updateDataSource(this.option("items")),this._updateItemCollection(i);break;case"dataSource":Array.isArray(o)?this._updateDataSource(this.option("dataSource")):(this._initDataSource(),this._updateKeyExpr()),this._updateItemCollection(i);break;case"icon":case"text":this._actionButtonOptionChanged(e);break;case"showArrowIcon":this._updateArrowClass(),this._buttonGroup.repaint(),this._popup&&this._popup.repaint();break;case"width":case"height":this.callBase(e),null===(t=this._popup)||void 0===t||t.repaint();break;case"stylingMode":this._buttonGroup.option(i,o);break;case"itemTemplate":case"grouped":case"noDataText":case"groupTemplate":case"wrapItemText":case"useItemTextAsTitle":this._setListOption(i,o);break;case"dropDownContentTemplate":this._renderContent();break;case"selectedItemKey":this._selectedItemKeyChanged(o);break;case"selectedItem":break;case"onItemClick":this._createItemClickAction();break;case"onButtonClick":this._createActionClickAction();break;case"onSelectionChanged":this._createSelectionChangedAction();break;case"deferRendering":this.toggle(this.option("opened"));break;case"tabIndex":this._buttonGroup.option(i,o);break;default:this.callBase(e)}}}).include(Ve.Z);(0,m.Z)("dxDropDownButton",He);var qe={showNavPane:{location:"before"},create:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},upload:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},refresh:{location:"after",showText:"inMenu",cssClass:"dx-filemanager-toolbar-has-large-icon",compactMode:{showText:"inMenu",locateInMenu:"auto"}},switchView:{location:"after"},download:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},move:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},copy:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},rename:{location:"before",compactMode:{showText:"inMenu",locateInMenu:"auto"}},delete:{location:"before",compactMode:{showText:"inMenu"}},clearSelection:{location:"after",locateInMenu:"never",compactMode:{showText:"inMenu"}},separator:{location:"before"}},Ge=["visible","location","locateInMenu","disabled","showText"],je=["accessKey","elementAttr","height","hint","icon","stylingMode","tabIndex","text","width"],Qe=["separator","switchView"],Je={default:"dx-filemanager-i dx-filemanager-i-refresh",progress:"dx-filemanager-i dx-filemanager-i-progress",success:"dx-filemanager-i dx-filemanager-i-done",error:"dx-filemanager-i dx-filemanager-i-danger"};const We=class extends g.Z{_initMarkup(){this._commandManager=this.option("commandManager"),this._createItemClickedAction(),this._generalToolbarVisible=!0,this._$viewSwitcherPopup=(0,l.Z)("<div>").addClass("dx-filemanager-view-switcher-popup"),this._generalToolbar=this._createToolbar(this.option("generalItems")),this._fileToolbar=this._createToolbar(this.option("fileItems"),!0),this._$viewSwitcherPopup.appendTo(this.$element()),this.$element().addClass("dx-filemanager-toolbar dx-filemanager-general-toolbar")}_render(){super._render();var e=this._getVisibleToolbar();this._checkCompactMode(e)}_dimensionChanged(e){if(!e||"height"!==e){var t=this._getVisibleToolbar();this._checkCompactMode(t)}}_getVisibleToolbar(){return this._generalToolbarVisible?this._generalToolbar:this._fileToolbar}_createToolbar(e,t){var i=this._getPreparedItems(e),o=(0,l.Z)("<div>").appendTo(this.$element()),s=this._createComponent(o,Oe.Z,{items:i,visible:!t,onItemClick:e=>this._raiseItemClicked(e)});return s.compactMode=!1,s}_getPreparedItems(e){return e=e.map(e=>{var t=e;(0,d.HD)(e)&&(t={name:e});var i=t.name,o=this._configureItemByCommandName(i,t);return o.originalItemData=e,"separator"!==i&&this._setItemVisibleAvailable(o),o}),this._updateSeparatorsVisibility(e),e}_updateSeparatorsVisibility(e,t){var i=!1,o=this._getMenuItems(t),s={before:!1,center:!1,after:!1},n={before:this._getItemsInGroup(e,o,"before"),center:this._getItemsInGroup(e,o,"center"),after:this._getItemsInGroup(e,o,"after")};return e.forEach((e,t)=>{var r=e.location;if("separator"===e.name){var a=s[r]&&this._groupHasItemsAfter(n[r]);e.visible!==a&&(i=!0,e.visible=a),s[r]=!1}else this._isItemInMenu(o,e)||(s[r]=s[r]||e.visible),n[r].shift()}),t&&i&&t.repaint(),i}_getMenuItems(e){return(e?e._getMenuItems():[]).map(e=>e.originalItemData)}_isItemInMenu(e,t){return!!e.length&&"never"!==(0,p.IS)(t.locateInMenu,"never")&&-1!==e.indexOf(t.originalItemData)}_getItemsInGroup(e,t,i){return e.filter(e=>e.location===i&&!this._isItemInMenu(t,e))}_groupHasItemsAfter(e){for(var t=0;t<e.length;t++)if("separator"!==e[t].name&&e[t].visible)return!0;return!1}_configureItemByCommandName(e,t){var i,o={},s=this._commandManager.getCommandByName(e);switch(s&&(o=this._createCommandItem(s)),e){case"separator":o=this._createSeparatorItem();break;case"switchView":o=this._createViewModeItem()}if(this._isDefaultItem(e)){(0,h.l)(!0,o,qe[e]);var n=o.cssClass||"";b(o,t,Ge),(0,d.$K)(t.options)&&b(o.options,t.options,je),b(o.options,t,["text","icon"]),t.cssClass&&(n="".concat(n," ").concat(t.cssClass)),n&&(o.cssClass=n),(0,d.$K)(t.visible)||(o._autoHide=!0),"dxButton"===o.widget&&("inMenu"!==o.showText||(0,d.$K)(o.options.hint)||(o.options.hint=o.options.text),o.compactMode&&!(0,d.$K)(o.options.hint)&&this._configureHintForCompactMode(o))}else(0,h.l)(!0,o,t),o.widget||(o.widget="dxButton"),"dxButton"===o.widget&&!o.compactMode&&!o.showText&&o.options&&o.options.icon&&o.options.text&&(o.compactMode={showText:"inMenu"});return e&&!o.name&&(0,h.l)(o,{name:e}),o.location=(0,p.IS)(o.location,"before"),(0,d.$K)(null===(i=o.options)||void 0===i?void 0:i.stylingMode)||("dxButton"===o.widget&&(0,h.l)(!0,o,{options:{stylingMode:"text"}}),"dxSelectBox"===o.widget&&(0,h.l)(!0,o,{options:{stylingMode:"filled"}})),o}_isDefaultItem(e){return!!qe[e]}_createCommandItem(e){return{widget:"dxButton",options:{text:e.text,hint:e.hint,commandText:e.text,icon:e.icon,stylingMode:"text",onClick:t=>this._executeCommand(e)}}}_createSeparatorItem(){return{template:(e,t,i)=>{(0,l.Z)(i).addClass("dx-filemanager-toolbar-separator-item")}}}_createViewModeItem(){var e=["details","thumbnails"].map(e=>{var{text:t,icon:i}=this._commandManager.getCommandByName(e);return{name:e,text:t,icon:i}}),t="thumbnails"===this.option("itemViewMode")?1:0;return{cssClass:"dx-filemanager-toolbar-viewmode-item",widget:"dxDropDownButton",options:{items:e,keyExpr:"name",selectedItemKey:this.option("itemViewMode"),displayExpr:" ",hint:e[t].text,stylingMode:"text",showArrowIcon:!1,useSelectMode:!0,dropDownOptions:{container:this._$viewSwitcherPopup},onItemClick:e=>this._executeCommand(e.itemData.name)}}}_configureHintForCompactMode(e){e.options.hint="",e.compactMode.options=e.compactMode.options||{},e.compactMode.options.hint=e.options.text}_checkCompactMode(e){e.compactMode&&this._toggleCompactMode(e,!1);var t=this._toolbarHasItemsOverflow(e);e.compactMode!==t?(e.compactMode||this._toggleCompactMode(e,t),e.compactMode=t):e.compactMode&&this._toggleCompactMode(e,!0)}_toolbarHasItemsOverflow(e){return e.$element().width()<e._getItemsWidth()}_toggleCompactMode(e,t){var i=!1,o=e.option("items");o.forEach(e=>{if(e.compactMode){var o=null;t?(e.saved=this._getCompactModeOptions(e,e._available),o=e.compactMode):o=e.saved;var s=this._getCompactModeOptions(o,e._available);(0,h.l)(!0,e,s),i=!0}}),(i=this._updateSeparatorsVisibility(o)||i)&&e.repaint(),this._updateSeparatorsVisibility(o,e)}_getCompactModeOptions(e,t){var{showText:i,locateInMenu:o,options:s}=e;return{visible:t,showText:(0,p.IS)(i,"always"),locateInMenu:(0,p.IS)(o,"never"),options:{hint:null==s?void 0:s.hint}}}_ensureAvailableCommandsVisible(e,t){var i=!1,o=e.option("items");o.forEach(e=>{if("separator"!==e.name){var o=e._available;this._setItemVisibleAvailable(e,t),e._available!==o&&(i=!0)}}),(i=this._updateSeparatorsVisibility(o)||i)&&e.repaint(),this._updateSeparatorsVisibility(o,e)}_setItemVisibleAvailable(e,t){var i,o=null===(i=e.originalItemData)||void 0===i?void 0:i.visible;e._available=this._isToolbarItemAvailable(e,t),e.visible=(0,d.$K)(o)?o:e._available}_fileToolbarHasEffectiveItems(e){return this._fileToolbar.option("items").some(t=>this._isFileToolbarItemAvailable(t,e))}_executeCommand(e){this._commandManager.executeCommand(e)}_isToolbarItemAvailable(e,t){return this._isDefaultItem(e.name)&&e._autoHide?"refresh"===e.name?this._generalToolbarVisible||!!this._isRefreshVisibleInFileToolbar:Qe.indexOf(e.name)>-1||this._commandManager.isCommandAvailable(e.name,t):(0,p.IS)(e.visible,!0)}_isFileToolbarItemAvailable(e,t){var{name:i,visible:o}=e;return!this._isDefaultItem(i)&&(0,p.IS)(o,!0)||"clearSelection"!==i&&"refresh"!==i&&this._commandManager.isCommandAvailable(i,t)}_updateItemInToolbar(e,t,i){e.beginUpdate();for(var o=e.option("items"),s=0;s<o.length;s++)if(o[s].name===t){e.option("items[".concat(s,"]"),i);break}e.endUpdate()}_raiseItemClicked(e){var t=(0,h.l)(!0,{},e);t.itemData=e.itemData.originalItemData,this._itemClickedAction(t)}_createItemClickedAction(){this._itemClickedAction=this._createActionByOption("onItemClick")}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{commandManager:null,generalItems:[],fileItems:[],itemViewMode:"details",onItemClick:null})}_optionChanged(e){var t=e.name;switch(t){case"commandManager":case"itemViewMode":case"generalItems":case"fileItems":this.repaint();break;case"onItemClick":this._itemClickedAction=this._createActionByOption(t);break;default:super._optionChanged(e)}}updateRefreshItem(e,t){var i=null,o=u.Z.format("dxFileManager-commandRefresh"),s="inMenu";this._isRefreshVisibleInFileToolbar=!1,"default"===t?i={options:{icon:Je.default}}:(i={options:{icon:Je[t]}},this._isRefreshVisibleInFileToolbar=!0,o=e,s="always");var n=(0,h.l)({},i,{visible:this._isRefreshVisibleInFileToolbar});this._applyRefreshItemOptions(i,n),this._refreshItemTextTimeout=this._updateRefreshItemText("progress"===t,o,s)}_updateRefreshItemText(e,t,i){var o={showText:i,options:{text:t}};return e?setTimeout(()=>{this._applyRefreshItemOptions(o),this._refreshItemTextTimeout=void 0},500):(this._refreshItemTextTimeout&&clearTimeout(this._refreshItemTextTimeout),void this._applyRefreshItemOptions(o))}_applyRefreshItemOptions(e,t){t||(t=(0,h.l)({},e)),this._updateItemInToolbar(this._generalToolbar,"refresh",e),this._updateItemInToolbar(this._fileToolbar,"refresh",t)}update(e){var t=0===(e=(0,p.IS)(e,[])).length||!this._fileToolbarHasEffectiveItems(e);this._generalToolbarVisible!==t&&(this._generalToolbar.option("visible",t),this._fileToolbar.option("visible",!t),this._generalToolbarVisible=t,this.$element().toggleClass("dx-filemanager-general-toolbar",t),this.$element().toggleClass("dx-filemanager-file-toolbar",!t));var i=this._getVisibleToolbar();this._ensureAvailableCommandsVisible(i,e),this._checkCompactMode(i)}};var Ye=i(89615),Xe=i(71790),et="dx-filemanager-progress-panel",tt="".concat(et,"-container"),it="".concat(et,"-title"),ot="".concat(et,"-title-text"),st="".concat(et,"-close-button"),nt="".concat(et,"-infos-container"),rt="".concat(et,"-separator"),at="".concat(et,"-info"),lt="".concat(et,"-common"),ht="".concat(et,"-info-with-details"),dt="".concat(et,"-details"),ct="dx-filemanager-progress-box",pt="".concat(ct,"-error"),ut="".concat(ct,"-without-close-button"),mt="".concat(ct,"-image"),gt="".concat(ct,"-wrapper"),_t="".concat(ct,"-common"),ft="".concat(ct,"-progress-bar"),Ct="".concat(ct,"-close-button");const bt=class extends g.Z{_initMarkup(){super._initMarkup(),this._initActions(),this._operationCount=0,this.$element().addClass(et);var e=(0,l.Z)("<div>").appendTo(this.$element()),t=(0,l.Z)("<div>").addClass(tt).appendTo(e);this._scrollView=this._createComponent(e,ye.Z,{scrollByContent:!0,scrollByThumb:!0,showScrollbar:"onScroll"});var i=(0,l.Z)("<div>").addClass(it).appendTo(t);(0,l.Z)("<div>").text(u.Z.format("dxFileManager-notificationProgressPanelTitle")).addClass(ot).appendTo(i);var o=(0,l.Z)("<div>").addClass(st).appendTo(i);this._createComponent(o,ae.Z,{icon:"close",stylingMode:"text",onClick:()=>this._raisePanelClosed()}),this._$infosContainer=(0,l.Z)("<div>").addClass(nt).appendTo(t),this._renderEmptyListText()}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{onOperationClosed:null,onOperationCanceled:null,onOperationItemCanceled:null,onPanelClosed:null})}_initActions(){this._actions={onOperationClosed:this._createActionByOption("onOperationClosed"),onOperationCanceled:this._createActionByOption("onOperationCanceled"),onOperationItemCanceled:this._createActionByOption("onOperationItemCanceled"),onPanelClosed:this._createActionByOption("onPanelClosed")}}_optionChanged(e){var t=e.name;switch(t){case"test":break;case"onOperationClosed":case"onOperationCanceled":case"onOperationItemCanceled":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}addOperation(e,t,i){this._operationCount?(0,l.Z)("<div>").addClass(rt).prependTo(this._$infosContainer):this._$infosContainer.empty(),this._operationCount++;var o={customCloseHandling:t,allowProgressAutoUpdate:(0,p.IS)(i,!0)},s=(0,l.Z)("<div>").addClass(at).prependTo(this._$infosContainer);o.$info=s;var n=(0,l.Z)("<div>").addClass(lt).appendTo(s);return o.common=this._createProgressBox(n,{commonText:e,showCloseButton:!0,showCloseButtonAlways:t,onCloseButtonClick:()=>this._closeOperation(o)}),o}addOperationDetails(e,t,i){e.$info.addClass(ht);var o=(0,l.Z)("<div>").addClass(dt).appendTo(e.$info);e.details=t.map((t,s)=>(t.info=e,this._createDetailsItem(o,t,s,!1,i)))}_createDetailsItem(e,t,i,o,s){var n=(0,l.Z)("<div>").appendTo(e);return-1!==i&&n.addClass("dx-card"),this._createProgressBox(n,{commonText:t.commonText,imageUrl:t.imageUrl,skipProgressBox:o,showCloseButton:s,showCloseButtonAlways:s,onCloseButtonClick:()=>this._cancelOperationItem(t,i)})}completeOperationItem(e,t,i){e.allowProgressAutoUpdate&&this.updateOperationItemProgress(e,t,100,i),this._setCloseButtonVisible(e.details[t],!1)}updateOperationItemProgress(e,t,i,o){e.common.progressBar.option("value",o),e.details&&e.details[t].progressBar.option("value",i)}completeOperation(e,t,i,o){e.completed=!0,e.common.$commonText.text(t),i?this._removeProgressBar(e.common):e.allowProgressAutoUpdate&&e.common.progressBar.option("value",100),o&&this._setProgressBarText(e.common,o),this._setCloseButtonVisible(e.common,!0)}completeSingleOperationWithError(e,t){var i,o=null===(i=e.details)||void 0===i?void 0:i[0];e.completed=!0,this._renderOperationError(o||e.common,t),this._setCloseButtonVisible(e.common,!0),o&&this._setCloseButtonVisible(o,!1)}addOperationDetailsError(e,t,i){var o=e.details[t];this._renderOperationError(o,i),this._setCloseButtonVisible(o,!1)}_renderError(e,t,i){(0,l.Z)("<div>").text(i).addClass(pt).appendTo(e)}_renderEmptyListText(){this._$infosContainer.text(u.Z.format("dxFileManager-notificationProgressPanelEmptyListText"))}_renderOperationError(e,t){this._removeProgressBar(e),this._renderError(e.$wrapper,e.$commonText,t)}_removeProgressBar(e){e.progressBar&&(e.progressBar.dispose(),e.progressBar.$element().remove(),e.progressBar=null)}_createProgressBox(e,t){e.addClass(ct),t.showCloseButtonAlways||e.addClass(ut),t.imageUrl&&(0,ne.H)(t.imageUrl).addClass(mt).appendTo(e);var i=(0,l.Z)("<div>").addClass(gt).appendTo(e),o=(0,l.Z)("<div>").addClass(_t).text(t.commonText).appendTo(i),s=null;if(!t.skipProgressBox){var n=(0,l.Z)("<div>").addClass(ft).appendTo(i);s=this._createComponent(n,Xe.Z,{min:0,max:100,width:"100%",validationMessageMode:"always",statusFormat:(e,t)=>this._getStatusString(e,t)})}var r=null;if(t.showCloseButton){var a=(0,l.Z)("<div>").addClass(Ct).appendTo(e);r=this._createComponent(a,ae.Z,{icon:"dx-filemanager-i dx-filemanager-i-cancel",stylingMode:"text",visible:t.showCloseButtonAlways,onClick:t.onCloseButtonClick})}return{$commonText:o,progressBar:s,$element:e,$wrapper:i,closeButton:r}}_setCloseButtonVisible(e,t){e.closeButton&&(e.$element.toggleClass(ut,!t),e.closeButton.option("visible",t))}_setProgressBarText(e,t){e.progressBar.option("statusFormat",()=>t)}_closeOperation(e){e.customCloseHandling&&!e.completed?(this._raiseOperationCanceled(e),this._setCloseButtonVisible(e.common,!1),e.details.forEach(e=>this._displayClosedOperationItem(e))):(this._raiseOperationClosed(e),e.$info.next(".".concat(rt)).remove(),e.$info.remove(),this._operationCount--,this._operationCount||this._renderEmptyListText())}_cancelOperationItem(e,t){this._raiseOperationItemCanceled(e,t),this._displayClosedOperationItem(e.info.details[t])}_displayClosedOperationItem(e){this._setProgressBarText(e,u.Z.format("dxFileManager-notificationProgressPanelOperationCanceled")),this._setCloseButtonVisible(e,!1)}_getStatusString(e,t){return 1===e?u.Z.format("Done"):Math.round(100*e)+"%"}_raiseOperationClosed(e){this._actions.onOperationClosed({info:e})}_raiseOperationCanceled(e){this._actions.onOperationCanceled({info:e})}_raiseOperationItemCanceled(e,t){this._actions.onOperationItemCanceled({item:e,itemIndex:t})}_raisePanelClosed(){this._actions.onPanelClosed()}};var It="dx-filemanager-progress-box",vt="".concat(It,"-error"),yt="".concat(It,"-image"),xt="".concat(It,"-wrapper"),St="".concat(It,"-common"),Dt="__operationInfoManager",wt="default",Mt="progress",Tt="error";class Ot{constructor(e){var{onActionProgressStatusChanged:t,isActual:i}=e;this._id=(new k.Z).toString(),this._isActual=i||!1,this._actionProgressStatus=wt,this._raiseActionProgress=t}getId(){return this._id}isActual(){return this._isActual}createErrorDetailsProgressBox(e,t,i){var o=this._createDetailsItem(e,t);this.renderError(o.$wrapper,i)}renderError(e,t){(0,l.Z)("<div>").text(t).addClass(vt).appendTo(e)}isActionProgressStatusDefault(){return this._actionProgressStatus===wt}_createDetailsItem(e,t){var i=(0,l.Z)("<div>").appendTo(e);return this._createProgressBox(i,{commonText:t.commonText,imageUrl:t.imageUrl})}_createProgressBox(e,t){e.addClass(It),t.imageUrl&&(0,ne.H)(t.imageUrl).addClass(yt).appendTo(e);var i=(0,l.Z)("<div>").addClass(xt).appendTo(e);return{$commonText:(0,l.Z)("<div>").addClass(St).text(t.commonText).appendTo(i),$element:e,$wrapper:i}}}class Pt extends Ot{addOperation(){return{[Dt]:this._id}}addOperationDetails(){}updateOperationItemProgress(){}completeOperationItem(){}completeOperation(){}completeSingleOperationWithError(){}addOperationDetailsError(){}handleDimensionChanged(){return!1}ensureProgressPanelCreated(){}tryHideActionProgress(){this._updateActionProgress("",wt)}updateActionProgressStatus(){this._updateActionProgress("",wt)}_updateActionProgress(e,t){t!==wt&&t!==Mt||(this._actionProgressStatus=t,this._raiseActionProgress(e,t))}hasNoOperations(){return!0}get _operationInProgressCount(){return 0}set _operationInProgressCount(e){}get _failedOperationCount(){return 0}set _failedOperationCount(e){}}class Ft extends Ot{constructor(e){super(e),this._failedOperationCount=0,this._operationInProgressCount=0}addOperation(e,t,i){this._operationInProgressCount++;var o=this._progressPanel.addOperation(e,t,i);return o[Dt]=this._id,this._updateActionProgress(e,Mt),o}addOperationDetails(e,t,i){this._progressPanel.addOperationDetails(e,t,i)}updateOperationItemProgress(e,t,i,o){this._progressPanel.updateOperationItemProgress(e,t,i,o)}completeOperationItem(e,t,i){this._progressPanel.completeOperationItem(e,t,i)}completeOperation(e,t,i,o){this._operationInProgressCount--,i&&this._failedOperationCount++,this._progressPanel.completeOperation(e,t,i,o)}completeSingleOperationWithError(e,t){this._progressPanel.completeSingleOperationWithError(e,t.detailErrorText),this._notifyError(t)}addOperationDetailsError(e,t){this._progressPanel.addOperationDetailsError(e,t.itemIndex,t.detailErrorText),this._notifyError(t)}handleDimensionChanged(){return this._progressPanel&&this._progressPanel.$element().detach(),!0}ensureProgressPanelCreated(e,t){if(this._progressPanel)this._progressPanel.$element().appendTo(e);else{var i=(0,l.Z)("<div>").appendTo(e),o=this._getProgressPanelComponent();this._progressPanel=new o(i,(0,h.l)({},t,{onOperationClosed:e=>{var{info:t}=e;return this._onProgressPanelOperationClosed(t)}}))}}_getProgressPanelComponent(){return bt}_onProgressPanelOperationClosed(e){e.hasError&&(this._failedOperationCount--,this.tryHideActionProgress(e))}tryHideActionProgress(){this.hasNoOperations()&&this._updateActionProgress("",wt)}updateActionProgressStatus(e){e&&this._updateActionProgress("",0===this._failedOperationCount?"success":Tt)}_notifyError(e){var t=this.hasNoOperations()?wt:Tt;this._updateActionProgress(e.commonErrorText,t)}_updateActionProgress(e,t){this._actionProgressStatus=t,this._raiseActionProgress(e,t)}hasNoOperations(){return 0===this._operationInProgressCount&&0===this._failedOperationCount}get _operationInProgressCount(){return this._operationInProgressCountInternal}set _operationInProgressCount(e){this._operationInProgressCountInternal=e}get _failedOperationCount(){return this._failedOperationCountInternal}set _failedOperationCount(e){this._failedOperationCountInternal=e}}var Et=(0,B.Jj)(),At="dx-filemanager-notification",kt="".concat(At,"-drawer"),Zt="".concat(kt,"-panel"),Bt="".concat(At,"-popup"),Ut="".concat(At,"-popup-error"),Vt="".concat(At,"-common"),Kt="".concat(At,"-separator"),Lt="".concat(At,"-details"),Rt="".concat(At,"-common-no-item");class zt extends g.Z{_initMarkup(){super._initMarkup(),this._initActions(),this._isInAdaptiveState=this._isSmallScreen(),this._managerMap={},this._notificationManagerStubId=null,this._setNotificationManager();var e=this.option("progressPanelContainer"),t=(0,l.Z)("<div>").addClass(kt).appendTo(e);(0,l.Z)("<div>").addClass(Zt).appendTo(t);var i=(0,h.l)({opened:!1,position:"right",template:e=>this._ensureProgressPanelCreated(e)},this._getProgressDrawerAdaptiveOptions());this._progressDrawer=this._createComponent(t,Ye.Z,i);var o=t.find(".".concat(Zt)).first(),s=this.option("contentTemplate");(0,d.mf)(s)&&s(o,this)}_setNotificationManager(e){if(e=(0,h.l)({onActionProgressStatusChanged:this._raiseActionProgress.bind(this)},e),!this._notificationManagerStubId){var t=new Pt(e);this._notificationManagerStubId=t.getId(),this._managerMap[this._notificationManagerStubId]=t}if(!this._isProgressDrawerDisabled()){var i=this._getProgressManagerComponent();e.isActual=!0;var o=new i(e);this._managerMap[o.getId()]=o}}_getNotificationManager(e){var t=(null==e?void 0:e[Dt])||this._getActualNotificationManagerId();return this._managerMap[t]||this._managerMap[this._notificationManagerStubId]}_clearManagerMap(){var e=this._managerMap[this._notificationManagerStubId];delete this._managerMap,this._managerMap={[this._notificationManagerStubId]:e}}_getActualNotificationManagerId(){return Object.keys(this._managerMap).filter(e=>this._managerMap[e].isActual())[0]}tryShowProgressPanel(){var e=new c.BH,t=this._getNotificationManager();return t.isActionProgressStatusDefault()||this._isProgressDrawerOpened()||this._isProgressDrawerDisabled()?e.resolve().promise():(setTimeout(()=>{this._progressDrawer.show().done(e.resolve),this._hidePopup(),t.tryHideActionProgress()}),e.promise())}addOperation(e,t,i){return this._getNotificationManager().addOperation(e,t,i)}addOperationDetails(e,t,i){this._getNotificationManager(e).addOperationDetails(e,t,i)}updateOperationItemProgress(e,t,i,o){this._getNotificationManager(e).updateOperationItemProgress(e,t,i,o)}completeOperationItem(e,t,i){this._getNotificationManager(e).completeOperationItem(e,t,i)}completeOperation(e,t,i,o){var s=this._getNotificationManager(e);i||this._showPopup(t),s.completeOperation(e,t,i,o),this._isProgressDrawerOpened()&&s.hasNoOperations()||s.updateActionProgressStatus(e)}completeSingleOperationWithError(e,t){this._getNotificationManager(e).completeSingleOperationWithError(e,t),this._showPopupError(t)}addOperationDetailsError(e,t){this._getNotificationManager(e).addOperationDetailsError(e,t),this._showPopupError(t)}_hideProgressPanel(){setTimeout(()=>this._progressDrawer.hide())}_isSmallScreen(){return!!(0,B.Ym)()&&(0,l.Z)(Et).width()<=1e3}_dimensionChanged(e){var t=this._getNotificationManager();e&&"height"===e||!t.handleDimensionChanged()||this._checkAdaptiveState()}_checkAdaptiveState(){var e=this._isInAdaptiveState;if(this._isInAdaptiveState=this._isSmallScreen(),this._progressDrawer&&e!==this._isInAdaptiveState){var t=this._getProgressDrawerAdaptiveOptions();this._progressDrawer.option(t)}}_getProgressDrawerAdaptiveOptions(){return this._isInAdaptiveState?{openedStateMode:"overlap",shading:!0,closeOnOutsideClick:!0}:{openedStateMode:"shrink",shading:!1,closeOnOutsideClick:!1}}_ensureProgressPanelCreated(e){this._getNotificationManager().ensureProgressPanelCreated(e,{onOperationCanceled:e=>{var{info:t}=e;return this._raiseOperationCanceled(t)},onOperationItemCanceled:e=>{var{item:t,itemIndex:i}=e;return this._raiseOperationItemCanceled(t,i)},onPanelClosed:()=>this._hideProgressPanel()})}_getProgressManagerComponent(){return Ft}_isProgressDrawerDisabled(){return!this.option("showProgressPanel")}_isProgressDrawerOpened(){return this._progressDrawer.option("opened")}_hidePopup(e){(this.option("showNotificationPopup")||e)&&this._getNotificationPopup().hide()}_showPopup(e,t){!this._isProgressDrawerOpened()&&this.option("showNotificationPopup")&&(this._getNotificationPopup().$wrapper().toggleClass(Ut,!!t),this._getNotificationPopup().option("contentTemplate",e),this._getNotificationPopup().option("visible")||this._getNotificationPopup().show())}_showPopupError(e){if(this.option("showNotificationPopup")){var t=this._getNotificationManager(),i=(0,l.Z)("<div>"),o=(0,l.Z)("<div>").addClass(Vt).text(e.commonErrorText),s=(0,l.Z)("<div>").addClass(Kt);(0,l.Z)("<div>").appendTo(s);var n=(0,l.Z)("<div>").addClass(Lt);e.item?t.createErrorDetailsProgressBox(n,e.item,e.detailErrorText):(o.addClass(Rt),t.renderError(n,e.detailErrorText)),i.append(o,s,n),this._showPopup(i,!0)}}_getNotificationPopup(){if(!this._notificationPopup){var e=(0,l.Z)("<div>").addClass(Bt).appendTo(this.$element());this._notificationPopup=this._createComponent(e,Ze.Z,{container:this.$element(),width:"auto",height:"auto",showTitle:!1,dragEnabled:!1,shading:!1,visible:!1,closeOnOutsideClick:!0,animation:{duration:0},position:{my:"right top",at:"right top",of:this.option("positionTarget"),offset:"-10 -5"}})}return this._notificationPopup}_raiseActionProgress(e,t){this._actions.onActionProgress({message:e,status:t})}_raiseOperationCanceled(e){this._actions.onOperationCanceled({info:e})}_raiseOperationItemCanceled(e,t){this._actions.onOperationItemCanceled({item:e,itemIndex:t})}_initActions(){this._actions={onActionProgress:this._createActionByOption("onActionProgress"),onOperationCanceled:this._createActionByOption("onOperationCanceled"),onOperationItemCanceled:this._createActionByOption("onOperationItemCanceled")}}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{progressPanelContainer:null,contentTemplate:null,onActionProgress:null,onOperationCanceled:null,onOperationItemCanceled:null,showProgressPanel:!0,showNotificationPopup:!0})}_optionChanged(e){var t=e.name;switch(t){case"progressPanelContainer":case"contentTemplate":break;case"showProgressPanel":this._setNotificationManager(),this._getNotificationManager().updateActionProgressStatus(),e.value||(this._hideProgressPanel(),this._clearManagerMap()),this._progressDrawer.repaint();break;case"showNotificationPopup":e.value||this._hidePopup(!0);break;case"onActionProgress":case"onOperationCanceled":case"onOperationItemCanceled":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}}var $t=i(9905),Nt=i(10054);const Ht=class extends g.Z{_initMarkup(){super._initMarkup(),this._createOnClosedAction();var e=this._getDialogOptions(),t=(0,l.Z)("<div>").addClass("dx-filemanager-dialog-popup").appendTo(this.$element());e.popupCssClass&&t.addClass(e.popupCssClass);var i={showTitle:!0,title:e.title,visible:!1,closeOnOutsideClick:!0,contentTemplate:this._createContentTemplate.bind(this),toolbarItems:[{widget:"dxButton",toolbar:"bottom",location:"after",options:{text:e.buttonText,onClick:this._applyDialogChanges.bind(this)}},{widget:"dxButton",toolbar:"bottom",location:"after",options:{text:u.Z.format("dxFileManager-dialogButtonCancel"),onClick:this._closeDialog.bind(this)}}],onInitialized:e=>{var{component:t}=e;t.registerKeyHandler("enter",this._applyDialogChanges.bind(this))},onHidden:this._onPopupHidden.bind(this),onShown:this._onPopupShown.bind(this)};(0,d.$K)(e.height)&&(i.height=e.height),(0,d.$K)(e.maxHeight)&&(i.maxHeight=e.maxHeight),this._popup=this._createComponent(t,Ze.Z,i)}show(){this._dialogResult=null,this._popup.show()}_getDialogOptions(){return{title:"Title",buttonText:"ButtonText",contentCssClass:"",popupCssClass:""}}_createContentTemplate(e){this._$contentElement=(0,l.Z)("<div>").appendTo(e).addClass("dx-filemanager-dialog");var t=this._getDialogOptions().contentCssClass;t&&this._$contentElement.addClass(t)}_getDialogResult(){return null}_applyDialogChanges(){var e=this._getDialogResult();e&&(this._dialogResult=e,this._closeDialog())}_closeDialog(){this._popup.hide()}_onPopupHidden(){this._onClosedAction({dialogResult:this._dialogResult})}_onPopupShown(){}_createOnClosedAction(){this._onClosedAction=this._createActionByOption("onClosed")}_setTitle(e){this._popup.option("title",e)}_setButtonText(e){this._popup.option("toolbarItems[0].options.text",e)}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{onClosed:null})}_optionChanged(e){switch(e.name){case"onClosed":this._createOnPathChangedAction();break;default:super._optionChanged(e)}}},qt=class extends Ht{show(e){e=e||"",this._nameTextBox?this._nameTextBox.option("value",e):this._initialNameValue=e,super.show()}_onPopupShown(){if(this._nameTextBox){var e=this._nameTextBox._input();e.length&&e[0].select(),this._nameTextBox.focus()}}_getDialogOptions(){return(0,h.l)(super._getDialogOptions(),{title:this.option("title"),buttonText:this.option("buttonText"),contentCssClass:"dx-filemanager-dialog-name-editor",popupCssClass:"dx-filemanager-dialog-name-editor-popup"})}_createContentTemplate(e){super._createContentTemplate(e),this._nameTextBox=this._createComponent((0,l.Z)("<div>"),Nt.Z,{value:this._initialNameValue,onEnterKey:this._applyDialogChanges.bind(this)}),this._$contentElement.append(this._nameTextBox.$element())}_getDialogResult(){var e=this._nameTextBox.option("value");return e?{name:e}:null}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{title:"",buttonText:""})}},Gt=class extends Ht{show(){var e;this._resetDialogSelectedDirectory(),null===(e=this._filesTreeView)||void 0===e||e.refresh(),super.show()}switchToCopyDialog(e){this._targetItemInfos=e,this._setTitle(u.Z.format("dxFileManager-dialogDirectoryChooserCopyTitle")),this._setButtonText(u.Z.format("dxFileManager-dialogDirectoryChooserCopyButtonText"))}switchToMoveDialog(e){this._targetItemInfos=e,this._setTitle(u.Z.format("dxFileManager-dialogDirectoryChooserMoveTitle")),this._setButtonText(u.Z.format("dxFileManager-dialogDirectoryChooserMoveButtonText"))}_getDialogOptions(){return(0,h.l)(super._getDialogOptions(),{contentCssClass:"dx-filemanager-dialog-folder-chooser",popupCssClass:"dx-filemanager-dialog-folder-chooser-popup"})}_createContentTemplate(e){super._createContentTemplate(e),this._filesTreeView=this._createComponent((0,l.Z)("<div>"),de,{getDirectories:this.option("getDirectories"),getCurrentDirectory:()=>this._getDialogSelectedDirectory(),onDirectoryClick:e=>this._onFilesTreeViewDirectoryClick(e),onFilesTreeViewContentReady:()=>this._toggleUnavailableLocationsDisabled(!0)}),this._$contentElement.append(this._filesTreeView.$element())}_getDialogResult(){var e=this._getDialogSelectedDirectory();return e?{folder:e}:e}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{getItems:null})}_getDialogSelectedDirectory(){return this._selectedDirectoryInfo}_resetDialogSelectedDirectory(){this._selectedDirectoryInfo=null}_onFilesTreeViewDirectoryClick(e){var{itemData:t}=e;this._selectedDirectoryInfo=t,this._filesTreeView.updateCurrentDirectory()}_onPopupShown(){this._toggleUnavailableLocationsDisabled(!0),super._onPopupShown()}_onPopupHidden(){this._toggleUnavailableLocationsDisabled(!1),super._onPopupHidden()}_toggleUnavailableLocationsDisabled(e){if(this._filesTreeView){var t=this._getLocationsToProcess(e);this._filesTreeView.toggleDirectoryExpandedStateRecursive(t.locationsToExpand[0],e).then(()=>this._filesTreeView.toggleDirectoryLineExpandedState(t.locationsToCollapse,!e).then(()=>t.locationKeysToDisable.forEach(t=>this._filesTreeView.toggleNodeDisabledState(t,e))))}}_getLocationsToProcess(e){var t={},i={};this._targetItemInfos.forEach(e=>{e.parentDirectory&&(t[e.parentDirectory.getInternalKey()]=e.parentDirectory),e.fileItem.isDirectory&&(i[e.getInternalKey()]=e)});var o=I(t),s=I(i);return{locationsToExpand:e?o.values:[],locationsToCollapse:e?s.values:[],locationKeysToDisable:o.keys.concat(...s.keys)}}},jt=class extends Ht{show(e){var{itemName:t,itemCount:i}=e,o=1===i?u.Z.format("dxFileManager-dialogDeleteItemSingleItemConfirmation",t):u.Z.format("dxFileManager-dialogDeleteItemMultipleItemsConfirmation",i);this._$text?this._$text.text(o):this._initialText=o,super.show()}_getDialogOptions(){return(0,h.l)(super._getDialogOptions(),{title:u.Z.format("dxFileManager-dialogDeleteItemTitle"),buttonText:u.Z.format("dxFileManager-dialogDeleteItemButtonText"),contentCssClass:"dx-filemanager-dialog-delete-item",popupCssClass:"dx-filemanager-dialog-delete-item-popup",height:"auto",maxHeight:"80vh"})}_createContentTemplate(e){super._createContentTemplate(e),this._$text=(0,l.Z)("<div>").text(this._initialText).appendTo(this._$contentElement),this._createComponent(this._$contentElement,ye.Z,{width:"100%",height:"100%"})}_getDialogResult(){return{}}};var Qt=i(28594),Jt=i(69485),Wt=i(26344),Yt=i(80610),Xt=i(42032),ei=(0,B.Jj)(),ti="dx-fileuploader-dragover",ii="dx-fileuploader-button",oi="dx-fileuploader-button-container",si=()=>!!ei.FormData;class ni extends Jt.Z{_supportedKeys(){var e=e=>{e.preventDefault();var t=this._selectButton.$element();H.Z.trigger(t,Yt.u)};return(0,h.l)(super._supportedKeys(),{space:e,enter:e})}_setOptionsByReference(){super._setOptionsByReference(),(0,h.l)(this._optionsByReference,{value:!0})}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{chunkSize:0,value:[],selectButtonText:u.Z.format("dxFileUploader-selectFile"),uploadButtonText:u.Z.format("dxFileUploader-upload"),labelText:u.Z.format("dxFileUploader-dropFile"),name:"files[]",multiple:!1,accept:"",uploadUrl:"/",allowCanceling:!0,showFileList:!0,progress:0,dialogTrigger:void 0,dropZone:void 0,readyToUploadMessage:u.Z.format("dxFileUploader-readyToUpload"),uploadedMessage:u.Z.format("dxFileUploader-uploaded"),uploadFailedMessage:u.Z.format("dxFileUploader-uploadFailedMessage"),uploadAbortedMessage:u.Z.format("dxFileUploader-uploadAbortedMessage"),uploadMode:"instantly",uploadMethod:"POST",uploadHeaders:{},uploadCustomData:{},onBeforeSend:null,onUploadStarted:null,onUploaded:null,onFilesUploaded:null,onProgress:null,onUploadError:null,onUploadAborted:null,onDropZoneEnter:null,onDropZoneLeave:null,allowedFileExtensions:[],maxFileSize:0,minFileSize:0,inputAttr:{},invalidFileExtensionMessage:u.Z.format("dxFileUploader-invalidFileExtension"),invalidMaxFileSizeMessage:u.Z.format("dxFileUploader-invalidMaxFileSize"),invalidMinFileSizeMessage:u.Z.format("dxFileUploader-invalidMinFileSize"),extendSelection:!0,validationMessageMode:"always",uploadFile:null,uploadChunk:null,abortUpload:null,validationMessageOffset:{h:0,v:0},useNativeInputClick:!1,useDragOver:!0,nativeDropSupported:!0,_uploadButtonType:"normal"})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:()=>"desktop"===me.Z.real().deviceType&&!me.Z.isSimulator(),options:{focusStateEnabled:!0}},{device:[{platform:"android"}],options:{validationMessageOffset:{v:0}}},{device:()=>"desktop"!==me.Z.real().deviceType,options:{useDragOver:!1}},{device:()=>!si(),options:{uploadMode:"useForm"}},{device:()=>Wt.Z.msie||"desktop"!==me.Z.real().deviceType,options:{nativeDropSupported:!1}},{device:()=>(0,Xt.x2)(),options:{_uploadButtonType:"default"}}])}_initOptions(e){var t="labelText"in e;super._initOptions(e),t||this._shouldDragOverBeRendered()||this.option("labelText","")}_init(){super._init(),this._initFileInput(),this._initLabel(),this._setUploadStrategy(),this._createFiles(),this._createBeforeSendAction(),this._createUploadStartedAction(),this._createUploadedAction(),this._createFilesUploadedAction(),this._createProgressAction(),this._createUploadErrorAction(),this._createUploadAbortedAction(),this._createDropZoneEnterAction(),this._createDropZoneLeaveAction()}_setUploadStrategy(){var e=null;if(this.option("chunkSize")>0){var t=this.option("uploadChunk");e=t&&(0,d.mf)(t)?new di(this):new hi(this)}else{var i=this.option("uploadFile");e=i&&(0,d.mf)(i)?new ui(this):new pi(this)}this._uploadStrategy=e}_initFileInput(){this._isCustomClickEvent=!1,this._$fileInput||(this._$fileInput=(0,l.Z)("<input>").attr("type","file"),H.Z.on(this._$fileInput,"change",this._inputChangeHandler.bind(this)),H.Z.on(this._$fileInput,"click",e=>(e.stopPropagation(),this._resetInputValue(),this.option("useNativeInputClick")||this._isCustomClickEvent))),this._$fileInput.prop({multiple:this.option("multiple"),accept:this.option("accept"),tabIndex:-1})}_inputChangeHandler(){if(!this._doPreventInputChange){var e=this._$fileInput.val().replace(/^.*\\/,""),t=this._$fileInput.prop("files");if(!t||t.length||"useForm"===this.option("uploadMode")){var i=t?this._getFiles(t):[{name:e}];this._changeValue(i),"instantly"===this.option("uploadMode")&&this._uploadFiles()}}}_shouldFileListBeExtended(){return"useForm"!==this.option("uploadMode")&&this.option("extendSelection")&&this.option("multiple")}_changeValue(e){var t=this._shouldFileListBeExtended()?this.option("value").slice():[];this.option("value",t.concat(e))}_getFiles(e){var t=[];return(0,x.S6)(e,(e,i)=>t.push(i)),t}_getFile(e){var t=(0,d.kE)(e)?this.option("value")[e]:e;return this._files.filter(e=>e.value===t)[0]}_initLabel(){this._$inputLabel||(this._$inputLabel=(0,l.Z)("<div>")),this._updateInputLabelText()}_updateInputLabelText(){var e=this._isInteractionDisabled()?"":this.option("labelText");this._$inputLabel.text(e)}_focusTarget(){return this.$element().find(".dx-fileuploader-button")}_getSubmitElement(){return this._$fileInput}_initMarkup(){super._initMarkup(),this.$element().addClass("dx-fileuploader"),this._renderWrapper(),this._renderInputWrapper(),this._renderSelectButton(),this._renderInputContainer(),this._renderUploadButton(),this._preventRecreatingFiles=!0}_render(){this._preventRecreatingFiles=!1,this._attachDragEventHandlers(this._$inputWrapper),this._attachDragEventHandlers(this.option("dropZone")),this._renderFiles(),super._render()}_createFileProgressBar(e){e.progressBar=this._createProgressBar(e.value.size),e.progressBar.$element().appendTo(e.$file),this._initStatusMessage(e),this._ensureCancelButtonInitialized(e)}_setStatusMessage(e,t){setTimeout(()=>{this.option("showFileList")&&e.$statusMessage&&(e.$statusMessage.text(t),e.$statusMessage.css("display",""),e.progressBar.$element().remove())},400)}_getUploadAbortedStatusMessage(){return"instantly"===this.option("uploadMode")?this.option("uploadAbortedMessage"):this.option("readyToUploadMessage")}_createFiles(){var e=this.option("value");!this._files||0!==e.length&&this._shouldFileListBeExtended()||(this._preventFilesUploading(this._files),this._files=null),this._files||(this._files=[]),(0,x.S6)(e.slice(this._files.length),(e,t)=>{var i=this._createFile(t);this._validateFile(i),this._files.push(i)})}_preventFilesUploading(e){e.forEach(e=>this._uploadStrategy.abortUpload(e))}_validateFile(e){e.isValidFileExtension=this._validateFileExtension(e),e.isValidMinSize=this._validateMinFileSize(e),e.isValidMaxSize=this._validateMaxFileSize(e)}_validateFileExtension(e){var t=this.option("allowedFileExtensions"),i=e.value.name.substring(e.value.name.lastIndexOf(".")).toLowerCase();if(0===t.length)return!0;for(var o=0;o<t.length;o++)if(i===t[o].toLowerCase())return!0;return!1}_validateMaxFileSize(e){var t=e.value.size,i=this.option("maxFileSize");return!(i>0)||t<=i}_validateMinFileSize(e){var t=e.value.size,i=this.option("minFileSize");return!(i>0)||t>=i}_createBeforeSendAction(){this._beforeSendAction=this._createActionByOption("onBeforeSend",{excludeValidators:["readOnly"]})}_createUploadStartedAction(){this._uploadStartedAction=this._createActionByOption("onUploadStarted",{excludeValidators:["readOnly"]})}_createUploadedAction(){this._uploadedAction=this._createActionByOption("onUploaded",{excludeValidators:["readOnly"]})}_createFilesUploadedAction(){this._filesUploadedAction=this._createActionByOption("onFilesUploaded",{excludeValidators:["readOnly"]})}_createProgressAction(){this._progressAction=this._createActionByOption("onProgress",{excludeValidators:["readOnly"]})}_createUploadAbortedAction(){this._uploadAbortedAction=this._createActionByOption("onUploadAborted",{excludeValidators:["readOnly"]})}_createUploadErrorAction(){this._uploadErrorAction=this._createActionByOption("onUploadError",{excludeValidators:["readOnly"]})}_createDropZoneEnterAction(){this._dropZoneEnterAction=this._createActionByOption("onDropZoneEnter")}_createDropZoneLeaveAction(){this._dropZoneLeaveAction=this._createActionByOption("onDropZoneLeave")}_createFile(e){return{value:e,loadedSize:0,onProgress:(0,Qt.Z)(),onAbort:(0,Qt.Z)(),onLoad:(0,Qt.Z)(),onError:(0,Qt.Z)(),onLoadStart:(0,Qt.Z)(),isValidFileExtension:!0,isValidMaxSize:!0,isValidMinSize:!0,isValid(){return this.isValidFileExtension&&this.isValidMaxSize&&this.isValidMinSize},isInitialized:!1}}_resetFileState(e){e.isAborted=!1,e.uploadStarted=!1,e.isStartLoad=!1,e.loadedSize=0,e.chunksData=void 0,e.request=void 0}_renderFiles(){var e,t=this.option("value");this._$filesContainer?this._shouldFileListBeExtended()&&0!==t.length||this._$filesContainer.empty():this._$filesContainer=(0,l.Z)("<div>").addClass("dx-fileuploader-files-container").appendTo(this._$content);var i=this.option("showFileList");i&&(0,x.S6)(this._files,(e,t)=>{t.$file||this._renderFile(t)}),this.$element().toggleClass("dx-fileuploader-show-file-list",i),this._toggleFileUploaderEmptyClassName(),this._updateFileNameMaxWidth(),null===(e=this._validationMessage)||void 0===e||e.repaint()}_renderFile(e){var t=e.value,i=(0,l.Z)("<div>").addClass("dx-fileuploader-file-container").appendTo(this._$filesContainer);this._renderFileButtons(e,i),e.$file=(0,l.Z)("<div>").addClass("dx-fileuploader-file").appendTo(i);var o=(0,l.Z)("<div>").addClass("dx-fileuploader-file-info").appendTo(e.$file);e.$statusMessage=(0,l.Z)("<div>").addClass("dx-fileuploader-file-status-message").appendTo(e.$file),(0,l.Z)("<div>").addClass("dx-fileuploader-file-name").text(t.name).appendTo(o),(0,d.$K)(t.size)&&(0,l.Z)("<div>").addClass("dx-fileuploader-file-size").text(this._getFileSize(t.size)).appendTo(o),e.isValid()?e.$statusMessage.text(this.option("readyToUploadMessage")):(e.isValidFileExtension||e.$statusMessage.append(this._createValidationElement("invalidFileExtensionMessage")),e.isValidMaxSize||e.$statusMessage.append(this._createValidationElement("invalidMaxFileSizeMessage")),e.isValidMinSize||e.$statusMessage.append(this._createValidationElement("invalidMinFileSizeMessage")),i.addClass("dx-fileuploader-invalid"))}_createValidationElement(e){return(0,l.Z)("<span>").text(this.option(e))}_updateFileNameMaxWidth(){var e=this.option("allowCanceling")&&"useForm"!==this.option("uploadMode")?1:0,t="useButtons"===this.option("uploadMode")?1:0,i=this._$filesContainer.find(".dx-fileuploader-file-container").first().width()||this._$filesContainer.width(),o=this._$filesContainer.find(".dx-fileuploader-button-container").eq(0).width()*(e+t),s=this._$filesContainer.find(".dx-fileuploader-file-size").eq(0),n=s.text();s.text("1000 Mb");var r=s.width();s.text(n),this._$filesContainer.find(".dx-fileuploader-file-name").css("maxWidth",i-o-r)}_renderFileButtons(e,t){var i=this._getCancelButton(e);i&&t.append(i);var o=this._getUploadButton(e);o&&t.append(o)}_getCancelButton(e){return"useForm"===this.option("uploadMode")?null:(e.cancelButton=this._createComponent((0,l.Z)("<div>").addClass("dx-fileuploader-button dx-fileuploader-cancel-button"),ae.Z,{onClick:()=>this._removeFile(e),icon:"close",visible:this.option("allowCanceling"),disabled:this.option("readOnly"),integrationOptions:{}}),(0,l.Z)("<div>").addClass(oi).append(e.cancelButton.$element()))}_getUploadButton(e){return e.isValid()&&"useButtons"===this.option("uploadMode")?(e.uploadButton=this._createComponent((0,l.Z)("<div>").addClass("dx-fileuploader-button dx-fileuploader-upload-button"),ae.Z,{onClick:()=>this._uploadFile(e),icon:"upload"}),e.onLoadStart.add(()=>e.uploadButton.option({visible:!1,disabled:!0})),e.onAbort.add(()=>e.uploadButton.option({visible:!0,disabled:!1})),(0,l.Z)("<div>").addClass(oi).append(e.uploadButton.$element())):null}_removeFile(e){var t;null===(t=e.$file)||void 0===t||t.parent().remove(),this._files.splice((0,A.d3)(e,this._files),1);var i=this.option("value").slice();i.splice((0,A.d3)(e.value,i),1),this._preventRecreatingFiles=!0,this.option("value",i),this._preventRecreatingFiles=!1,this._toggleFileUploaderEmptyClassName(),this._resetInputValue(!0)}removeFile(e){if("useForm"!==this.option("uploadMode")&&(0,d.$K)(e)){var t=this._getFile(e);t&&(t.uploadStarted&&this._preventFilesUploading([t]),this._removeFile(t))}}_toggleFileUploaderEmptyClassName(){this.$element().toggleClass("dx-fileuploader-empty",!this._files.length||this._hasInvalidFile(this._files))}_hasInvalidFile(e){for(var t=0;t<e.length;t++)if(!e[t].isValid())return!0;return!1}_getFileSize(e){for(var t=0,i=[u.Z.format("dxFileUploader-bytes"),u.Z.format("dxFileUploader-kb"),u.Z.format("dxFileUploader-Mb"),u.Z.format("dxFileUploader-Gb")],o=i.length-1;t<o&&e>=1024;)e/=1024,t++;return Math.round(e)+" "+i[t]}_renderSelectButton(){var e=(0,l.Z)("<div>").addClass(ii).appendTo(this._$inputWrapper);this._selectButton=this._createComponent(e,ae.Z,{text:this.option("selectButtonText"),focusStateEnabled:!1,integrationOptions:{},disabled:this.option("readOnly")}),this._selectFileDialogHandler=this._selectButtonClickHandler.bind(this),"desktop"===me.Z.real().deviceType?this._selectButton.option("onClick",this._selectFileDialogHandler):this._attachSelectFileDialogHandler(this._selectButton.$element()),this._attachSelectFileDialogHandler(this.option("dialogTrigger"))}_selectButtonClickHandler(){if(!this.option("useNativeInputClick")){if(this._isInteractionDisabled())return!1;this._isCustomClickEvent=!0,H.Z.trigger(this._$fileInput,"click"),this._isCustomClickEvent=!1}}_attachSelectFileDialogHandler(e){(0,d.$K)(e)&&(this._detachSelectFileDialogHandler(e),H.Z.on((0,l.Z)(e),"click",this._selectFileDialogHandler))}_detachSelectFileDialogHandler(e){(0,d.$K)(e)&&H.Z.off((0,l.Z)(e),"click",this._selectFileDialogHandler)}_renderUploadButton(){if("useButtons"===this.option("uploadMode")){var e=(0,l.Z)("<div>").addClass(ii).addClass("dx-fileuploader-upload-button").appendTo(this._$content);this._uploadButton=this._createComponent(e,ae.Z,{text:this.option("uploadButtonText"),onClick:this._uploadButtonClickHandler.bind(this),type:this.option("_uploadButtonType"),integrationOptions:{}})}}_uploadButtonClickHandler(){this._uploadFiles()}_shouldDragOverBeRendered(){return!this.option("readOnly")&&("useForm"!==this.option("uploadMode")||this.option("nativeDropSupported"))}_isInteractionDisabled(){return this.option("readOnly")||this.option("disabled")}_renderInputContainer(){this._$inputContainer=(0,l.Z)("<div>").addClass("dx-fileuploader-input-container").appendTo(this._$inputWrapper),this._$fileInput.addClass("dx-fileuploader-input"),this._renderInput();var e="dx-fileuploader-input-label-".concat(new k.Z);this._$inputLabel.attr("id",e).addClass("dx-fileuploader-input-label").appendTo(this._$inputContainer),this.setAria("labelledby",e,this._$fileInput)}_renderInput(){this.option("useNativeInputClick")?this._selectButton.option("template",this._selectButtonInputTemplate.bind(this)):(this._$fileInput.appendTo(this._$inputContainer),this._selectButton.option("template","content")),this._applyInputAttributes(this.option("inputAttr"))}_selectButtonInputTemplate(e,t){var i=(0,l.Z)(t),o=(0,l.Z)("<span>").addClass("dx-button-text").text(e.text);return i.append(o).append(this._$fileInput),i}_renderInputWrapper(){this._$inputWrapper=(0,l.Z)("<div>").addClass("dx-fileuploader-input-wrapper").appendTo(this._$content)}_detachDragEventHandlers(e){(0,d.$K)(e)&&H.Z.off((0,l.Z)(e),(0,ue.V4)("",this.NAME))}_attachDragEventHandlers(e){var t=e!==this._$inputWrapper;(0,d.$K)(e)&&this._shouldDragOverBeRendered()&&(this._detachDragEventHandlers(e),e=(0,l.Z)(e),this._dragEventsTargets=[],H.Z.on(e,(0,ue.V4)("dragenter",this.NAME),this._dragEnterHandler.bind(this,t)),H.Z.on(e,(0,ue.V4)("dragover",this.NAME),this._dragOverHandler.bind(this)),H.Z.on(e,(0,ue.V4)("dragleave",this.NAME),this._dragLeaveHandler.bind(this,t)),H.Z.on(e,(0,ue.V4)("drop",this.NAME),this._dropHandler.bind(this,t)))}_applyInputAttributes(e){this._$fileInput.attr(e)}_useInputForDrop(){return this.option("nativeDropSupported")&&"useForm"===this.option("uploadMode")}_dragEnterHandler(e,t){if(this.option("disabled"))return!1;this._useInputForDrop()||t.preventDefault(),this._tryToggleDropZoneActive(!0,e,t),this._updateEventTargets(t)}_dragOverHandler(e){this._useInputForDrop()||e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="copy"}_dragLeaveHandler(e,t){this._useInputForDrop()||t.preventDefault(),this._updateEventTargets(t),this._tryToggleDropZoneActive(!1,e,t)}_updateEventTargets(e){var t=this._dragEventsTargets.indexOf(e.target),i=-1!==t;"dragenter"===e.type?!i&&this._dragEventsTargets.push(e.target):i&&this._dragEventsTargets.splice(t,1)}_tryToggleDropZoneActive(e,t,i){var o=e?"addClass":"removeClass";this._dragEventsTargets.length||(this[e?"_dropZoneEnterAction":"_dropZoneLeaveAction"]({event:i,dropZoneElement:i.currentTarget}),t||this.$element()[o](ti))}_dropHandler(e,t){if(this._dragEventsTargets=[],e||this.$element().removeClass(ti),!(this._useInputForDrop()||e&&this._isInteractionDisabled())){t.preventDefault();var i=this._getFiles(t.originalEvent.dataTransfer.files);!this.option("multiple")&&i.length>1||(this._changeValue(this._filterFiles(i)),"instantly"===this.option("uploadMode")&&this._uploadFiles())}}_handleAllFilesUploaded(){this._files.every(e=>!e.isValid()||e._isError||e._isLoaded||e.isAborted)&&this._filesUploadedAction()}_filterFiles(e){if(!e.length)return e;var t=this.option("accept");if(!t.length)return e;for(var i=[],o=this._getAllowedFileTypes(t),s=0,n=e.length;s<n;s++)this._isFileTypeAllowed(e[s],o)&&i.push(e[s]);return i}_getAllowedFileTypes(e){return e.length?e.split(",").map(e=>e.trim()):[]}_isFileTypeAllowed(e,t){for(var i=0,o=t.length;i<o;i++){var s=t[i];if("."===s[0]){if(s=s.replace(".","\\."),e.name.match(new RegExp(s+"$","i")))return!0}else if(s=s.replace(new RegExp("\\*","g"),""),e.type.match(new RegExp(s,"i")))return!0}return!1}_renderWrapper(){var e=(0,l.Z)("<div>").addClass("dx-fileuploader-wrapper").appendTo(this.$element()),t=(0,l.Z)("<div>").addClass("dx-fileuploader-container").appendTo(e);this._$content=(0,l.Z)("<div>").addClass("dx-fileuploader-content").appendTo(t)}_clean(){this._$fileInput.detach(),delete this._$filesContainer,this._files&&this._files.forEach(e=>{e.$file=null,e.$statusMessage=null}),super._clean()}abortUpload(e){if("useForm"!==this.option("uploadMode"))if((0,d.$K)(e)){var t=this._getFile(e);t&&this._preventFilesUploading([t])}else this._preventFilesUploading(this._files)}upload(e){if("useForm"!==this.option("uploadMode"))if((0,d.$K)(e)){var t=this._getFile(e);t&&si()&&this._uploadFile(t)}else this._uploadFiles()}_uploadFiles(){si()&&(0,x.S6)(this._files,(e,t)=>this._uploadFile(t))}_uploadFile(e){this._uploadStrategy.upload(e)}_updateProgressBar(e,t){e.progressBar&&e.progressBar.option({value:t.loaded,showStatus:!0}),this._progressAction({file:e.value,segmentSize:t.currentSegmentSize,bytesLoaded:t.loaded,bytesTotal:t.total,event:t.event,request:e.request})}_updateTotalProgress(e,t){var i=e?this._getProgressValue(t/e):0;this.option("progress",i),this._setLoadedSize(t)}_getProgressValue(e){return Math.floor(100*e)}_initStatusMessage(e){e.$statusMessage.css("display","none")}_ensureCancelButtonInitialized(e){if(!e.isInitialized){e.cancelButton.option("onClick",()=>{this._preventFilesUploading([e]),this._removeFile(e)});var t=()=>{setTimeout(()=>{e.cancelButton.option({visible:!1})},400)};e.onLoad.add(t),e.onError.add(t)}}_createProgressBar(e){return this._createComponent((0,l.Z)("<div>"),Xe.Z,{value:void 0,min:0,max:e,statusFormat:e=>this._getProgressValue(e)+"%",showStatus:!1,statusPosition:"right"})}_getTotalFilesSize(){return this._totalFilesSize||(this._totalFilesSize=0,(0,x.S6)(this._files,(e,t)=>{this._totalFilesSize+=t.value.size})),this._totalFilesSize}_getTotalLoadedFilesSize(){return this._totalLoadedFilesSize||(this._totalLoadedFilesSize=0,(0,x.S6)(this._files,(e,t)=>{this._totalLoadedFilesSize+=t.loadedSize})),this._totalLoadedFilesSize}_setLoadedSize(e){this._totalLoadedFilesSize=e}_recalculateProgress(){this._totalFilesSize=0,this._totalLoadedFilesSize=0,this._updateTotalProgress(this._getTotalFilesSize(),this._getTotalLoadedFilesSize())}_updateReadOnlyState(){var e=this.option("readOnly");this._selectButton.option("disabled",e),this._files.forEach(t=>{var i;return null===(i=t.cancelButton)||void 0===i?void 0:i.option("disabled",e)}),this._updateInputLabelText(),this._attachDragEventHandlers(this._$inputWrapper)}_optionChanged(e){var{name:t,value:i,previousValue:o}=e;switch(t){case"height":case"width":this._updateFileNameMaxWidth(),super._optionChanged(e);break;case"value":!i.length&&this._$fileInput.val(""),this._preventRecreatingFiles||(this._createFiles(),this._renderFiles()),this._recalculateProgress(),super._optionChanged(e);break;case"name":this._initFileInput(),super._optionChanged(e);break;case"accept":this._initFileInput();break;case"multiple":this._initFileInput(),e.value||this.reset();break;case"readOnly":this._updateReadOnlyState(),super._optionChanged(e);break;case"selectButtonText":this._selectButton.option("text",i);break;case"uploadButtonText":this._uploadButton&&this._uploadButton.option("text",i);break;case"_uploadButtonType":this._uploadButton&&this._uploadButton.option("type",i);break;case"dialogTrigger":this._detachSelectFileDialogHandler(o),this._attachSelectFileDialogHandler(i);break;case"dropZone":this._detachDragEventHandlers(o),this._attachDragEventHandlers(i);break;case"maxFileSize":case"minFileSize":case"allowedFileExtensions":case"invalidFileExtensionMessage":case"invalidMaxFileSizeMessage":case"invalidMinFileSizeMessage":case"readyToUploadMessage":case"uploadedMessage":case"uploadFailedMessage":case"uploadAbortedMessage":this._invalidate();break;case"labelText":this._updateInputLabelText();break;case"showFileList":this._preventRecreatingFiles||this._renderFiles();break;case"uploadFile":case"uploadChunk":case"chunkSize":this._setUploadStrategy();break;case"abortUpload":case"uploadUrl":case"progress":case"uploadMethod":case"uploadHeaders":case"uploadCustomData":case"extendSelection":break;case"allowCanceling":case"uploadMode":this.reset(),this._invalidate();break;case"onBeforeSend":this._createBeforeSendAction();break;case"onUploadStarted":this._createUploadStartedAction();break;case"onUploaded":this._createUploadedAction();break;case"onFilesUploaded":this._createFilesUploadedAction();break;case"onProgress":this._createProgressAction();break;case"onUploadError":this._createUploadErrorAction();break;case"onUploadAborted":this._createUploadAbortedAction();break;case"onDropZoneEnter":this._createDropZoneEnterAction();break;case"onDropZoneLeave":this._createDropZoneLeaveAction();break;case"useNativeInputClick":this._renderInput();break;case"useDragOver":this._attachDragEventHandlers(this._$inputWrapper);break;case"nativeDropSupported":this._invalidate();break;case"inputAttr":this._applyInputAttributes(this.option(t));break;default:super._optionChanged(e)}}_resetInputValue(e){("useForm"!==this.option("uploadMode")||e)&&(this._doPreventInputChange=!0,this._$fileInput.val(""),this._doPreventInputChange=!1)}reset(){this.option("value",[])}}class ri{constructor(e,t){this.file=e,this.chunkSize=t,this.index=0}read(){if(!this.file)return null;var e=this.createBlobResult(this.file,this.index,this.chunkSize);return e.isCompleted&&(this.file=null),this.index++,e}createBlobResult(e,t,i){var o=t*i;return{blob:this.sliceFile(e,o,i),index:t,isCompleted:o+i>=e.size}}sliceFile(e,t,i){return e.slice?e.slice(t,t+i):e.webkitSlice?e.webkitSlice(t,t+i):null}}class ai{constructor(e){this.fileUploader=e}upload(e){e.isInitialized&&e.isAborted&&this.fileUploader._resetFileState(e),e.isValid()&&!e.uploadStarted&&(this._prepareFileBeforeUpload(e),this._uploadCore(e))}abortUpload(e){if(!(e._isError||e._isLoaded||e.isAborted)&&e.uploadStarted&&(e.isAborted=!0,e.request&&e.request.abort(),this._isCustomCallback("abortUpload"))){var t=this.fileUploader.option("abortUpload"),i=this._createUploadArgument(e),o=null;try{var s=t(e.value,i);o=(0,c.p4)(s)}catch(R){o=(new c.BH).reject(R).promise()}o.done(()=>e.onAbort.fire()).fail(t=>this._handleFileError(e,t))}}_beforeSend(e,t){var i=this._createUploadArgument(t);this.fileUploader._beforeSendAction({request:e,file:t.value,uploadInfo:i}),t.request=e}_createUploadArgument(e){}_uploadCore(e){}_isCustomCallback(e){var t=this.fileUploader.option(e);return t&&(0,d.mf)(t)}_handleFileError(e,t){e._isError=!0,e.onError.fire(t)}_prepareFileBeforeUpload(e){var t;e.$file&&(null===(t=e.progressBar)||void 0===t||t.dispose(),this.fileUploader._createFileProgressBar(e)),e.isInitialized||(e.onLoadStart.add(this._onUploadStarted.bind(this,e)),e.onLoad.add(this._onLoadedHandler.bind(this,e)),e.onError.add(this._onErrorHandler.bind(this,e)),e.onAbort.add(this._onAbortHandler.bind(this,e)),e.onProgress.add(this._onProgressHandler.bind(this,e)),e.isInitialized=!0)}_isStatusError(e){return 400<=e&&e<500||500<=e&&e<600}_onUploadStarted(e,t){e.uploadStarted=!0,this.fileUploader._uploadStartedAction({file:e.value,event:t,request:e.request})}_onAbortHandler(e,t){var i={file:e.value,event:t,request:e.request,message:this.fileUploader._getUploadAbortedStatusMessage()};this.fileUploader._uploadAbortedAction(i),this.fileUploader._setStatusMessage(e,i.message),this.fileUploader._handleAllFilesUploaded()}_onErrorHandler(e,t){var i={file:e.value,event:void 0,request:e.request,error:t,message:this.fileUploader.option("uploadFailedMessage")};this.fileUploader._uploadErrorAction(i),this.fileUploader._setStatusMessage(e,i.message),this.fileUploader._handleAllFilesUploaded()}_onLoadedHandler(e,t){var i={file:e.value,event:t,request:e.request,message:this.fileUploader.option("uploadedMessage")};e._isLoaded=!0,this.fileUploader._uploadedAction(i),this.fileUploader._setStatusMessage(e,i.message),this.fileUploader._handleAllFilesUploaded()}_onProgressHandler(e,t){if(e){var i=this.fileUploader._getTotalFilesSize(),o=this.fileUploader._getTotalLoadedFilesSize(),s=Math.min(t.loaded,e.value.size),n=s-e.loadedSize;e.loadedSize=s,this.fileUploader._updateTotalProgress(i,o+n),this.fileUploader._updateProgressBar(e,this._getLoadedData(s,t.total,n,t))}}_getLoadedData(e,t,i,o){return{loaded:e,total:t,currentSegmentSize:i}}_extendFormData(e){var t=this.fileUploader.option("uploadCustomData");for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(0,d.$K)(t[i])&&e.append(i,t[i])}}class li extends ai{constructor(e){super(e),this.chunkSize=this.fileUploader.option("chunkSize")}_uploadCore(e){var t=e.value,i={name:t.name,loadedBytes:0,type:t.type,blobReader:new ri(t,this.chunkSize),guid:new k.Z,fileSize:t.size,count:Math.ceil(t.size/this.chunkSize),customData:{}};e.chunksData=i,this._sendChunk(e,i)}_sendChunk(e,t){var i=t.blobReader.read();t.currentChunk=i,i&&this._sendChunkCore(e,t,i).done(()=>{e.isAborted||(t.loadedBytes+=i.blob.size,e.onProgress.fire({loaded:t.loadedBytes,total:e.value.size}),i.isCompleted&&e.onLoad.fire(),setTimeout(()=>this._sendChunk(e,t)))}).fail(t=>{this._shouldHandleError(t)&&this._handleFileError(e,t)})}_sendChunkCore(e,t,i){}_shouldHandleError(e){}_tryRaiseStartLoad(e){e.isStartLoad||(e.isStartLoad=!0,e.onLoadStart.fire())}_getEvent(e){return null}_createUploadArgument(e){return this._createChunksInfo(e.chunksData)}_createChunksInfo(e){return{bytesUploaded:e.loadedBytes,chunkCount:e.count,customData:e.customData,chunkBlob:e.currentChunk.blob,chunkIndex:e.currentChunk.index}}}class hi extends li{_sendChunkCore(e,t,i){return N.Z.sendRequest({url:this.fileUploader.option("uploadUrl"),method:this.fileUploader.option("uploadMethod"),headers:this.fileUploader.option("uploadHeaders"),beforeSend:t=>this._beforeSend(t,e),upload:{onloadstart:()=>this._tryRaiseStartLoad(e),onabort:()=>e.onAbort.fire()},data:this._createFormData({fileName:t.name,blobName:this.fileUploader.option("name"),blob:i.blob,index:i.index,count:t.count,type:t.type,guid:t.guid,size:t.fileSize})})}_shouldHandleError(e){return this._isStatusError(e.status)}_createFormData(e){var t=new ei.FormData;return t.append(e.blobName,e.blob),t.append("chunkMetadata",JSON.stringify({FileName:e.fileName,Index:e.index,TotalCount:e.count,FileSize:e.size,FileType:e.type,FileGuid:e.guid})),this._extendFormData(t),t}}class di extends li{_sendChunkCore(e,t){this._tryRaiseStartLoad(e);var i=this._createChunksInfo(t),o=this.fileUploader.option("uploadChunk");try{var s=o(e.value,i);return(0,c.p4)(s)}catch(R){return(new c.BH).reject(R).promise()}}_shouldHandleError(e){return!0}}class ci extends ai{_uploadCore(e){e.loadedSize=0,this._uploadFile(e).done(()=>{e.isAborted||e.onLoad.fire()}).fail(t=>{this._shouldHandleError(e,t)&&this._handleFileError(e,t)})}_uploadFile(e){}_shouldHandleError(e,t){}_handleProgress(e,t){e._isError||(e._isProgressStarted=!0,e.onProgress.fire(t))}_getLoadedData(e,t,i,o){var s=super._getLoadedData(e,t,i,o);return s.event=o,s}}class pi extends ci{_uploadFile(e){return N.Z.sendRequest({url:this.fileUploader.option("uploadUrl"),method:this.fileUploader.option("uploadMethod"),headers:this.fileUploader.option("uploadHeaders"),beforeSend:t=>this._beforeSend(t,e),upload:{onprogress:t=>this._handleProgress(e,t),onloadstart:()=>e.onLoadStart.fire(),onabort:()=>e.onAbort.fire()},data:this._createFormData(this.fileUploader.option("name"),e.value)})}_shouldHandleError(e,t){return(this._isStatusError(t.status)||!e._isProgressStarted)&&!e.isAborted}_createFormData(e,t){var i=new ei.FormData;return i.append(e,t,t.name),this._extendFormData(i),i}}class ui extends ci{_uploadFile(e){e.onLoadStart.fire();var t=this.fileUploader.option("uploadFile");try{var i=t(e.value,t=>{this._handleProgress(e,{loaded:t,total:e.size})});return(0,c.p4)(i)}catch(R){return(new c.BH).reject(R).promise()}}_shouldHandleError(e,t){return!0}}(0,m.Z)("dxFileUploader",ni);const mi=ni,gi=class extends g.Z{_initMarkup(){this._initActions(),this.$element().addClass("dx-filemanager-fileuploader"),this._uploaderInfos=[],this._createInternalFileUploader(),this._createDropZonePlaceholder(),this._setDropZonePlaceholderVisible(!1),super._initMarkup()}_createInternalFileUploader(){var e=this._getController().chunkSize,t=(0,l.Z)("<div>").appendTo(this.$element()),i=this._createComponent(t,mi,{name:"file",multiple:!0,showFileList:!1,activeStateEnabled:!1,focusStateEnabled:!1,hoverStateEnabled:!1,labelText:"",readyToUploadMessage:"",accept:"*",chunkSize:e,dropZone:this.option("dropZone"),onValueChanged:e=>this._onFileUploaderValueChanged(e),onProgress:e=>this._onFileUploaderProgress(e),onUploaded:e=>this._onFileUploaderUploaded(e),onUploadAborted:e=>this._onFileUploaderUploadAborted(e),onUploadError:e=>this._onFileUploaderUploadError(e),onDropZoneEnter:()=>this._setDropZonePlaceholderVisible(!0),onDropZoneLeave:()=>this._setDropZonePlaceholderVisible(!1)});i.option({uploadChunk:(e,t)=>this._fileUploaderUploadChunk(i,e,t),abortUpload:(e,t)=>this._fileUploaderAbortUpload(i,e,t)}),this._uploaderInfos.push({fileUploader:i})}tryUpload(){var e=this._findAndUpdateAvailableUploaderInfo();e&&e.fileUploader._selectButtonClickHandler()}cancelUpload(e){this._cancelUpload(e)}cancelFileUpload(e,t){this._cancelUpload(e,t)}_cancelUpload(e,t){var{fileUploader:i}=this._findUploaderInfoBySessionId(e);i.abortUpload(t)}_fileUploaderUploadChunk(e,t,i){var{session:o,fileIndex:s}=this._findSessionByFile(e,t),n=o.controller;return i.fileIndex=s,n.uploadFileChunk(t,i)}_fileUploaderAbortUpload(e,t,i){var{session:o,fileIndex:s}=this._findSessionByFile(e,t),n=o.controller;return i.fileIndex=s,n.abortFileUpload(t,i)}_onFileUploaderValueChanged(e){var{component:t,value:i}=e;if(0!==i.length){var o=i.slice(),s=this._findUploaderInfo(t);this._uploadFiles(s,o),setTimeout(()=>{this._findAndUpdateAvailableUploaderInfo()||this._createInternalFileUploader()})}}_onFileUploaderProgress(e){var{component:t,file:i,bytesLoaded:o,bytesTotal:s}=e,{session:n,fileIndex:r}=this._findSessionByFile(t,i),a=0!==s?o/s:1,l=t.option("progress")/100;this._raiseUploadProgress({sessionId:n.id,fileIndex:r,commonValue:l,fileValue:a})}_onFileUploaderUploaded(e){var{component:t,file:i}=e;this._getDeferredForFile(t,i).resolve()}_onFileUploaderUploadAborted(e){var{component:t,file:i}=e;this._getDeferredForFile(t,i).resolve({canceled:!0})}_onFileUploaderUploadError(e){var{component:t,file:i,error:o}=e;this._getDeferredForFile(t,i).reject(o)}_createDropZonePlaceholder(){this._$dropZonePlaceholder=(0,l.Z)("<div>").addClass("dx-filemanager-fileuploader-dropzone-placeholder").appendTo(this.option("dropZonePlaceholderContainer"))}_adjustDropZonePlaceholder(){if((0,B.Ym)()){var e=this.option("dropZone"),t=parseFloat(this._$dropZonePlaceholder.css("borderTopWidth")),i=parseFloat(this._$dropZonePlaceholder.css("borderLeftWidth")),o=this.option("dropZonePlaceholderContainer"),s=parseFloat(o.css("borderBottomWidth")),n=parseFloat(o.css("borderLeftWidth")),r=o.innerHeight(),a=o.offset(),l=e.offset();this._$dropZonePlaceholder.css({top:l.top-a.top-r-s,left:l.left-a.left-n}),this._$dropZonePlaceholder.height(e.get(0).offsetHeight-2*t),this._$dropZonePlaceholder.width(e.get(0).offsetWidth-2*i)}}_setDropZonePlaceholderVisible(e){e?(this._adjustDropZonePlaceholder(),this._$dropZonePlaceholder.css("display","")):this._$dropZonePlaceholder.css("display","none")}_uploadFiles(e,t){this._setDropZonePlaceholderVisible(!1);var i=(new k.Z).toString(),o=this._getController(),s=t.map(()=>new c.BH);return e.session={id:i,controller:o,files:t,deferreds:s},this._raiseUploadSessionStarted({sessionId:i,deferreds:s,files:t}),f(s).always(()=>setTimeout(()=>{e.fileUploader.reset(),e.session=null}))}_getDeferredForFile(e,t){var{session:i,fileIndex:o}=this._findSessionByFile(e,t);return i.deferreds[o]}_findSessionByFile(e,t){var i=this._findUploaderInfo(e).session,o=i.files.indexOf(t);return{session:i,fileIndex:o}}_findUploaderInfoBySessionId(e){for(var t=0;t<this._uploaderInfos.length;t++){var i=this._uploaderInfos[t],o=i.session;if(o&&o.id===e)return i}return null}_findAndUpdateAvailableUploaderInfo(){for(var e,t=null,i=0;i<this._uploaderInfos.length;i++){var o=this._uploaderInfos[i];o.fileUploader.option("dropZone",""),t||o.session||(t=o)}return null===(e=t)||void 0===e||e.fileUploader.option("dropZone",this.option("dropZone")),t}_findUploaderInfo(e){for(var t=0;t<this._uploaderInfos.length;t++){var i=this._uploaderInfos[t];if(i.fileUploader===e)return i}return null}_getController(){return this.option("getController")()}_raiseUploadSessionStarted(e){this._actions.onUploadSessionStarted({sessionInfo:e})}_raiseUploadProgress(e){this._actions.onUploadProgress(e)}_initActions(){this._actions={onUploadSessionStarted:this._createActionByOption("onUploadSessionStarted"),onUploadProgress:this._createActionByOption("onUploadProgress")}}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{getController:null,onUploadSessionStarted:null,onUploadProgress:null})}_optionChanged(e){var t=e.name;switch(t){case"getController":this.repaint();break;case"onUploadSessionStarted":case"onUploadProgress":this._actions[t]=this._createActionByOption(t);break;case"dropZone":this._findAndUpdateAvailableUploaderInfo(),this._adjustDropZonePlaceholder();break;case"dropZonePlaceholderContainer":this._$dropZonePlaceholder.detach(),this._$dropZonePlaceholder.appendTo(e.value);break;default:super._optionChanged(e)}}};class _i{constructor(e,t,i){this._actionMetadata=e,this._itemInfos=t,this._onlyFiles=!this._actionMetadata.affectsAllItems&&this._itemInfos.every(e=>!e.fileItem.isDirectory),this._items=this._itemInfos.map(e=>e.fileItem),this._multipleItems=this._items.length>1,this._location=i.getDisplayName(),this._singleRequest=!0,this._completedItems=[],this._commonProgress=0,this._errorState={failedCount:0},this._itemNewName=""}completeOperationItem(e){this._singleRequest?this._completedItems=[...this._items]:this._completedItems.push(this._items[e]),this._actionMetadata.allowItemProgress||(this._commonProgress=this._completedItems.length/this._items.length*100)}processSingleRequestError(e){this._errorState.failedCount=1,this._errorState.commonErrorText=this._multipleItems?this._actionMetadata.commonErrorMessage:this._actionMetadata.singleItemErrorMessage;var t=this._multipleItems?-1:1,i=this.getItemForSingleRequestError();this._setCurrentDetailError(t,i,e)}processMultipleRequestError(e,t){this._errorState.failedCount++,this._errorState.commonErrorText=this._errorState.failedCount>1?(0,$t.WU)(this._actionMetadata.multipleItemsErrorMessage,this._errorState.failedCount):this._actionMetadata.singleItemErrorMessage;var i=this.getItemForMultipleRequestError(e);this._setCurrentDetailError(e,i,t)}hasModifiedItems(){return this._hasCompletedItems()||this._singleRequest&&!this.success&&this._multipleItems}getItemForSingleRequestError(){return this._multipleItems?null:this._itemInfos[0]}getItemForMultipleRequestError(e){return this._itemInfos[e]}_setCurrentDetailError(e,t,i){this._errorState.currentDetailError={itemIndex:e,itemInfo:t,errorText:i}}_hasCompletedItems(){return this._completedItems.length>0}get actionMetadata(){return this._actionMetadata}get itemInfos(){return this._itemInfos}get itemNewName(){return this._itemNewName}set itemNewName(e){this._itemNewName=e}get errorState(){return this._errorState}get singleRequest(){return this._singleRequest}set singleRequest(e){this._singleRequest=e}get multipleItems(){return this._multipleItems}get onlyFiles(){return this._onlyFiles}get processingMessage(){return this._multipleItems?(0,$t.WU)(this._actionMetadata.multipleItemsProcessingMessage,this._items.length,this._location):(0,$t.WU)(this._actionMetadata.singleItemProcessingMessage,this._location)}get successMessage(){return this._hasCompletedItems()?this._multipleItems?(0,$t.WU)(this._actionMetadata.multipleItemsSuccessMessage,this._completedItems.length,this._location):(0,$t.WU)(this._actionMetadata.singleItemSuccessMessage,this._location):this._multipleItems?(0,$t.WU)(this._actionMetadata.multipleItemsErrorMessage,this._items.length):this._actionMetadata.singleItemErrorMessage}get completionMessage(){return this.success?this.successMessage:this.errorState.commonErrorText}get statusText(){return this.success&&!this._hasCompletedItems()?this._actionMetadata.canceledMessage:void 0}get commonProgress(){return this._commonProgress}get success(){return!this._errorState.failedCount}}const fi=class extends g.Z{_initMarkup(){super._initMarkup(),this._initActions(),this._controller=this.option("controller"),this._controller.on("EditActionStarting",this._onEditActionStarting.bind(this)),this._controller.on("EditActionResultAcquired",this._onEditActionResultAcquired.bind(this)),this._controller.on("EditActionItemError",this._onEditActionItemError.bind(this)),this._controller.on("EditActionError",this._onEditActionError.bind(this)),this._controller.on("CompleteEditActionItem",this._onCompleteEditActionItem.bind(this)),this._controller.on("CompleteEditAction",this._onCompleteEditAction.bind(this)),this._model=this.option("model"),this._uploadOperationInfoMap={},this._dialogManager=new class{constructor(e,t){this._$element=e,this._options=t;var i={onClosed:this._options.onDialogClosed,rtlEnabled:this._options.rtlEnabled},o=(0,l.Z)("<div>").appendTo(this._$element);this._chooseDirectoryDialog=new Gt(o,(0,h.l)(i,this._options.chooseDirectoryDialog));var s=(0,l.Z)("<div>").appendTo(this._$element);this._renameItemDialog=new qt(s,(0,h.l)(i,{title:u.Z.format("dxFileManager-dialogRenameItemTitle"),buttonText:u.Z.format("dxFileManager-dialogRenameItemButtonText")}));var n=(0,l.Z)("<div>").appendTo(this._$element);this._createItemDialog=new qt(n,(0,h.l)(i,{title:u.Z.format("dxFileManager-dialogCreateDirectoryTitle"),buttonText:u.Z.format("dxFileManager-dialogCreateDirectoryButtonText")}));var r=(0,l.Z)("<div>").appendTo(this._$element);this._deleteItemDialog=new jt(r,i)}getCopyDialog(e){return this._chooseDirectoryDialog.switchToCopyDialog(e),this._chooseDirectoryDialog}getMoveDialog(e){return this._chooseDirectoryDialog.switchToMoveDialog(e),this._chooseDirectoryDialog}getRenameItemDialog(){return this._renameItemDialog}getCreateItemDialog(){return this._createItemDialog}getDeleteItemDialog(){return this._deleteItemDialog}updateDialogRtl(e){[this._chooseDirectoryDialog,this._renameItemDialog,this._createItemDialog,this._deleteItemDialog].forEach(t=>{t.option("rtlEnabled",e)})}}(this.$element(),{chooseDirectoryDialog:{provider:this._controller._fileProvider,getDirectories:this._controller.getDirectories.bind(this._controller),getCurrentDirectory:this._controller.getCurrentDirectory.bind(this._controller)},rtlEnabled:this.option("rtlEnabled"),onDialogClosed:this._onDialogClosed.bind(this)}),this._fileUploader=this._createFileUploader();var e=this.option("notificationControl");e&&this._initNotificationControl(e),this._createMetadataMap()}_initNotificationControl(e){this._notificationControl=e,this._notificationControl.option({onOperationCanceled:e=>{var{info:t}=e;return this._onCancelUploadSession(t)},onOperationItemCanceled:e=>{var{item:t,itemIndex:i}=e;return this._onCancelFileUpload(t,i)}})}_getFileUploaderComponent(){return gi}_createFileUploader(){var e=(0,l.Z)("<div>").appendTo(this.$element());return this._createComponent(e,this._getFileUploaderComponent(),{getController:this._getFileUploaderController.bind(this),dropZonePlaceholderContainer:this.option("uploadDropZonePlaceholderContainer"),onUploadSessionStarted:e=>this._onUploadSessionStarted(e),onUploadProgress:e=>this._onUploadProgress(e)})}setUploaderDropZone(e){this._fileUploader.option("dropZone",e)}_getFileUploaderController(){var e=this.uploadDirectoryInfo.fileItem;return{chunkSize:this._controller.getFileUploadChunkSize(),uploadFileChunk:(t,i)=>this._controller.uploadFileChunk(t,i,e),abortFileUpload:(t,i)=>this._controller.abortFileUpload(t,i,e)}}_createMetadataMap(){this._metadataMap={create:{action:e=>this._tryCreate(e),affectsAllItems:!0,singleItemProcessingMessage:u.Z.format("dxFileManager-editingCreateSingleItemProcessingMessage"),singleItemSuccessMessage:u.Z.format("dxFileManager-editingCreateSingleItemSuccessMessage"),singleItemErrorMessage:u.Z.format("dxFileManager-editingCreateSingleItemErrorMessage"),commonErrorMessage:u.Z.format("dxFileManager-editingCreateCommonErrorMessage")},rename:{action:e=>this._tryRename(e),singleItemProcessingMessage:u.Z.format("dxFileManager-editingRenameSingleItemProcessingMessage"),singleItemSuccessMessage:u.Z.format("dxFileManager-editingRenameSingleItemSuccessMessage"),singleItemErrorMessage:u.Z.format("dxFileManager-editingRenameSingleItemErrorMessage"),commonErrorMessage:u.Z.format("dxFileManager-editingRenameCommonErrorMessage")},delete:{action:e=>this._tryDelete(e),singleItemProcessingMessage:u.Z.format("dxFileManager-editingDeleteSingleItemProcessingMessage"),multipleItemsProcessingMessage:u.Z.format("dxFileManager-editingDeleteMultipleItemsProcessingMessage"),singleItemSuccessMessage:u.Z.format("dxFileManager-editingDeleteSingleItemSuccessMessage"),multipleItemsSuccessMessage:u.Z.format("dxFileManager-editingDeleteMultipleItemsSuccessMessage"),singleItemErrorMessage:u.Z.format("dxFileManager-editingDeleteSingleItemErrorMessage"),multipleItemsErrorMessage:u.Z.format("dxFileManager-editingDeleteMultipleItemsErrorMessage"),commonErrorMessage:u.Z.format("dxFileManager-editingDeleteCommonErrorMessage")},move:{action:e=>this._tryMove(e),singleItemProcessingMessage:u.Z.format("dxFileManager-editingMoveSingleItemProcessingMessage"),multipleItemsProcessingMessage:u.Z.format("dxFileManager-editingMoveMultipleItemsProcessingMessage"),singleItemSuccessMessage:u.Z.format("dxFileManager-editingMoveSingleItemSuccessMessage"),multipleItemsSuccessMessage:u.Z.format("dxFileManager-editingMoveMultipleItemsSuccessMessage"),singleItemErrorMessage:u.Z.format("dxFileManager-editingMoveSingleItemErrorMessage"),multipleItemsErrorMessage:u.Z.format("dxFileManager-editingMoveMultipleItemsErrorMessage"),commonErrorMessage:u.Z.format("dxFileManager-editingMoveCommonErrorMessage")},copy:{action:e=>this._tryCopy(e),singleItemProcessingMessage:u.Z.format("dxFileManager-editingCopySingleItemProcessingMessage"),multipleItemsProcessingMessage:u.Z.format("dxFileManager-editingCopyMultipleItemsProcessingMessage"),singleItemSuccessMessage:u.Z.format("dxFileManager-editingCopySingleItemSuccessMessage"),multipleItemsSuccessMessage:u.Z.format("dxFileManager-editingCopyMultipleItemsSuccessMessage"),singleItemErrorMessage:u.Z.format("dxFileManager-editingCopySingleItemErrorMessage"),multipleItemsErrorMessage:u.Z.format("dxFileManager-editingCopyMultipleItemsErrorMessage"),commonErrorMessage:u.Z.format("dxFileManager-editingCopyCommonErrorMessage")},upload:{action:e=>this._tryUpload(e),allowCancel:!0,allowItemProgress:!0,singleItemProcessingMessage:u.Z.format("dxFileManager-editingUploadSingleItemProcessingMessage"),multipleItemsProcessingMessage:u.Z.format("dxFileManager-editingUploadMultipleItemsProcessingMessage"),singleItemSuccessMessage:u.Z.format("dxFileManager-editingUploadSingleItemSuccessMessage"),multipleItemsSuccessMessage:u.Z.format("dxFileManager-editingUploadMultipleItemsSuccessMessage"),singleItemErrorMessage:u.Z.format("dxFileManager-editingUploadSingleItemErrorMessage"),multipleItemsErrorMessage:u.Z.format("dxFileManager-editingUploadMultipleItemsErrorMessage"),canceledMessage:u.Z.format("dxFileManager-editingUploadCanceledMessage")},download:{action:e=>this._download(e)},getItemContent:{action:e=>this._getItemContent(e)},getItems:{singleItemProcessingMessage:"",singleItemErrorMessage:u.Z.format("dxFileManager-errorDirectoryOpenFailed"),commonErrorMessage:u.Z.format("dxFileManager-errorDirectoryOpenFailed")}}}getCommandActions(){var e={};return(0,x.S6)(this._metadataMap,t=>{Object.prototype.hasOwnProperty.call(this._metadataMap,t)&&(e[t]=e=>this._executeAction(t,e))}),e}_executeAction(e,t){var i=this._metadataMap[e];return i?i.action(t):null}_onCancelUploadSession(e){this._fileUploader.cancelUpload(e.uploadSessionId)}_onCancelFileUpload(e,t){this._fileUploader.cancelFileUpload(e.info.uploadSessionId,t)}_onUploadProgress(e){var{sessionId:t,fileIndex:i,commonValue:o,fileValue:s}=e;this._notificationControl.updateOperationItemProgress(this._uploadOperationInfoMap[t],i,100*s,100*o)}_onUploadSessionStarted(e){var{sessionInfo:t}=e;this._controller.processUploadSession(t,this.uploadDirectoryInfo)}_onEditActionStarting(e){var t=this._metadataMap[e.name],i=new _i(t,e.itemInfos,e.directory),o=this._notificationControl.addOperation(i.processingMessage,t.allowCancel,!t.allowItemProgress);switch((0,h.l)(e.customData,{context:i,operationInfo:o}),e.name){case"upload":var s=e.customData.sessionInfo.sessionId;o.uploadSessionId=s,this._uploadOperationInfoMap[s]=o;break;case"rename":e.customData.context.itemNewName=e.customData.itemNewName}}_onEditActionResultAcquired(e){var{context:t,operationInfo:i}=e.customData;t.singleRequest=e.singleRequest;var o=t.itemInfos.map(e=>this._getItemProgressDisplayInfo(e));this._notificationControl.addOperationDetails(i,o,t.actionMetadata.allowCancel)}_onEditActionError(e,t){var{context:i,operationInfo:o}=e.customData;i.singleRequest=e.singleRequest,this._handleActionError(o,i,t),this._completeAction(o,i)}_onEditActionItemError(e,t){var{context:i,operationInfo:o}=e.customData;this._handleActionError(o,i,t)}_onCompleteEditActionItem(e,t){var{context:i,operationInfo:o}=e.customData;t.result&&t.result.canceled||(i.completeOperationItem(t.index),this._notificationControl.completeOperationItem(o,t.index,i.commonProgress))}_onCompleteEditAction(e){var{context:t,operationInfo:i}=e.customData;this._completeAction(i,t),"upload"===e.name&&delete this._uploadOperationInfoMap[e.customData.sessionInfo.sessionId]}_tryCreate(e){var t=e&&e[0]||this._getCurrentDirectory(),i=u.Z.format("dxFileManager-newDirectoryName");return this._showDialog(this._dialogManager.getCreateItemDialog(),i).then(e=>{var{name:i}=e;return this._controller.createDirectory(t,i)})}_tryRename(e){var t=e&&e[0]||this._model.getMultipleSelectedItems()[0];return t?this._showDialog(this._dialogManager.getRenameItemDialog(),t.fileItem.name).then(e=>{var{name:i}=e;return this._controller.renameItem(t,i)}):(new c.BH).reject().promise()}_tryDelete(e){if(0===(e=e||this._model.getMultipleSelectedItems()).length)return(new c.BH).reject().promise();var t=e[0].fileItem.name,i=e.length;return this._showDialog(this._dialogManager.getDeleteItemDialog(),{itemName:t,itemCount:i}).then(()=>this._controller.deleteItems(e))}_tryMove(e){return 0===(e=e||this._model.getMultipleSelectedItems()).length?(new c.BH).reject().promise():this._showDialog(this._dialogManager.getMoveDialog(e)).then(t=>{var{folder:i}=t;return this._controller.moveItems(e,i)})}_tryCopy(e){return 0===(e=e||this._model.getMultipleSelectedItems()).length?(new c.BH).reject().promise():this._showDialog(this._dialogManager.getCopyDialog(e)).then(t=>{var{folder:i}=t;return this._controller.copyItems(e,i)})}_tryUpload(e){this._uploadDirectoryInfo=null==e?void 0:e[0],this._fileUploader.tryUpload()}_download(e){return 0===(e=e||this._model.getMultipleSelectedItems()).length?(new c.BH).reject().promise():this._controller.downloadItems(e)}_getItemContent(e){return e=e||this._model.getMultipleSelectedItems(),this._controller.getItemContent(e)}_completeAction(e,t){this._notificationControl.completeOperation(e,t.completionMessage,!t.success,t.statusText),t.hasModifiedItems()&&this._raiseOnSuccess(t.onlyFiles)}_handleActionError(e,t,i){e.hasError=!0,t.singleRequest?this._handleSingleRequestActionError(e,t,i):this._handleMultipleRequestActionError(e,t,i)}_handleSingleRequestActionError(e,t,i){var o=t.getItemForSingleRequestError(),s=this._getErrorText(i,o,t.itemNewName);t.processSingleRequestError(s);var n=this._getOperationErrorInfo(t);this._notificationControl.completeSingleOperationWithError(e,n),t.multipleItems&&this._raiseOnSuccess(t.onlyFiles)}_handleMultipleRequestActionError(e,t,i){var o=t.getItemForMultipleRequestError(i.index),s=this._getErrorText(i,o);t.processMultipleRequestError(i.index,s);var n=this._getOperationErrorInfo(t);this._notificationControl.addOperationDetailsError(e,n)}_getOperationErrorInfo(e){var t=e.errorState.currentDetailError;return{commonErrorText:e.errorState.commonErrorText,item:t.itemInfo?this._getItemProgressDisplayInfo(t.itemInfo):null,itemIndex:t.itemIndex,detailErrorText:t.errorText}}_getErrorText(e,t,i){i=i||(null==t?void 0:t.fileItem.name);var o=e.errorText||((e,t)=>{switch(e){case 0:return u.Z.format("dxFileManager-errorNoAccess");case 1:return u.Z.format("dxFileManager-errorFileExistsFormat",t);case 2:return u.Z.format("dxFileManager-errorFileNotFoundFormat",t);case 3:return u.Z.format("dxFileManager-errorDirectoryExistsFormat",t);case 4:return u.Z.format("dxFileManager-errorDirectoryNotFoundFormat",t);case 5:return u.Z.format("dxFileManager-errorWrongFileExtension");case 6:return u.Z.format("dxFileManager-errorMaxFileSizeExceeded");case 7:return u.Z.format("dxFileManager-errorInvalidSymbols")}return u.Z.format("dxFileManager-errorDefault")})(e.errorCode,i),s={fileSystemItem:null==t?void 0:t.fileItem,errorCode:e.errorCode,errorText:o};return this._raiseOnError(s),s.errorText}_getItemProgressDisplayInfo(e){return{commonText:e.fileItem.name,imageUrl:this._getItemThumbnail(e)}}_showDialog(e,t){return this._dialogDeferred=new c.BH,e.show(t),this._dialogDeferred.promise()}_onDialogClosed(e){var t=e.dialogResult;t?this._dialogDeferred.resolve(t):this._dialogDeferred.reject()}updateDialogRtl(e){this._dialogManager.updateDialogRtl(e)}_getItemThumbnail(e){var t=this.option("getItemThumbnail");if(!t)return null;var i=t(e);return i?i.thumbnail:null}_initActions(){this._actions={onSuccess:this._createActionByOption("onSuccess"),onError:this._createActionByOption("onError")}}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{model:{getMultipleSelectedItems:null},notificationControl:null,getItemThumbnail:null,onSuccess:null,onError:null})}_optionChanged(e){var t=e.name;switch(t){case"model":this.repaint();break;case"notificationControl":this._initNotificationControl(e.value);break;case"getItemThumbnail":break;case"uploadDropZonePlaceholderContainer":this._fileUploader.option("dropZonePlaceholderContainer",e.value);break;case"onSuccess":case"onError":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}_raiseOnSuccess(e){this._actions.onSuccess({updatedOnlyFiles:e})}_raiseOnError(e){this._actions.onError(e)}_getCurrentDirectory(){return this._controller.getCurrentDirectory()}get uploadDirectoryInfo(){return this._uploadDirectoryInfo||this._getCurrentDirectory()}};var Ci=i(48690);const bi=class extends g.Z{_init(){super._init(),this._currentDirectory=null}_initMarkup(){super._initMarkup(),this._initActions(),this._currentDirectory&&this._renderMenu(),this.$element().addClass("dx-filemanager-breadcrumbs")}setCurrentDirectory(e){this._areDirsEqual(this._currentDirectory,e)||(this._currentDirectory=e,this.repaint())}_renderMenu(){var e=(0,l.Z)("<div>").appendTo(this.$element());this._menu=this._createComponent(e,Ci.Z,{dataSource:this._getMenuItems(),onItemClick:this._onItemClick.bind(this),onItemRendered:this._onItemRendered.bind(this)})}_getMenuItems(){var e=this._getParentDirsLine(),t=[{icon:"arrowup",directory:this._currentDirectory.parentDirectory,isPathItem:!0,cssClass:"dx-filemanager-breadcrumbs-parent-folder-item"},{text:"\xa0",cssClass:"dx-filemanager-breadcrumbs-separator-item"}];return e.forEach((i,o)=>{t.push({text:i.getDisplayName(),directory:i,isPathItem:!0}),o!==e.length-1&&t.push({icon:"spinnext",cssClass:"dx-filemanager-breadcrumbs-path-separator-item"})}),t}_onItemClick(e){var{itemData:t}=e;if(t.isPathItem){var i=t.directory;this._areDirsEqual(i,this._currentDirectory)||this._raiseCurrentDirectoryChanged(i)}}_onItemRendered(e){var{itemElement:t,itemData:i}=e;i.cssClass&&(0,l.Z)(t).addClass(i.cssClass)}_getParentDirsLine(){for(var e=this._currentDirectory,t=[];e;)t.unshift(e),e=e.parentDirectory;return t}_areDirsEqual(e,t){return e&&t&&e===t&&e.fileItem.key===t.fileItem.key}_initActions(){this._actions={onCurrentDirectoryChanging:this._createActionByOption("onCurrentDirectoryChanging")}}_raiseCurrentDirectoryChanged(e){this._actions.onCurrentDirectoryChanging({currentDirectory:e})}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{rootFolderDisplayName:"Files",onCurrentDirectoryChanging:null})}_optionChanged(e){var t=e.name;switch(t){case"rootFolderDisplayName":this.repaint();break;case"onCurrentDirectoryChanging":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}};var Ii=i(90670),vi=i(3571),yi=(0,B.Jj)(),xi="dx-splitter",Si="".concat(xi,"-wrapper"),Di="".concat(xi,"-inactive"),wi="".concat(xi,"-border"),Mi="".concat(xi,"-initial"),Ti="dx-state-disabled",Oi="dxSplitterResizing",Pi=(0,ue.V4)(vi.Z.down,Oi),Fi=(0,ue.V4)(vi.Z.move,Oi),Ei=(0,ue.V4)(vi.Z.up,Oi);class Ai extends g.Z{_initMarkup(){super._initMarkup(),this._initActions(),this._$container=this.option("container"),this._$leftElement=this.option("leftElement"),this._$rightElement=this.option("rightElement"),this.$element().addClass(Si).addClass(Mi),this._$splitterBorder=(0,l.Z)("<div>").addClass(wi).appendTo(this.$element()),this._$splitter=(0,l.Z)("<div>").addClass(xi).addClass(Di).appendTo(this._$splitterBorder)}_initActions(){this._actions={onApplyPanelSize:this._createActionByOption("onApplyPanelSize"),onActiveStateChanged:this._createActionByOption("onActiveStateChanged")}}_render(){super._render(),this._detachEventHandlers(),this._attachEventHandlers()}_clean(){this._detachEventHandlers(),super._clean()}_attachEventHandlers(){var e=Ii.Z.getDocument();H.Z.on(this._$splitterBorder,Pi,this._onMouseDownHandler.bind(this)),H.Z.on(e,Fi,this._onMouseMoveHandler.bind(this)),H.Z.on(e,Ei,this._onMouseUpHandler.bind(this))}_detachEventHandlers(){var e=Ii.Z.getDocument();H.Z.off(this._$splitterBorder,Pi),H.Z.off(e,Fi),H.Z.off(e,Ei)}_dimensionChanged(e){e&&"height"===e||(this._containerWidth=this._$container.get(0).clientWidth,this._setSplitterPositionLeft({needUpdatePanels:!0,usePercentagePanelsWidth:!0}))}_onMouseDownHandler(e){e.preventDefault(),this._offsetX=e.pageX-this._$splitterBorder.offset().left<=this._getSplitterBorderWidth()?e.pageX-this._$splitterBorder.offset().left:0,this._containerWidth=this._$container.get(0).clientWidth,this.$element().removeClass(Mi),this._toggleActive(!0),this._setSplitterPositionLeft({needUpdatePanels:!0})}_onMouseMoveHandler(e){this._isSplitterActive&&this._setSplitterPositionLeft({splitterPositionLeft:this._getNewSplitterPositionLeft(e),needUpdatePanels:!0})}_onMouseUpHandler(){this._isSplitterActive&&(this._leftPanelPercentageWidth=null,this._toggleActive(!1),this._setSplitterPositionLeft({needUpdatePanels:!0,usePercentagePanelsWidth:!0}))}_getNewSplitterPositionLeft(e){var t=e.pageX-this._getContainerLeftOffset()-this._offsetX;return t=Math.max(0-this._getSplitterOffset(),t),Math.min(this._containerWidth-this._getSplitterOffset()-this._getSplitterWidth(),t)}_getContainerLeftOffset(){var e=this._$container.offset().left;if(yi){var t=yi.getComputedStyle(this._$container.get(0));e+=(parseFloat(t.paddingLeft)||0)+(parseFloat(t.borderLeftWidth)||0)}return e}_getSplitterOffset(){return(this._getSplitterBorderWidth()-this._getSplitterWidth())/2}_getSplitterWidth(){return this._$splitter.get(0).clientWidth}_getSplitterBorderWidth(){return this._$splitterBorder.get(0).clientWidth}_getLeftPanelWidth(){return this._$leftElement.get(0).clientWidth}_toggleActive(e){this.$element().toggleClass(Di,!e),this._$splitter.toggleClass(Di,!e),this._isSplitterActive=e,this._actions.onActiveStateChanged({isActive:e})}toggleDisabled(e){this.$element().toggleClass(Ti,e),this._$splitter.toggleClass(Ti,e)}isSplitterMoved(){return!this.$element().hasClass(Mi)}disableSplitterCalculation(e){this._isSplitterCalculationDisabled=e}_setSplitterPositionLeft(){var{splitterPositionLeft:e=null,needUpdatePanels:t=!1,usePercentagePanelsWidth:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(e=e||this._getLeftPanelWidth()-this._getSplitterOffset())+this._getSplitterOffset(),s=this._containerWidth-o;this._isSplitterCalculationDisabled||this.$element().css("left",e),this._leftPanelPercentageWidth=this._leftPanelPercentageWidth||this._convertToPercentage(o);var n=this._convertToPercentage(this._containerWidth-this._convertToPixels(this._leftPanelPercentageWidth));t&&this._actions.onApplyPanelSize({leftPanelWidth:i?"".concat(this._leftPanelPercentageWidth,"%"):o,rightPanelWidth:i?"".concat(n,"%"):s})}_optionChanged(e){switch(e.name){case"initialLeftPanelWidth":this._leftPanelPercentageWidth=this._convertToPercentage(e.value),this._dimensionChanged();break;case"leftElement":this.repaint();break;case"onActiveStateChanged":case"onApplyPanelSize":this._actions[e.name]=this._createActionByOption(e.name);break;default:super._optionChanged(e)}}_convertToPercentage(e){return e/this._$container.get(0).clientWidth*100}_convertToPixels(e){return e/100*this._$container.get(0).clientWidth}}var ki=(0,B.Jj)(),Zi="dx-filemanager-adaptivity-drawer-panel",Bi="dx-drawer-panel-content-initial";const Ui=class extends g.Z{_initMarkup(){super._initMarkup(),this._initActions(),this._isInAdaptiveState=!1;var e=(0,l.Z)("<div>").appendTo(this.$element());(0,l.Z)("<div>").addClass(Zi).appendTo(e),this._drawer=this._createComponent(e,Ye.Z),this._drawer.option({opened:!0,template:this._createDrawerTemplate.bind(this)}),(0,l.Z)(this._drawer.content()).addClass(Bi);var t=e.find(".".concat(Zi)).first(),i=this.option("contentTemplate");(0,d.mf)(i)&&i(t),this._updateDrawerMaxSize()}_createDrawerTemplate(e){this.option("drawerTemplate")(e),this._splitter=this._createComponent("<div>",Ai,{container:this.$element(),leftElement:(0,l.Z)(this._drawer.content()),rightElement:(0,l.Z)(this._drawer.viewContent()),onApplyPanelSize:this._onApplyPanelSize.bind(this),onActiveStateChanged:this._onActiveStateChanged.bind(this)}),this._splitter.$element().appendTo(e),this._splitter.disableSplitterCalculation(!0)}_render(){super._render(),this._checkAdaptiveState()}_onApplyPanelSize(e){(0,B.Ym)()&&(this._splitter.isSplitterMoved()?((0,l.Z)(this._drawer.content()).removeClass(Bi),this._setDrawerWidth(e.leftPanelWidth)):this._setDrawerWidth(""))}_onActiveStateChanged(e){var{isActive:t}=e;this._splitter.disableSplitterCalculation(!t),!t&&this._splitter.$element().css("left","auto")}_setDrawerWidth(e){(0,l.Z)(this._drawer.content()).css("width",e),this._updateDrawerMaxSize(),this._drawer.resizeViewContent()}_updateDrawerMaxSize(){this._drawer.option("maxSize",this._drawer.getRealPanelWidth())}_dimensionChanged(e){e&&"height"===e||this._checkAdaptiveState()}_checkAdaptiveState(){var e=this._isInAdaptiveState;this._isInAdaptiveState=this._isSmallScreen(),e!==this._isInAdaptiveState&&(this.toggleDrawer(!this._isInAdaptiveState,!0),(0,l.Z)(this._drawer.content()).toggleClass("dx-drawer-panel-content-adaptive",this._isInAdaptiveState),this._raiseAdaptiveStateChanged(this._isInAdaptiveState)),this._isInAdaptiveState&&this._isDrawerOpened()&&this._updateDrawerMaxSize()}_isSmallScreen(){return(0,l.Z)(ki).width()<=573}_isDrawerOpened(){return this._drawer.option("opened")}_initActions(){this._actions={onAdaptiveStateChanged:this._createActionByOption("onAdaptiveStateChanged")}}_raiseAdaptiveStateChanged(e){this._actions.onAdaptiveStateChanged({enabled:e})}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{drawerTemplate:null,contentTemplate:null,onAdaptiveStateChanged:null})}_optionChanged(e){var t=e.name;switch(t){case"drawerTemplate":case"contentTemplate":this.repaint();break;case"onAdaptiveStateChanged":this._actions[t]=this._createActionByOption(t);break;default:super._optionChanged(e)}}isInAdaptiveState(){return this._isInAdaptiveState}toggleDrawer(e,t){this._updateDrawerMaxSize(),this._drawer.option("animationEnabled",!t),this._drawer.toggle(e);var i=this._isDrawerOpened()&&!this.isInAdaptiveState();this._splitter.toggleDisabled(!i)}};var Vi="dx-filemanager-container",Ki="itemView";class Li extends g.Z{_initTemplates(){}_init(){super._init(),this._controller=new Y({currentPath:this.option("currentPath"),currentPathKeys:this.option("currentPathKeys"),rootText:this.option("rootFolderName"),fileProvider:this.option("fileSystemProvider"),allowedFileExtensions:this.option("allowedFileExtensions"),uploadMaxFileSize:this.option("upload").maxFileSize,uploadChunkSize:this.option("upload").chunkSize,onInitialized:this._onControllerInitialized.bind(this),onDataLoading:this._onDataLoading.bind(this),onSelectedDirectoryChanged:this._onSelectedDirectoryChanged.bind(this)})}_initMarkup(){super._initMarkup(),this._initActions(),this._firstItemViewLoad=!0,this._lockSelectionProcessing=!1,this._lockFocusedItemProcessing=!1,this._itemKeyToFocus=void 0,this._commandManager=new ee(this.option("permissions")),this.$element().addClass("dx-filemanager"),this._createNotificationControl(),this._initCommandManager()}_createNotificationControl(){var e=(0,l.Z)("<div>").addClass("dx-filemanager-notification-container").appendTo(this.$element());this._notificationControl=this._createComponent(e,zt,{progressPanelContainer:this.$element(),contentTemplate:(e,t)=>this._createWrapper(e,t),onActionProgress:e=>this._onActionProgress(e),positionTarget:".".concat(Vi),showProgressPanel:this.option("notifications.showPanel"),showNotificationPopup:this.option("notifications.showPopup")})}_createWrapper(e,t){this._$wrapper=(0,l.Z)("<div>").addClass("dx-filemanager-wrapper").appendTo(e),this._createEditing(t);var i=(0,l.Z)("<div>").appendTo(this._$wrapper);this._toolbar=this._createComponent(i,We,{commandManager:this._commandManager,generalItems:this.option("toolbar.items"),fileItems:this.option("toolbar.fileSelectionItems"),itemViewMode:this.option("itemView").mode,onItemClick:e=>this._actions.onToolbarItemClick(e)}),this._createAdaptivityControl()}_createAdaptivityControl(){var e=(0,l.Z)("<div>").addClass(Vi).appendTo(this._$wrapper);this._adaptivityControl=this._createComponent(e,Ui,{drawerTemplate:e=>this._createFilesTreeView(e),contentTemplate:e=>this._createItemsPanel(e),onAdaptiveStateChanged:e=>this._onAdaptiveStateChanged(e)})}_createEditing(e){var t=(0,l.Z)("<div>").addClass("dx-filemanager-editing-container").appendTo(this.$element());this._editing=this._createComponent(t,fi,{controller:this._controller,model:{getMultipleSelectedItems:this._getSelectedItemInfos.bind(this)},getItemThumbnail:this._getItemThumbnailInfo.bind(this),notificationControl:e,uploadDropZonePlaceholderContainer:this.$element(),rtlEnabled:this.option("rtlEnabled"),onSuccess:e=>{var{updatedOnlyFiles:t}=e;return this._redrawComponent(t)},onError:e=>this._onEditingError(e)})}_createItemsPanel(e){this._$itemsPanel=(0,l.Z)("<div>").addClass("dx-filemanager-items-panel").appendTo(e),this._createBreadcrumbs(this._$itemsPanel),this._createItemView(this._$itemsPanel),this._commandManager.isCommandAvailable("upload")&&this._editing.setUploaderDropZone(this._$itemsPanel)}_createFilesTreeView(e){this._filesTreeViewContextMenu=this._createContextMenu(!1,"navPane");var t=(0,l.Z)("<div>").addClass("dx-filemanager-dirs-panel").appendTo(e);this._filesTreeView=this._createComponent(t,de,{storeExpandedState:!0,contextMenu:this._filesTreeViewContextMenu,getDirectories:this.getDirectories.bind(this),getCurrentDirectory:this._getCurrentDirectory.bind(this),onDirectoryClick:e=>{var{itemData:t}=e;return this._setCurrentDirectory(t)}}),this._filesTreeView.updateCurrentDirectory()}_createItemView(e,t){this._itemViewContextMenu=this._createContextMenu(!0,Ki);var i=this.option("itemView"),o={selectionMode:this.option("selectionMode"),selectedItemKeys:this.option("selectedItemKeys"),focusedItemKey:this.option("focusedItemKey"),contextMenu:this._itemViewContextMenu,getItems:this._getItemViewItems.bind(this),onError:e=>{var{error:t}=e;return this._showError(t)},onSelectionChanged:this._onItemViewSelectionChanged.bind(this),onFocusedItemChanged:this._onItemViewFocusedItemChanged.bind(this),onSelectedItemOpened:this._onSelectedItemOpened.bind(this),onContextMenuShowing:e=>this._onContextMenuShowing(Ki,e),getItemThumbnail:this._getItemThumbnailInfo.bind(this),customizeDetailColumns:this.option("customizeDetailColumns"),detailColumns:this.option("itemView.details.columns")},s=(0,l.Z)("<div>").appendTo(e);this._itemView=this._createComponent(s,"thumbnails"===(t=t||i.mode)?Te:Ce,o)}_createBreadcrumbs(e){var t=(0,l.Z)("<div>").appendTo(e);this._breadcrumbs=this._createComponent(t,bi,{rootFolderDisplayName:this.option("rootFolderName"),onCurrentDirectoryChanging:e=>{var{currentDirectory:t}=e;return this._setCurrentDirectory(t,!0)}}),this._breadcrumbs.setCurrentDirectory(this._getCurrentDirectory())}_createContextMenu(e,t){var i=(0,l.Z)("<div>").appendTo(this._$wrapper);return this._createComponent(i,se,{commandManager:this._commandManager,items:this.option("contextMenu.items"),onItemClick:e=>this._actions.onContextMenuItemClick(e),onContextMenuShowing:e=>this._onContextMenuShowing(t,e),isolateCreationItemCommands:e,viewArea:t})}_initCommandManager(){var e=(0,h.l)(this._editing.getCommandActions(),{refresh:()=>this._refreshAndShowProgress(),thumbnails:()=>this.option("itemView.mode","thumbnails"),details:()=>this.option("itemView.mode","details"),clearSelection:()=>this._clearSelection(),showNavPane:()=>this._adaptivityControl.toggleDrawer()});this._commandManager.registerActions(e)}_onItemViewSelectionChanged(e){var{selectedItemInfos:t,selectedItems:i,selectedItemKeys:o,currentSelectedItemKeys:s,currentDeselectedItemKeys:n}=e;this._lockSelectionProcessing=!0,this.option("selectedItemKeys",o),this._lockSelectionProcessing=!1,this._actions.onSelectionChanged({selectedItems:i,selectedItemKeys:o,currentSelectedItemKeys:s,currentDeselectedItemKeys:n}),this._updateToolbar(t)}_onItemViewFocusedItemChanged(e){this._lockFocusedItemProcessing=!0,this.option("focusedItemKey",e.itemKey),this._lockFocusedItemProcessing=!1,this._actions.onFocusedItemChanged({item:e.item,itemElement:e.itemElement})}_onAdaptiveStateChanged(e){var{enabled:t}=e;this._commandManager.setCommandEnabled("showNavPane",t),this._updateToolbar()}_onActionProgress(e){var{message:t,status:i}=e;this._toolbar.updateRefreshItem(t,i),this._updateToolbar()}_onEditingError(e){var t=b({},e,["errorCode","errorText","fileSystemItem"]);this._actions.onErrorOccurred(t),e.errorText=t.errorText}_refreshAndShowProgress(){return(0,c.gx)(this._notificationControl.tryShowProgressPanel(),this._controller.refresh()).then(()=>this._filesTreeView.refresh())}_updateToolbar(e){var t=e||this._getSelectedItemInfos();this._toolbar.update(t)}_switchView(e){this._disposeWidget(this._itemView.option("contextMenu")),this._disposeWidget(this._itemView),this._createItemView(this._$itemsPanel,e),this._toolbar.option({itemViewMode:e})}_disposeWidget(e){e.dispose(),e.$element().remove()}_clearSelection(){this._itemView.clearSelection()}_showError(e){this._showNotification(e,!1)}_showNotification(e,t){(0,_.Z)({message:e,width:450},t?"success":"error",5e3)}_redrawComponent(e){this._itemView.refresh().then(()=>!e&&this._filesTreeView.refresh())}_getItemViewItems(){var e=this.option("itemView").showFolders,t=this._controller.getCurrentItems(!e);return this._updateToolbarWithSelectionOnFirstLoad(t),this.option("itemView.showParentFolder")&&(t=(0,c.gx)(t).then(e=>this._getPreparedItemViewItems(e))),t}_updateToolbarWithSelectionOnFirstLoad(e){if(this._firstItemViewLoad){this._firstItemViewLoad=!1;var t=this.option("selectedItemKeys");t.length>0&&(0,c.gx)(e).done(e=>{var i=((e,t)=>{var i={};t.forEach(e=>{i[e]=null}),e.forEach(e=>{var t=e.fileItem.key;Object.prototype.hasOwnProperty.call(i,t)&&(i[t]=e)});var o=[];return t.forEach(e=>{var t=i[e];t&&o.push(t)}),o})(e,t);i.length>0&&this._updateToolbar(i)})}}_getPreparedItemViewItems(e){var t=this._getCurrentDirectory();if(t.fileItem.isRoot())return e;var i=t.fileItem.createClone();i.isParentFolder=!0,i.name="..",i.relativeName="..",i.key="".concat("[*DXPDK*]$40F96F03-FBD8-43DF-91BE-F55F4B8BA871$").concat(t.fileItem.key);var o=[...e];return o.unshift({fileItem:i,icon:"parentfolder"}),o}_onContextMenuShowing(e,t){var i,o=b({},t,["targetElement","cancel","event"]);o=(0,h.l)(o,{viewArea:e,fileSystemItem:null===(i=t.itemData)||void 0===i?void 0:i.fileItem,_isActionButton:t.isActionButton}),this._actions.onContextMenuShowing(o),t.cancel=(0,p.IS)(o.cancel,!1)}_getItemThumbnailInfo(e){var t=this.option("customizeThumbnail"),i=(0,d.mf)(t)?t(e.fileItem):e.fileItem.thumbnail;return i?{thumbnail:i,cssClass:"dx-filemanager-item-custom-thumbnail"}:{thumbnail:e.icon}}_getDefaultOptions(){return(0,h.l)(super._getDefaultOptions(),{fileSystemProvider:null,currentPath:"",currentPathKeys:[],rootFolderName:u.Z.format("dxFileManager-rootDirectoryName"),selectionMode:"multiple",selectedItemKeys:[],focusedItemKey:void 0,toolbar:{items:["showNavPane","create","upload","switchView",{name:"separator",location:"after"},"refresh"],fileSelectionItems:["download","separator","move","copy","rename","separator","delete","clearSelection",{name:"separator",location:"after"},"refresh"]},contextMenu:{items:["create","upload","rename","move","copy","delete","refresh","download"]},itemView:{details:{columns:["thumbnail","name","dateModified","size"]},mode:"details",showFolders:!0,showParentFolder:!0},customizeThumbnail:null,customizeDetailColumns:null,onContextMenuItemClick:null,onContextMenuShowing:null,onCurrentDirectoryChanged:null,onSelectedFileOpened:null,onSelectionChanged:null,onFocusedItemChanged:null,onToolbarItemClick:null,onErrorOccurred:null,allowedFileExtensions:[],upload:{maxFileSize:0,chunkSize:2e5},permissions:{create:!1,copy:!1,move:!1,delete:!1,rename:!1,upload:!1,download:!1},notifications:{showPanel:!0,showPopup:!0}})}_optionChanged(e){var t=e.name;switch(t){case"currentPath":this._controller.setCurrentPath(e.value);break;case"currentPathKeys":this._controller.setCurrentPathByKeys(e.value);break;case"selectedItemKeys":!this._lockSelectionProcessing&&this._itemView&&this._itemView.option("selectedItemKeys",e.value);break;case"focusedItemKey":!this._lockFocusedItemProcessing&&this._itemView&&this._itemView.option("focusedItemKey",e.value);break;case"rootFolderName":this._controller.setRootText(e.value),this.repaint();break;case"fileSystemProvider":this._controller.updateProvider(e.value,this.option("currentPath")).then(()=>this.repaint());break;case"allowedFileExtensions":this._controller.setAllowedFileExtensions(e.value),this.repaint();break;case"upload":this._controller.setUploadOptions(this.option("upload")),this.repaint();break;case"permissions":case"selectionMode":case"customizeThumbnail":case"customizeDetailColumns":this.repaint();break;case"itemView":"itemView.mode"===e.fullName?this._switchView(e.value):this.repaint();break;case"toolbar":var i={};"toolbar"===e.fullName&&(e.value.items&&(i.generalItems=e.value.items),e.value.fileSelectionItems&&(i.fileItems=e.value.fileSelectionItems)),0===e.fullName.indexOf("toolbar.items")&&(i.generalItems=this.option("toolbar.items")),0===e.fullName.indexOf("toolbar.fileSelectionItems")&&(i.fileItems=this.option("toolbar.fileSelectionItems")),this._toolbar.option(i);break;case"contextMenu":if("contextMenu"===e.fullName&&e.value.items||0===e.fullName.indexOf("contextMenu.items")){var o=this.option("contextMenu.items");this._filesTreeViewContextMenu.option("items",o),this._itemViewContextMenu.option("items",o)}break;case"notifications":this._notificationControl.option("showProgressPanel",this.option("notifications.showPanel")),this._notificationControl.option("showNotificationPopup",this.option("notifications.showPopup"));break;case"onContextMenuItemClick":case"onContextMenuShowing":case"onCurrentDirectoryChanged":case"onSelectedFileOpened":case"onSelectionChanged":case"onFocusedItemChanged":case"onToolbarItemClick":case"onErrorOccurred":this._actions[t]=this._createActionByOption(t);break;case"rtlEnabled":this._editing.updateDialogRtl(e.value),super._optionChanged(e);break;default:super._optionChanged(e)}}_initActions(){this._actions={onContextMenuItemClick:this._createActionByOption("onContextMenuItemClick"),onContextMenuShowing:this._createActionByOption("onContextMenuShowing"),onCurrentDirectoryChanged:this._createActionByOption("onCurrentDirectoryChanged"),onSelectedFileOpened:this._createActionByOption("onSelectedFileOpened"),onSelectionChanged:this._createActionByOption("onSelectionChanged"),onFocusedItemChanged:this._createActionByOption("onFocusedItemChanged"),onToolbarItemClick:this._createActionByOption("onToolbarItemClick"),onErrorOccurred:this._createActionByOption("onErrorOccurred")}}executeCommand(e){return this._commandManager.executeCommand(e)}_setCurrentDirectory(e,t){this._controller.setCurrentDirectory(e,t)}_getCurrentDirectory(){return this._controller.getCurrentDirectory()}_onControllerInitialized(e){var{controller:t}=e;this._controller=this._controller||t,t.getCurrentDirectory().fileItem.isRoot()||this._syncToCurrentDirectory()}_onDataLoading(e){var{operation:t}=e,i=null;"navigation"===t&&(i={focusedItemKey:this._itemKeyToFocus},this._itemKeyToFocus=void 0),this._itemView.refresh(i)}_onSelectedDirectoryChanged(){var e=this._getCurrentDirectory();this._syncToCurrentDirectory(),this._actions.onCurrentDirectoryChanged({directory:e.fileItem})}_syncToCurrentDirectory(){var e=this._getCurrentDirectory(),t=this._controller.getCurrentPath(),i=e.fileItem.pathKeys;this._filesTreeView&&this._filesTreeView.updateCurrentDirectory(),this._breadcrumbs&&this._breadcrumbs.setCurrentDirectory(e);var o={currentPath:t};(0,p.bY)(this.option("currentPathKeys"),i)||(o.currentPathKeys=i),this.option(o)}getDirectories(e,t){return this._controller.getDirectories(e,t)}_getSelectedItemInfos(){return this._itemView?this._itemView.getSelectedItems():[]}refresh(){return this.executeCommand("refresh")}getCurrentDirectory(){var e=this._getCurrentDirectory();return e&&e.fileItem||null}getSelectedItems(){return this._getSelectedItemInfos().map(e=>e.fileItem)}_onSelectedItemOpened(e){var{fileItemInfo:t}=e,i=t.fileItem;if(i.isDirectory){i.isParentFolder&&(this._itemKeyToFocus=this._getCurrentDirectory().fileItem.key);var o=i.isParentFolder?this._getCurrentDirectory().parentDirectory:t;this._setCurrentDirectory(o),o&&this._filesTreeView.toggleDirectoryExpandedState(o.parentDirectory,!0)}else this._actions.onSelectedFileOpened({file:i})}}(0,m.Z)("dxFileManager",Li);const Ri=Li;var zi=i(86101),$i=i(52177);let Ni=(()=>{let e=class extends zi.Ay{constructor(e,t,i,o,s,n,r,a){super(e,t,i,o,r,a),this._watcherHelper=o,this._idh=s,this._createEventEmitters([{subscribe:"contentReady",emit:"onContentReady"},{subscribe:"contextMenuItemClick",emit:"onContextMenuItemClick"},{subscribe:"contextMenuShowing",emit:"onContextMenuShowing"},{subscribe:"currentDirectoryChanged",emit:"onCurrentDirectoryChanged"},{subscribe:"disposing",emit:"onDisposing"},{subscribe:"errorOccurred",emit:"onErrorOccurred"},{subscribe:"focusedItemChanged",emit:"onFocusedItemChanged"},{subscribe:"initialized",emit:"onInitialized"},{subscribe:"optionChanged",emit:"onOptionChanged"},{subscribe:"selectedFileOpened",emit:"onSelectedFileOpened"},{subscribe:"selectionChanged",emit:"onSelectionChanged"},{subscribe:"toolbarItemClick",emit:"onToolbarItemClick"},{emit:"accessKeyChange"},{emit:"activeStateEnabledChange"},{emit:"allowedFileExtensionsChange"},{emit:"contextMenuChange"},{emit:"currentPathChange"},{emit:"currentPathKeysChange"},{emit:"customizeDetailColumnsChange"},{emit:"customizeThumbnailChange"},{emit:"disabledChange"},{emit:"elementAttrChange"},{emit:"fileSystemProviderChange"},{emit:"focusedItemKeyChange"},{emit:"focusStateEnabledChange"},{emit:"heightChange"},{emit:"hintChange"},{emit:"hoverStateEnabledChange"},{emit:"itemViewChange"},{emit:"notificationsChange"},{emit:"permissionsChange"},{emit:"rootFolderNameChange"},{emit:"rtlEnabledChange"},{emit:"selectedItemKeysChange"},{emit:"selectionModeChange"},{emit:"tabIndexChange"},{emit:"toolbarChange"},{emit:"uploadChange"},{emit:"visibleChange"},{emit:"widthChange"}]),this._idh.setHost(this),n.setHost(this)}get accessKey(){return this._getOption("accessKey")}set accessKey(e){this._setOption("accessKey",e)}get activeStateEnabled(){return this._getOption("activeStateEnabled")}set activeStateEnabled(e){this._setOption("activeStateEnabled",e)}get allowedFileExtensions(){return this._getOption("allowedFileExtensions")}set allowedFileExtensions(e){this._setOption("allowedFileExtensions",e)}get contextMenu(){return this._getOption("contextMenu")}set contextMenu(e){this._setOption("contextMenu",e)}get currentPath(){return this._getOption("currentPath")}set currentPath(e){this._setOption("currentPath",e)}get currentPathKeys(){return this._getOption("currentPathKeys")}set currentPathKeys(e){this._setOption("currentPathKeys",e)}get customizeDetailColumns(){return this._getOption("customizeDetailColumns")}set customizeDetailColumns(e){this._setOption("customizeDetailColumns",e)}get customizeThumbnail(){return this._getOption("customizeThumbnail")}set customizeThumbnail(e){this._setOption("customizeThumbnail",e)}get disabled(){return this._getOption("disabled")}set disabled(e){this._setOption("disabled",e)}get elementAttr(){return this._getOption("elementAttr")}set elementAttr(e){this._setOption("elementAttr",e)}get fileSystemProvider(){return this._getOption("fileSystemProvider")}set fileSystemProvider(e){this._setOption("fileSystemProvider",e)}get focusedItemKey(){return this._getOption("focusedItemKey")}set focusedItemKey(e){this._setOption("focusedItemKey",e)}get focusStateEnabled(){return this._getOption("focusStateEnabled")}set focusStateEnabled(e){this._setOption("focusStateEnabled",e)}get height(){return this._getOption("height")}set height(e){this._setOption("height",e)}get hint(){return this._getOption("hint")}set hint(e){this._setOption("hint",e)}get hoverStateEnabled(){return this._getOption("hoverStateEnabled")}set hoverStateEnabled(e){this._setOption("hoverStateEnabled",e)}get itemView(){return this._getOption("itemView")}set itemView(e){this._setOption("itemView",e)}get notifications(){return this._getOption("notifications")}set notifications(e){this._setOption("notifications",e)}get permissions(){return this._getOption("permissions")}set permissions(e){this._setOption("permissions",e)}get rootFolderName(){return this._getOption("rootFolderName")}set rootFolderName(e){this._setOption("rootFolderName",e)}get rtlEnabled(){return this._getOption("rtlEnabled")}set rtlEnabled(e){this._setOption("rtlEnabled",e)}get selectedItemKeys(){return this._getOption("selectedItemKeys")}set selectedItemKeys(e){this._setOption("selectedItemKeys",e)}get selectionMode(){return this._getOption("selectionMode")}set selectionMode(e){this._setOption("selectionMode",e)}get tabIndex(){return this._getOption("tabIndex")}set tabIndex(e){this._setOption("tabIndex",e)}get toolbar(){return this._getOption("toolbar")}set toolbar(e){this._setOption("toolbar",e)}get upload(){return this._getOption("upload")}set upload(e){this._setOption("upload",e)}get visible(){return this._getOption("visible")}set visible(e){this._setOption("visible",e)}get width(){return this._getOption("width")}set width(e){this._setOption("width",e)}_createInstance(e,t){return new Ri(e,t)}ngOnDestroy(){this._destroyWidget()}ngOnChanges(e){super.ngOnChanges(e),this.setupChanges("allowedFileExtensions",e),this.setupChanges("currentPathKeys",e),this.setupChanges("selectedItemKeys",e)}setupChanges(e,t){e in this._optionsToUpdate||this._idh.setup(e,t)}ngDoCheck(){this._idh.doCheck("allowedFileExtensions"),this._idh.doCheck("currentPathKeys"),this._idh.doCheck("selectedItemKeys"),this._watcherHelper.checkWatchers(),super.ngDoCheck(),super.clearChangedOptions()}_setOption(e,t){let i=this._idh.setupSingle(e,t),o=null!==this._idh.getChanges(e,t);(i||o)&&super._setOption(e,t)}};return e.\u0275fac=function(t){return new(t||e)(a.Y36(a.SBq),a.Y36(a.R0b),a.Y36(zi._5),a.Y36(zi._h),a.Y36(zi.i9),a.Y36(zi.al),a.Y36(r.ki),a.Y36(a.Lbi))},e.\u0275cmp=a.Xpm({type:e,selectors:[["dx-file-manager"]],inputs:{accessKey:"accessKey",activeStateEnabled:"activeStateEnabled",allowedFileExtensions:"allowedFileExtensions",contextMenu:"contextMenu",currentPath:"currentPath",currentPathKeys:"currentPathKeys",customizeDetailColumns:"customizeDetailColumns",customizeThumbnail:"customizeThumbnail",disabled:"disabled",elementAttr:"elementAttr",fileSystemProvider:"fileSystemProvider",focusedItemKey:"focusedItemKey",focusStateEnabled:"focusStateEnabled",height:"height",hint:"hint",hoverStateEnabled:"hoverStateEnabled",itemView:"itemView",notifications:"notifications",permissions:"permissions",rootFolderName:"rootFolderName",rtlEnabled:"rtlEnabled",selectedItemKeys:"selectedItemKeys",selectionMode:"selectionMode",tabIndex:"tabIndex",toolbar:"toolbar",upload:"upload",visible:"visible",width:"width"},outputs:{onContentReady:"onContentReady",onContextMenuItemClick:"onContextMenuItemClick",onContextMenuShowing:"onContextMenuShowing",onCurrentDirectoryChanged:"onCurrentDirectoryChanged",onDisposing:"onDisposing",onErrorOccurred:"onErrorOccurred",onFocusedItemChanged:"onFocusedItemChanged",onInitialized:"onInitialized",onOptionChanged:"onOptionChanged",onSelectedFileOpened:"onSelectedFileOpened",onSelectionChanged:"onSelectionChanged",onToolbarItemClick:"onToolbarItemClick",accessKeyChange:"accessKeyChange",activeStateEnabledChange:"activeStateEnabledChange",allowedFileExtensionsChange:"allowedFileExtensionsChange",contextMenuChange:"contextMenuChange",currentPathChange:"currentPathChange",currentPathKeysChange:"currentPathKeysChange",customizeDetailColumnsChange:"customizeDetailColumnsChange",customizeThumbnailChange:"customizeThumbnailChange",disabledChange:"disabledChange",elementAttrChange:"elementAttrChange",fileSystemProviderChange:"fileSystemProviderChange",focusedItemKeyChange:"focusedItemKeyChange",focusStateEnabledChange:"focusStateEnabledChange",heightChange:"heightChange",hintChange:"hintChange",hoverStateEnabledChange:"hoverStateEnabledChange",itemViewChange:"itemViewChange",notificationsChange:"notificationsChange",permissionsChange:"permissionsChange",rootFolderNameChange:"rootFolderNameChange",rtlEnabledChange:"rtlEnabledChange",selectedItemKeysChange:"selectedItemKeysChange",selectionModeChange:"selectionModeChange",tabIndexChange:"tabIndexChange",toolbarChange:"toolbarChange",uploadChange:"uploadChange",visibleChange:"visibleChange",widthChange:"widthChange"},features:[a._Bn([zi._5,zi._h,zi.al,zi.i9]),a.qOj,a.TTD],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e=(0,n.gn)([(0,n.fM)(7,(0,a.tBr)(a.Lbi)),(0,n.w6)("design:paramtypes",[a.SBq,a.R0b,zi._5,zi._h,zi.i9,zi.al,r.ki,Object])],e),e})(),Hi=(()=>{let e=class{};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[$i.m$R,$i.Q8p,$i.ToC,$i.z30,$i.tRk,$i.wrG,$i.ZLV,$i.azD,$i.kBH,$i.FGH,zi.Lz,zi.ie,r.Cu],$i.m$R,$i.Q8p,$i.ToC,$i.z30,$i.tRk,$i.wrG,$i.ZLV,$i.azD,$i.kBH,$i.FGH,zi.ie]}),e})();var qi=i(10418),Gi=i(6614),ji=i(35614),Qi=i(11018),Ji=i(37211),Wi=i(67935),Yi=i(25567),Xi=i(80549),eo=i(63376),to=i(91019),io=i(1100),oo=i(98439),so=i(12819),no=i(53938),ro=i(3578),ao=i(62992).Z.inherit({_supportedKeys:function(){var e=this._list?this._list.option("focusedElement"):null,t=this.callBase();return e=e&&(0,l.Z)(e),(0,h.l)({},t,{upArrow:function(t){return!(!(0,ue.j1)(t)&&(t.preventDefault(),t.stopPropagation(),e&&!this._calcNextItem(-1))&&(this._clearFocusedItem(),1))},downArrow:function(t){return!(!(0,ue.j1)(t)&&(t.preventDefault(),t.stopPropagation(),e&&!this._calcNextItem(1))&&(this._clearFocusedItem(),1))},enter:function(t){e||this.close();var i=this.option("opened");return i&&t.preventDefault(),i}})},_getDefaultOptions:function(){return(0,h.l)(this.callBase(),{minSearchLength:1,maxItemCount:10,noDataText:"",showDropDownButton:!1,searchEnabled:!0})},_initMarkup:function(){this.callBase(),this.$element().addClass("dx-autocomplete"),this.setAria("autocomplete","inline")},_displayGetterExpr:function(){return this.option("valueExpr")},_closeOutsideDropDownHandler:function(e){var{target:t}=e;return!(0,l.Z)(t).closest(this.$element()).length},_renderDimensions:function(){this.callBase(),this._dimensionChanged()},_popupWrapperClass:function(){return this.callBase()+" dx-autocomplete-popup-wrapper"},_listConfig:function(){return(0,h.l)(this.callBase(),{pageLoadMode:"none",onSelectionChanged:e=>{this._setSelectedItem(e.addedItems[0])}})},_listItemClickHandler:function(e){this._saveValueChangeEvent(e.event);var t=this._displayGetter(e.itemData);this.option("value",t),this.close()},_setListDataSource:function(){this._list&&(this._list.option("selectedItems",[]),this.callBase())},_refreshSelected:p.ZT,_searchCanceled:function(){this.callBase(),this.close()},_loadItem:function(e,t){var i=this._getItemFromPlain(e,t);return(new c.BH).resolve(i).promise()},_dataSourceOptions:function(){return{paginate:!0,pageSize:this.option("maxItemCount")}},_searchDataSource:function(e){this._dataSource.pageSize(this.option("maxItemCount")),this.callBase(e),this._clearFocusedItem()},_clearFocusedItem:function(){this._list&&(this._list.option("focusedElement",null),this._list.option("selectedIndex",-1))},_renderValueEventName:function(){return"input keyup"},_valueChangeEventHandler:function(e){var t=this._input().val()||null;return this.callBase(e,t)},_optionChanged:function(e){switch(e.name){case"maxItemCount":this._searchDataSource();break;case"valueExpr":this._compileDisplayGetter(),this._setListOption("displayExpr",this._displayGetterExpr()),this.callBase(e);break;default:this.callBase(e)}},reset:function(){this.callBase(),this.close()}});(0,m.Z)("dxAutocomplete",ao);const lo=ao,ho={provide:i(11462).JU,useExisting:(0,a.Gpc)(()=>co),multi:!0};let co=(()=>{let e=class extends zi.Ay{constructor(e,t,i,o,s,n,r,a){super(e,t,i,o,r,a),this._watcherHelper=o,this._idh=s,this.touched=e=>{},this._createEventEmitters([{subscribe:"change",emit:"onChange"},{subscribe:"closed",emit:"onClosed"},{subscribe:"contentReady",emit:"onContentReady"},{subscribe:"copy",emit:"onCopy"},{subscribe:"cut",emit:"onCut"},{subscribe:"disposing",emit:"onDisposing"},{subscribe:"enterKey",emit:"onEnterKey"},{subscribe:"focusIn",emit:"onFocusIn"},{subscribe:"focusOut",emit:"onFocusOut"},{subscribe:"initialized",emit:"onInitialized"},{subscribe:"input",emit:"onInput"},{subscribe:"itemClick",emit:"onItemClick"},{subscribe:"keyDown",emit:"onKeyDown"},{subscribe:"keyPress",emit:"onKeyPress"},{subscribe:"keyUp",emit:"onKeyUp"},{subscribe:"opened",emit:"onOpened"},{subscribe:"optionChanged",emit:"onOptionChanged"},{subscribe:"paste",emit:"onPaste"},{subscribe:"selectionChanged",emit:"onSelectionChanged"},{subscribe:"valueChanged",emit:"onValueChanged"},{emit:"accessKeyChange"},{emit:"activeStateEnabledChange"},{emit:"buttonsChange"},{emit:"dataSourceChange"},{emit:"deferRenderingChange"},{emit:"disabledChange"},{emit:"displayValueChange"},{emit:"dropDownButtonTemplateChange"},{emit:"dropDownOptionsChange"},{emit:"elementAttrChange"},{emit:"focusStateEnabledChange"},{emit:"groupedChange"},{emit:"groupTemplateChange"},{emit:"heightChange"},{emit:"hintChange"},{emit:"hoverStateEnabledChange"},{emit:"inputAttrChange"},{emit:"isValidChange"},{emit:"itemsChange"},{emit:"itemTemplateChange"},{emit:"maxItemCountChange"},{emit:"maxLengthChange"},{emit:"minSearchLengthChange"},{emit:"nameChange"},{emit:"openedChange"},{emit:"openOnFieldClickChange"},{emit:"placeholderChange"},{emit:"readOnlyChange"},{emit:"rtlEnabledChange"},{emit:"searchExprChange"},{emit:"searchModeChange"},{emit:"searchTimeoutChange"},{emit:"selectedItemChange"},{emit:"showClearButtonChange"},{emit:"showDropDownButtonChange"},{emit:"spellcheckChange"},{emit:"stylingModeChange"},{emit:"tabIndexChange"},{emit:"textChange"},{emit:"useItemTextAsTitleChange"},{emit:"validationErrorChange"},{emit:"validationErrorsChange"},{emit:"validationMessageModeChange"},{emit:"validationStatusChange"},{emit:"valueChange"},{emit:"valueChangeEventChange"},{emit:"valueExprChange"},{emit:"visibleChange"},{emit:"widthChange"},{emit:"wrapItemTextChange"},{emit:"onBlur"}]),this._idh.setHost(this),n.setHost(this)}get accessKey(){return this._getOption("accessKey")}set accessKey(e){this._setOption("accessKey",e)}get activeStateEnabled(){return this._getOption("activeStateEnabled")}set activeStateEnabled(e){this._setOption("activeStateEnabled",e)}get buttons(){return this._getOption("buttons")}set buttons(e){this._setOption("buttons",e)}get dataSource(){return this._getOption("dataSource")}set dataSource(e){this._setOption("dataSource",e)}get deferRendering(){return this._getOption("deferRendering")}set deferRendering(e){this._setOption("deferRendering",e)}get disabled(){return this._getOption("disabled")}set disabled(e){this._setOption("disabled",e)}get displayValue(){return this._getOption("displayValue")}set displayValue(e){this._setOption("displayValue",e)}get dropDownButtonTemplate(){return this._getOption("dropDownButtonTemplate")}set dropDownButtonTemplate(e){this._setOption("dropDownButtonTemplate",e)}get dropDownOptions(){return this._getOption("dropDownOptions")}set dropDownOptions(e){this._setOption("dropDownOptions",e)}get elementAttr(){return this._getOption("elementAttr")}set elementAttr(e){this._setOption("elementAttr",e)}get focusStateEnabled(){return this._getOption("focusStateEnabled")}set focusStateEnabled(e){this._setOption("focusStateEnabled",e)}get grouped(){return this._getOption("grouped")}set grouped(e){this._setOption("grouped",e)}get groupTemplate(){return this._getOption("groupTemplate")}set groupTemplate(e){this._setOption("groupTemplate",e)}get height(){return this._getOption("height")}set height(e){this._setOption("height",e)}get hint(){return this._getOption("hint")}set hint(e){this._setOption("hint",e)}get hoverStateEnabled(){return this._getOption("hoverStateEnabled")}set hoverStateEnabled(e){this._setOption("hoverStateEnabled",e)}get inputAttr(){return this._getOption("inputAttr")}set inputAttr(e){this._setOption("inputAttr",e)}get isValid(){return this._getOption("isValid")}set isValid(e){this._setOption("isValid",e)}get items(){return this._getOption("items")}set items(e){this._setOption("items",e)}get itemTemplate(){return this._getOption("itemTemplate")}set itemTemplate(e){this._setOption("itemTemplate",e)}get maxItemCount(){return this._getOption("maxItemCount")}set maxItemCount(e){this._setOption("maxItemCount",e)}get maxLength(){return this._getOption("maxLength")}set maxLength(e){this._setOption("maxLength",e)}get minSearchLength(){return this._getOption("minSearchLength")}set minSearchLength(e){this._setOption("minSearchLength",e)}get name(){return this._getOption("name")}set name(e){this._setOption("name",e)}get opened(){return this._getOption("opened")}set opened(e){this._setOption("opened",e)}get openOnFieldClick(){return this._getOption("openOnFieldClick")}set openOnFieldClick(e){this._setOption("openOnFieldClick",e)}get placeholder(){return this._getOption("placeholder")}set placeholder(e){this._setOption("placeholder",e)}get readOnly(){return this._getOption("readOnly")}set readOnly(e){this._setOption("readOnly",e)}get rtlEnabled(){return this._getOption("rtlEnabled")}set rtlEnabled(e){this._setOption("rtlEnabled",e)}get searchExpr(){return this._getOption("searchExpr")}set searchExpr(e){this._setOption("searchExpr",e)}get searchMode(){return this._getOption("searchMode")}set searchMode(e){this._setOption("searchMode",e)}get searchTimeout(){return this._getOption("searchTimeout")}set searchTimeout(e){this._setOption("searchTimeout",e)}get selectedItem(){return this._getOption("selectedItem")}set selectedItem(e){this._setOption("selectedItem",e)}get showClearButton(){return this._getOption("showClearButton")}set showClearButton(e){this._setOption("showClearButton",e)}get showDropDownButton(){return this._getOption("showDropDownButton")}set showDropDownButton(e){this._setOption("showDropDownButton",e)}get spellcheck(){return this._getOption("spellcheck")}set spellcheck(e){this._setOption("spellcheck",e)}get stylingMode(){return this._getOption("stylingMode")}set stylingMode(e){this._setOption("stylingMode",e)}get tabIndex(){return this._getOption("tabIndex")}set tabIndex(e){this._setOption("tabIndex",e)}get text(){return this._getOption("text")}set text(e){this._setOption("text",e)}get useItemTextAsTitle(){return this._getOption("useItemTextAsTitle")}set useItemTextAsTitle(e){this._setOption("useItemTextAsTitle",e)}get validationError(){return this._getOption("validationError")}set validationError(e){this._setOption("validationError",e)}get validationErrors(){return this._getOption("validationErrors")}set validationErrors(e){this._setOption("validationErrors",e)}get validationMessageMode(){return this._getOption("validationMessageMode")}set validationMessageMode(e){this._setOption("validationMessageMode",e)}get validationStatus(){return this._getOption("validationStatus")}set validationStatus(e){this._setOption("validationStatus",e)}get value(){return this._getOption("value")}set value(e){this._setOption("value",e)}get valueChangeEvent(){return this._getOption("valueChangeEvent")}set valueChangeEvent(e){this._setOption("valueChangeEvent",e)}get valueExpr(){return this._getOption("valueExpr")}set valueExpr(e){this._setOption("valueExpr",e)}get visible(){return this._getOption("visible")}set visible(e){this._setOption("visible",e)}get width(){return this._getOption("width")}set width(e){this._setOption("width",e)}get wrapItemText(){return this._getOption("wrapItemText")}set wrapItemText(e){this._setOption("wrapItemText",e)}change(e){}get buttonsChildren(){return this._getOption("buttons")}set buttonsChildren(e){this.setChildren("buttons",e)}get itemsChildren(){return this._getOption("items")}set itemsChildren(e){this.setChildren("items",e)}_createInstance(e,t){return new lo(e,t)}writeValue(e){this.eventHelper.lockedValueChangeEvent=!0,this.value=e,this.eventHelper.lockedValueChangeEvent=!1}setDisabledState(e){this.disabled=e}registerOnChange(e){this.change=e}registerOnTouched(e){this.touched=e}_createWidget(e){super._createWidget(e),this.instance.on("focusOut",e=>{this.eventHelper.fireNgEvent("onBlur",[e])})}ngOnDestroy(){this._destroyWidget()}ngOnChanges(e){super.ngOnChanges(e),this.setupChanges("buttons",e),this.setupChanges("dataSource",e),this.setupChanges("items",e),this.setupChanges("searchExpr",e),this.setupChanges("validationErrors",e)}setupChanges(e,t){e in this._optionsToUpdate||this._idh.setup(e,t)}ngDoCheck(){this._idh.doCheck("buttons"),this._idh.doCheck("dataSource"),this._idh.doCheck("items"),this._idh.doCheck("searchExpr"),this._idh.doCheck("validationErrors"),this._watcherHelper.checkWatchers(),super.ngDoCheck(),super.clearChangedOptions()}_setOption(e,t){let i=this._idh.setupSingle(e,t),o=null!==this._idh.getChanges(e,t);(i||o)&&super._setOption(e,t)}};return e.\u0275fac=function(t){return new(t||e)(a.Y36(a.SBq),a.Y36(a.R0b),a.Y36(zi._5),a.Y36(zi._h),a.Y36(zi.i9),a.Y36(zi.al),a.Y36(r.ki),a.Y36(a.Lbi))},e.\u0275cmp=a.Xpm({type:e,selectors:[["dx-autocomplete"]],contentQueries:function(e,t,i){if(1&e&&(a.Suo(i,$i.k4o,4),a.Suo(i,$i.ZT3,4)),2&e){let e;a.iGM(e=a.CRH())&&(t.buttonsChildren=e),a.iGM(e=a.CRH())&&(t.itemsChildren=e)}},hostBindings:function(e,t){1&e&&a.NdJ("onBlur",function(e){return t.touched(e)})("valueChange",function(e){return t.change(e)})},inputs:{accessKey:"accessKey",activeStateEnabled:"activeStateEnabled",buttons:"buttons",dataSource:"dataSource",deferRendering:"deferRendering",disabled:"disabled",displayValue:"displayValue",dropDownButtonTemplate:"dropDownButtonTemplate",dropDownOptions:"dropDownOptions",elementAttr:"elementAttr",focusStateEnabled:"focusStateEnabled",grouped:"grouped",groupTemplate:"groupTemplate",height:"height",hint:"hint",hoverStateEnabled:"hoverStateEnabled",inputAttr:"inputAttr",isValid:"isValid",items:"items",itemTemplate:"itemTemplate",maxItemCount:"maxItemCount",maxLength:"maxLength",minSearchLength:"minSearchLength",name:"name",opened:"opened",openOnFieldClick:"openOnFieldClick",placeholder:"placeholder",readOnly:"readOnly",rtlEnabled:"rtlEnabled",searchExpr:"searchExpr",searchMode:"searchMode",searchTimeout:"searchTimeout",selectedItem:"selectedItem",showClearButton:"showClearButton",showDropDownButton:"showDropDownButton",spellcheck:"spellcheck",stylingMode:"stylingMode",tabIndex:"tabIndex",text:"text",useItemTextAsTitle:"useItemTextAsTitle",validationError:"validationError",validationErrors:"validationErrors",validationMessageMode:"validationMessageMode",validationStatus:"validationStatus",value:"value",valueChangeEvent:"valueChangeEvent",valueExpr:"valueExpr",visible:"visible",width:"width",wrapItemText:"wrapItemText"},outputs:{onChange:"onChange",onClosed:"onClosed",onContentReady:"onContentReady",onCopy:"onCopy",onCut:"onCut",onDisposing:"onDisposing",onEnterKey:"onEnterKey",onFocusIn:"onFocusIn",onFocusOut:"onFocusOut",onInitialized:"onInitialized",onInput:"onInput",onItemClick:"onItemClick",onKeyDown:"onKeyDown",onKeyPress:"onKeyPress",onKeyUp:"onKeyUp",onOpened:"onOpened",onOptionChanged:"onOptionChanged",onPaste:"onPaste",onSelectionChanged:"onSelectionChanged",onValueChanged:"onValueChanged",accessKeyChange:"accessKeyChange",activeStateEnabledChange:"activeStateEnabledChange",buttonsChange:"buttonsChange",dataSourceChange:"dataSourceChange",deferRenderingChange:"deferRenderingChange",disabledChange:"disabledChange",displayValueChange:"displayValueChange",dropDownButtonTemplateChange:"dropDownButtonTemplateChange",dropDownOptionsChange:"dropDownOptionsChange",elementAttrChange:"elementAttrChange",focusStateEnabledChange:"focusStateEnabledChange",groupedChange:"groupedChange",groupTemplateChange:"groupTemplateChange",heightChange:"heightChange",hintChange:"hintChange",hoverStateEnabledChange:"hoverStateEnabledChange",inputAttrChange:"inputAttrChange",isValidChange:"isValidChange",itemsChange:"itemsChange",itemTemplateChange:"itemTemplateChange",maxItemCountChange:"maxItemCountChange",maxLengthChange:"maxLengthChange",minSearchLengthChange:"minSearchLengthChange",nameChange:"nameChange",openedChange:"openedChange",openOnFieldClickChange:"openOnFieldClickChange",placeholderChange:"placeholderChange",readOnlyChange:"readOnlyChange",rtlEnabledChange:"rtlEnabledChange",searchExprChange:"searchExprChange",searchModeChange:"searchModeChange",searchTimeoutChange:"searchTimeoutChange",selectedItemChange:"selectedItemChange",showClearButtonChange:"showClearButtonChange",showDropDownButtonChange:"showDropDownButtonChange",spellcheckChange:"spellcheckChange",stylingModeChange:"stylingModeChange",tabIndexChange:"tabIndexChange",textChange:"textChange",useItemTextAsTitleChange:"useItemTextAsTitleChange",validationErrorChange:"validationErrorChange",validationErrorsChange:"validationErrorsChange",validationMessageModeChange:"validationMessageModeChange",validationStatusChange:"validationStatusChange",valueChange:"valueChange",valueChangeEventChange:"valueChangeEventChange",valueExprChange:"valueExprChange",visibleChange:"visibleChange",widthChange:"widthChange",wrapItemTextChange:"wrapItemTextChange",onBlur:"onBlur"},features:[a._Bn([zi._5,zi._h,ho,zi.al,zi.i9]),a.qOj,a.TTD],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e=(0,n.gn)([(0,n.fM)(7,(0,a.tBr)(a.Lbi)),(0,n.w6)("design:paramtypes",[a.SBq,a.R0b,zi._5,zi._h,zi.i9,zi.al,r.ki,Object])],e),e})(),po=(()=>{let e=class{};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[$i.idP,$i.UxI,$i.ggs,$i.IOm,$i.kOw,$i.pxS,$i.D_l,$i.JxK,$i.zZW,$i.ynY,$i.lgR,$i.sni,$i.pGy,$i.Q8p,zi.Lz,zi.ie,r.Cu],$i.idP,$i.UxI,$i.ggs,$i.IOm,$i.kOw,$i.pxS,$i.D_l,$i.JxK,$i.zZW,$i.ynY,$i.lgR,$i.sni,$i.pGy,$i.Q8p,zi.ie]}),e})();function uo(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"div"),a.TgZ(1,"dx-select-box",21),a.NdJ("onValueChanged",function(t){return a.CHM(e),a.oxw().onCategoryValueChanged(t)}),a.qZA(),a.qZA()}if(2&e){const e=a.oxw();a.xp6(1),a.Q6J("dataSource",e.categoryList)("value",null==e.fileData?null:e.fileData.category)}}function mo(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"div"),a.TgZ(1,"dx-autocomplete",22),a.NdJ("valueChange",function(t){return a.CHM(e),a.oxw().searchValue=t})("onKeyUp",function(t){return a.CHM(e),a.oxw().onSearchKeyUpHandler(t)})("onItemClick",function(t){return a.CHM(e),a.oxw().onItemClick(t)}),a.qZA(),a.qZA()}if(2&e){const e=a.oxw();a.xp6(1),a.Q6J("placeholder",e.searchPlaceholder)("value",e.searchValue)("dataSource",e.searchData)("opened",e.isOpenSuggestion)("valueExpr",e.valueExpr)}}function go(e,t){if(1&e&&(a.TgZ(0,"div"),a.TgZ(1,"div"),a._uU(2),a.qZA(),a.qZA()),2&e){const e=a.oxw();a.xp6(2),a.hij("",null==e.fileData?null:e.fileData.fileName,"/")}}const _o=function(e,t){return{"photo-popup-content":e,"photo-popup-loading":t}},fo=function(){return["upload-form"]},Co=function(){return{text:"Source ID"}},bo=function(){return{text:"Title"}};let Io=(()=>{class e{constructor(e,t,i,o,s,n,r,a,l,h){this.fileStore=e,this.store=t,this.userStore=i,this.userService=o,this.postService=s,this.courseService=n,this.subjectService=r,this.lessonService=a,this.testService=l,this.questionService=h,this.submitButtonOptions={text:"Submit",icon:"save",type:"normal",useSubmitBehavior:!0},this.resetButtonOptions={text:"Reset",icon:"refresh",type:"normal",useSubmitBehavior:!1,onClick:this.resetValues.bind(this)},this.tempUrl="",this.fileData={id:"",container:"",category:"",url:"",fileName:"",sourceID:"",title:""},this.containerList=[],this.categoryList=[{name:"post"},{name:"learner"},{name:"instructor"},{name:"test"},{name:"lesson"},{name:"course"},{name:"question"},{name:"subject"}],this.searchData=[],this.pageSize=100,this.onSubmit=e=>{e.preventDefault(),this.fileStore.updateFile(this.fileData.id,this.fileData.sourceID,this.fileData.title),this.resetValues()}}onCategoryValueChanged(e){switch(this.fileData.category=e.value,this.searchValue="",e.value){case"learner":case"instructor":this.valueExpr="displayName",this.searchCategory="Display Name",this.searchPlaceholder="Search display name";break;case"post":this.valueExpr="title",this.searchCategory="Post Title",this.searchPlaceholder="Search post title";break;case"course":case"test":case"subject":case"lesson":this.valueExpr="name",this.searchCategory="Name",this.searchPlaceholder="Search name";break;case"question":this.valueExpr="content",this.searchCategory="Content",this.searchPlaceholder="Search content"}}resetValues(){this.tempUrl="",this.fileData={id:"",container:"",category:"",url:"",fileName:"",sourceID:"",title:""}}isUploadingListener(){return this.fileStore.$isUpdatingFile.subscribe(e=>{this.isUploading=e})}containerDataListener(){return this.fileStore.$containerList.subscribe(e=>{0!==(null==e?void 0:e.length)&&(this.containerList=e)})}onItemClick(e){var t,i;switch(this.selectedData=e.itemData,console.log("SELECTED DATA"),console.log(this.selectedData),this.fileData.sourceID=null===(t=e.itemData)||void 0===t?void 0:t.id,null===(i=this.fileData)||void 0===i?void 0:i.category){case"instructor":case"learner":this.fileData.title=e.itemData.displayName;break;case"post":this.fileData.title=e.itemData.title;break;case"course":case"test":case"subject":case"lesson":this.fileData.title=e.itemData.name;break;case"question":this.fileData.title=e.itemData.content}}onSearchKeyUpHandler(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{var e;switch(this.isUploading=!0,null===(e=this.fileData)||void 0===e?void 0:e.category){case"instructor":this.userService.filterSearchUserByProperty("roleId",this.instructorRoleId,"displayName",this.searchValue,1,this.pageSize).subscribe(e=>{this.searchData=e.data,null===e.data?this.store.showNotif("There is no matched item!","custom"):(clearTimeout(this.isOpenSuggestionTimeout),this.isOpenSuggestion=!1,this.isOpenSuggestionTimeout=setTimeout(()=>{this.isOpenSuggestion=!0},500)),console.log("SEARCH DATA"),console.log(this.searchData),this.isUploading=!1});break;case"learner":this.userService.filterSearchUserByProperty("roleId",this.learnerRoleId,"displayName",this.searchValue,1,this.pageSize).subscribe(e=>{this.searchData=e.data,null===e.data?this.store.showNotif("There is no matched item!","custom"):(clearTimeout(this.isOpenSuggestionTimeout),this.isOpenSuggestion=!1,this.isOpenSuggestionTimeout=setTimeout(()=>{this.isOpenSuggestion=!0},500)),console.log("SEARCH DATA"),console.log(this.searchData),this.isUploading=!1});break;case"post":this.postService.searchPostByProperty("title",this.searchValue,0,this.pageSize).subscribe(e=>{this.searchData=e.data,null===e.data?this.store.showNotif("There is no matched item!","custom"):(clearTimeout(this.isOpenSuggestionTimeout),this.isOpenSuggestion=!1,this.isOpenSuggestionTimeout=setTimeout(()=>{this.isOpenSuggestion=!0},500)),console.log("SEARCH DATA"),console.log(this.searchData),this.isUploading=!1});break;case"course":this.courseService.searchCourseByProperty("name",this.searchValue,0,this.pageSize).subscribe(e=>{this.searchData=e.data,null===e.data?this.store.showNotif("There is no matched item!","custom"):(clearTimeout(this.isOpenSuggestionTimeout),this.isOpenSuggestion=!1,this.isOpenSuggestionTimeout=setTimeout(()=>{this.isOpenSuggestion=!0},500)),console.log("SEARCH DATA"),console.log(this.searchData),this.isUploading=!1});break;case"subject":this.subjectService.searchSubjectByProperty("name",this.searchValue,0,this.pageSize).subscribe(e=>{this.searchData=e.data,null===e.data?this.store.showNotif("There is no matched item!","custom"):(clearTimeout(this.isOpenSuggestionTimeout),this.isOpenSuggestion=!1,this.isOpenSuggestionTimeout=setTimeout(()=>{this.isOpenSuggestion=!0},500)),console.log("SEARCH DATA"),console.log(this.searchData),this.isUploading=!1});break;case"test":this.testService.searchTestByProperty("name",this.searchValue,0,this.pageSize).subscribe(e=>{this.searchData=e.data,null===e.data?this.store.showNotif("There is no matched item!","custom"):(clearTimeout(this.isOpenSuggestionTimeout),this.isOpenSuggestion=!1,this.isOpenSuggestionTimeout=setTimeout(()=>{this.isOpenSuggestion=!0},500)),console.log("SEARCH DATA"),console.log(this.searchData),this.isUploading=!1});break;case"lesson":this.lessonService.searchLessonByProperty("name",this.searchValue,0,this.pageSize).subscribe(e=>{this.searchData=e.data,null===e.data?this.store.showNotif("There is no matched item!","custom"):(clearTimeout(this.isOpenSuggestionTimeout),this.isOpenSuggestion=!1,this.isOpenSuggestionTimeout=setTimeout(()=>{this.isOpenSuggestion=!0},500)),console.log("SEARCH DATA"),console.log(this.searchData),this.isUploading=!1});break;case"question":this.questionService.searchQuestionByProperty("content",this.searchValue,0,this.pageSize).subscribe(e=>{this.searchData=e.data,null===e.data?this.store.showNotif("There is no matched item!","custom"):(clearTimeout(this.isOpenSuggestionTimeout),this.isOpenSuggestion=!1,this.isOpenSuggestionTimeout=setTimeout(()=>{this.isOpenSuggestion=!0},500)),console.log("SEARCH DATA"),console.log(this.searchData),this.isUploading=!1})}},1250)}ngOnInit(){this.getRoleIdList(),this.containerDataListener(),this.isUploadingListener()}renderSelectedFile(){this.selectedItem&&(console.log("SELECTED IMAGE"),console.log(this.selectedItem),this.fileData.id=this.selectedItem.__KEY__,this.fileData.fileName=this.selectedItem.name,this.fileData.title=this.selectedItem.title,this.fileData.category=this.selectedItem.category,this.fileData.container=this.selectedItem.container,this.fileData.url=this.selectedItem.thumbnail,this.fileData.sourceID=this.selectedItem.sourceID),this.searchValue="",this.searchPlaceholder="",this.searchCategory=""}getRoleIdList(){this.userStore.getRole().then(()=>{this.userStore.$roleList.subscribe(e=>{var t,i;this.instructorRoleId=null===(t=e.find(e=>"Instructor"===e.name))||void 0===t?void 0:t.id,this.learnerRoleId=null===(i=e.find(e=>"Learner"===e.name))||void 0===i?void 0:i.id})})}ngOnChanges(){this.renderSelectedFile()}ngOnDestroy(){this.isUploadingListener().unsubscribe(),this.containerDataListener().unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(Gi.V),a.Y36(qi.d),a.Y36(Yi.U),a.Y36(Xi.b),a.Y36(eo.G),a.Y36(to.Y),a.Y36(io.L),a.Y36(oo.L),a.Y36(so.v),a.Y36(no.Q))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-update-file"]],viewQuery:function(e,t){if(1&e&&a.Gf(Wi.Y,5),2&e){let e;a.iGM(e=a.CRH())&&(t.dxForm=e.first)}},inputs:{selectedItem:"selectedItem"},features:[a.TTD],decls:24,vars:18,consts:[[3,"ngClass"],[1,"img-container"],["alt","...",3,"src"],[1,"container"],["id","form-container",3,"classList","submit"],["id","form","validationGroup","uploadFile",3,"formData","showValidationSummary"],["itemType","group"],["itemType","group","caption","File Meta Data"],["name","category"],["text","Category"],[4,"dxTemplate"],["name","auto-complete"],[3,"text"],["dataField","sourceID","editorType","dxTextBox",3,"label"],["type","required","message","Source id is required"],["name","fileName"],["text","File Name"],["dataField","title","editorType","dxTextBox",3,"label"],["type","required","message","Title is required"],["itemType","group",3,"colCount","cssClass"],["itemType","button","horizontalAlignment","center",3,"buttonOptions"],["valueExpr","name","displayExpr","name","placeholder","Select a category",3,"dataSource","value","onValueChanged"],[3,"placeholder","value","dataSource","opened","valueExpr","valueChange","onKeyUp","onItemClick"]],template:function(e,t){1&e&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a._UZ(2,"img",2),a.qZA(),a.TgZ(3,"div",3),a.TgZ(4,"form",4),a.NdJ("submit",function(e){return t.onSubmit(e)}),a.TgZ(5,"dx-form",5),a.TgZ(6,"dxi-item",6),a.TgZ(7,"dxi-item",7),a.TgZ(8,"dxi-item",8),a._UZ(9,"dxo-label",9),a.YNc(10,uo,2,2,"div",10),a.qZA(),a.TgZ(11,"dxi-item",11),a._UZ(12,"dxo-label",12),a.YNc(13,mo,2,5,"div",10),a.qZA(),a.TgZ(14,"dxi-item",13),a._UZ(15,"dxi-validation-rule",14),a.qZA(),a.TgZ(16,"dxi-item",15),a._UZ(17,"dxo-label",16),a.YNc(18,go,3,1,"div",10),a.qZA(),a.TgZ(19,"dxi-item",17),a._UZ(20,"dxi-validation-rule",18),a.qZA(),a.TgZ(21,"dxi-item",19),a._UZ(22,"dxi-item",20),a._UZ(23,"dxi-item",20),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&e&&(a.Q6J("ngClass",a.WLB(12,_o,!1===t.isUploading,!0===t.isUploading)),a.xp6(2),a.Q6J("src",null==t.fileData?null:t.fileData.url,a.LSH),a.xp6(2),a.Q6J("classList",a.DdM(15,fo)),a.xp6(1),a.Q6J("formData",t.fileData)("showValidationSummary",!0),a.xp6(7),a.Q6J("text",t.searchCategory),a.xp6(2),a.Q6J("label",a.DdM(16,Co)),a.xp6(5),a.Q6J("label",a.DdM(17,bo)),a.xp6(2),a.Q6J("colCount",2)("cssClass","buttonGroup"),a.xp6(1),a.Q6J("buttonOptions",t.submitButtonOptions),a.xp6(1),a.Q6J("buttonOptions",t.resetButtonOptions))},directives:[o.mk,Wi.Y,$i.ZT3,$i.sBj,zi.p6,$i.vrV,ro._,co],styles:['.img-container[_ngcontent-%COMP%]{display:flex;justify-content:center;height:70%;width:70%;align-items:center;margin:10px}.info-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:10px}.info-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:700;border-bottom:2px solid orchid}@media screen and (max-width:450px){.photo-popup-content[_ngcontent-%COMP%], .photo-popup-loading[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-evenly;align-items:flex-start;font-size:large}.photo-popup-loading[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.514);filter:blur(2rem);animation:color-change 3s infinite}.info-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;height:100%;width:100%;align-items:flex-start;margin-bottom:5px}.img-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100px;width:100px;border-radius:5px;box-shadow:0 25px 50px -12px #4fcdff40}}@media screen and (min-width:451px){.photo-popup-content[_ngcontent-%COMP%], .photo-popup-loading[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-evenly;align-items:flex-start;font-size:large}.photo-popup-loading[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.514);filter:blur(2rem);animation:color-change 3s infinite alternate}.info-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;height:100%;width:30%;align-items:flex-start;margin-bottom:5px}.img-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:70%;border-radius:5px;box-shadow:0 25px 50px -12px #4fcdff40}}.img-input[_ngcontent-%COMP%]{color:#0000;width:65px}.img-input[_ngcontent-%COMP%]::-webkit-file-upload-button{visibility:hidden}.img-input[_ngcontent-%COMP%]:before{content:"Upload";display:inline-block;border:1px solid #999;border-radius:3px;padding:5px 8px;outline:none;white-space:nowrap;-webkit-user-select:none;user-select:none;cursor:pointer;text-shadow:1px 1px #fff;font-weight:700;font-size:15px}.img-input[_ngcontent-%COMP%]:hover:before{border-color:#fcffff}.img-input[_ngcontent-%COMP%]:active:before{background:-webkit-linear-gradient(top,#e3e3e3,#f9f9f9)}@keyframes color-change{0%{background-color:red}to{background-color:blue}}']}),e})();const vo=function(e,t){return{"photo-popup-content":e,"photo-popup-loading":t}},yo=function(){return{text:"File Name"}};let xo=(()=>{class e{constructor(e){this.fileStore=e,this.submitButtonOptions={text:"Submit",icon:"save",type:"normal",useSubmitBehavior:!0},this.resetButtonOptions={text:"Reset",icon:"refresh",type:"normal",useSubmitBehavior:!1,onClick:this.resetValues.bind(this)},this.onSubmit=e=>{e.preventDefault(),this.fileStore.changeFileName(this.fileData.id,this.fileData.fileName),this.resetValues()}}isUploadingListener(){return this.fileStore.$isRenamingFile.subscribe(e=>{this.isUploading=e})}resetValues(){this.fileData={id:"",fileName:""}}renderSelectedFile(){this.selectedItem&&(console.log("SELECTED IMAGE"),console.log(this.selectedItem),this.fileData.id=this.selectedItem.__KEY__,this.fileData.fileName=this.selectedItem.name)}ngOnInit(){this.isUploadingListener()}ngOnChanges(){this.resetValues(),this.renderSelectedFile()}ngOnDestroy(){this.isUploadingListener().unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(Gi.V))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-rename-file"]],viewQuery:function(e,t){if(1&e&&a.Gf(Wi.Y,5),2&e){let e;a.iGM(e=a.CRH())&&(t.dxForm=e.first)}},inputs:{selectedItem:"selectedItem"},features:[a.TTD],decls:11,vars:12,consts:[[3,"ngClass"],[1,"container"],["id","form-container",3,"submit"],["id","form","validationGroup","updateFolder",3,"formData","showValidationSummary"],["itemType","group"],["itemType","group","caption","Type in new name"],["dataField","fileName","editorType","dxTextBox",3,"label"],["type","required","message","Folder name is required"],["itemType","group",3,"colCount","cssClass"],["itemType","button","horizontalAlignment","center",3,"buttonOptions"]],template:function(e,t){1&e&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"form",2),a.NdJ("submit",function(e){return t.onSubmit(e)}),a.TgZ(3,"dx-form",3),a.TgZ(4,"dxi-item",4),a.TgZ(5,"dxi-item",5),a.TgZ(6,"dxi-item",6),a._UZ(7,"dxi-validation-rule",7),a.qZA(),a.TgZ(8,"dxi-item",8),a._UZ(9,"dxi-item",9),a._UZ(10,"dxi-item",9),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&e&&(a.Q6J("ngClass",a.WLB(8,vo,!1===t.isUploading,!0===t.isUploading)),a.xp6(3),a.Q6J("formData",t.fileData)("showValidationSummary",!0),a.xp6(3),a.Q6J("label",a.DdM(11,yo)),a.xp6(2),a.Q6J("colCount",2)("cssClass","buttonGroup"),a.xp6(1),a.Q6J("buttonOptions",t.submitButtonOptions),a.xp6(1),a.Q6J("buttonOptions",t.resetButtonOptions))},directives:[o.mk,Wi.Y,$i.ZT3,$i.vrV],styles:["@media screen and (max-width:450px){.photo-popup-content[_ngcontent-%COMP%], .photo-popup-loading[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-evenly;align-items:flex-start;font-size:large}.photo-popup-loading[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.514);filter:blur(2rem);animation:color-change 3s infinite}}@media screen and (min-width:451px){.photo-popup-content[_ngcontent-%COMP%], .photo-popup-loading[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-evenly;align-items:flex-start;font-size:large}.photo-popup-loading[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.514);filter:blur(2rem);animation:color-change 3s infinite alternate}}@keyframes color-change{0%{background-color:red}to{background-color:blue}}"]}),e})();var So=i(68413),Do={horizontal:{itemMainRatio:"widthRatio",itemCrossRatio:"heightRatio",baseItemMainDimension:"baseItemWidth",baseItemCrossDimension:"baseItemHeight",mainDimension:"width",crossDimension:"height",mainPosition:"left",crossPosition:"top"},vertical:{itemMainRatio:"heightRatio",itemCrossRatio:"widthRatio",baseItemMainDimension:"baseItemHeight",baseItemCrossDimension:"baseItemWidth",mainDimension:"height",crossDimension:"width",mainPosition:"top",crossPosition:"left"}},wo=xe.Z.inherit({_activeStateUnit:".dx-tile",_getDefaultOptions:function(){return(0,h.l)(this.callBase(),{items:null,direction:"horizontal",hoverStateEnabled:!0,showScrollbar:!1,height:500,baseItemWidth:100,baseItemHeight:100,itemMargin:20,activeStateEnabled:!0,indicateLoading:!0})},_defaultOptionsRules:function(){return this.callBase().concat([{device:function(){return"desktop"===me.Z.real().deviceType&&!me.Z.isSimulator()},options:{focusStateEnabled:!0}}])},_itemClass:function(){return"dx-tile"},_itemDataKey:function(){return"dxTileData"},_itemContainer:function(){return this._$container},_init:function(){this.callBase(),this.$element().addClass("dx-tileview"),this._initScrollView()},_dataSourceLoadingChangedHandler:function(e){var t=this._scrollView;t&&t.startLoading&&(e&&this.option("indicateLoading")?t.startLoading():t.finishLoading())},_hideLoadingIfLoadIndicationOff:function(){this.option("indicateLoading")||this._dataSourceLoadingChangedHandler(!1)},_initScrollView:function(){this._scrollView=this._createComponent(this.$element(),ye.Z,{direction:this.option("direction"),scrollByContent:!0,useKeyboard:!1,showScrollbar:this.option("showScrollbar")}),this._$container=(0,l.Z)(this._scrollView.content()),this._$container.addClass("dx-tileview-wrapper"),this._scrollView.option("onUpdated",this._renderGeometry.bind(this))},_initMarkup:function(){this.callBase(),(0,p.g0)((function(){this._cellsPerDimension=1,this._renderGeometry(),this._updateScrollView(),this._fireContentReadyAction()}).bind(this))},_updateScrollView:function(){this._scrollView.option("direction",this.option("direction")),this._scrollView.update(),this._indicateLoadingIfAlreadyStarted()},_indicateLoadingIfAlreadyStarted:function(){this._isDataSourceLoading()&&this._dataSourceLoadingChangedHandler(!0)},_renderGeometry:function(){this._config=Do[this.option("direction")];var e=this.option("items")||[],t=this._config,i=this.option("itemMargin"),o=Math.max.apply(Math,(0,x.UI)(e||[],function(e){return Math.round(e[t.itemCrossRatio]||1)})),s=(0,B.Ym)()?this.$element()[t.crossDimension]():parseInt(this.$element().get(0).style[t.crossDimension]);this._cellsPerDimension=Math.floor(s/(this.option(t.baseItemCrossDimension)+i)),this._cellsPerDimension=Math.max(this._cellsPerDimension,o),this._cells=[],this._cells.push(new Array(this._cellsPerDimension)),this._arrangeItems(e),this._renderContentSize(t,i)},_renderContentSize:function(e,t){var{mainDimension:i,baseItemMainDimension:o}=e;if((0,B.Ym)()){var s=this._cells.length*this.option(o)+(this._cells.length+1)*t,n=this.$element()[i]();this._$container[i](Math.max(s,n))}},_arrangeItems:function(e){var t=this._config,i=t.itemMainRatio,o=t.itemCrossRatio,s=t.mainPosition;this._itemsPositions=[],(0,x.S6)(e,(function(e,n){var r={};r[i]=n[i]||1,r[o]=n[o]||1,r.index=e,r[i]=r[i]<=0?0:Math.round(r[t.itemMainRatio]),r[o]=r[o]<=0?0:Math.round(r[t.itemCrossRatio]);var a=this._getItemPosition(r);-1===a[s]&&(a[s]=this._cells.push(new Array(this._cellsPerDimension))-1),this._occupyCells(r,a),this._arrangeItem(r,a),this._itemsPositions.push(a)}).bind(this))},_getItemPosition:function(e){var t=this._config,i=t.mainPosition,o=t.crossPosition,s={};s[i]=-1,s[o]=0;for(var n=0;n<this._cells.length;n++){for(var r=0;r<this._cellsPerDimension;r++)if(this._itemFit(n,r,e)){s[i]=n,s[o]=r;break}if(s[i]>-1)break}return s},_itemFit:function(e,t,i){var o=!0,s=this._config,n=i[s.itemMainRatio],r=i[s.itemCrossRatio];if(t+r>this._cellsPerDimension)return!1;for(var a=e;a<e+n;a++)for(var l=t;l<t+r;l++)if(this._cells.length-1<a)this._cells.push(new Array(this._cellsPerDimension));else if(void 0!==this._cells[a][l]){o=!1;break}return o},_occupyCells:function(e,t){for(var i=this._config,o=t[i.mainPosition],s=t[i.crossPosition],n=e[i.itemMainRatio],r=e[i.itemCrossRatio],a=o;a<o+n;a++)for(var l=s;l<s+r;l++)this._cells[a][l]=e.index},_arrangeItem:function(e,t){var i=this._config,o=t[i.mainPosition],s=t[i.crossPosition],n=e[i.itemMainRatio],r=e[i.itemCrossRatio],a=this.option(i.baseItemCrossDimension),l=this.option(i.baseItemMainDimension),h=this.option("itemMargin"),d={display:n<=0||r<=0?"none":""},c=n*l+(n-1)*h,p=r*a+(r-1)*h;if(d[i.mainDimension]=c<0?0:c,d[i.crossDimension]=p<0?0:p,d[i.mainPosition]=o*l+(o+1)*h,d[i.crossPosition]=s*a+(s+1)*h,this.option("rtlEnabled")){var u=this._$container.width(),m=this.option("baseItemWidth"),g=t.left;d.left=u-(g*m+(m+h)*e.widthRatio+g*h)}this._itemElements().eq(e.index).css(d)},_moveFocus:function(e){var t="up",i="down",o=this.option("rtlEnabled")?"right":"left",s=this.option("rtlEnabled")?"left":"right",n="pageup",r="pagedown",a="horizontal"===this.option("direction"),h=this._cells,c=(0,l.Z)(this.option("focusedElement")).index(),p=this._itemsPositions[c].left,u=this._itemsPositions[c].top,m=(a?h:h[0]).length,g=(a?h[0]:h).length,_=function(e,t){return a?h[e][t]:h[t][e]};switch(e){case n:case t:for(;u>0&&c===_(p,u);)u--;u<0&&(u=0);break;case r:case i:for(;u<g&&c===_(p,u);)u++;u===g&&(u=g-1);break;case s:for(;p<m&&c===_(p,u);)p++;p===m&&(p=m-1);break;case o:for(;p>=0&&c===_(p,u);)p--;p<0&&(p=0);break;default:return void this.callBase.apply(this,arguments)}var f=_(p,u);if((0,d.$K)(f)){var C=this._itemElements().eq(f);this.option("focusedElement",(0,Ue.u)(C)),this._scrollToItem(C)}},_scrollToItem:function(e){if(e.length){var t=this._config,i="outer"+(0,So.GK)(t.mainDimension),o=this.option("itemMargin"),s=e.position()[t.mainPosition],n=e[i](),r=s+n,a=this.scrollPosition(),l=this.$element()[i]();a<=s&&r<=a+l||this._scrollView.scrollTo(a>s?s-o:s+n-l+o)}},_optionChanged:function(e){switch(e.name){case"items":this.callBase(e),this._renderGeometry(),this._updateScrollView();break;case"showScrollbar":this._initScrollView();break;case"disabled":this._scrollView.option("disabled",e.value),this.callBase(e);break;case"baseItemWidth":case"baseItemHeight":case"itemMargin":this._renderGeometry();break;case"width":case"height":this.callBase(e),this._renderGeometry(),this._updateScrollView();break;case"direction":this._renderGeometry(),this._updateScrollView();break;case"indicateLoading":this._hideLoadingIfLoadIndicationOff();break;default:this.callBase(e)}},scrollPosition:function(){return this._scrollView.scrollOffset()[this._config.mainPosition]}});(0,m.Z)("dxTileView",wo);const Mo=wo;let To=(()=>{let e=class extends zi.Ay{constructor(e,t,i,o,s,n,r,a){super(e,t,i,o,r,a),this._watcherHelper=o,this._idh=s,this._createEventEmitters([{subscribe:"contentReady",emit:"onContentReady"},{subscribe:"disposing",emit:"onDisposing"},{subscribe:"initialized",emit:"onInitialized"},{subscribe:"itemClick",emit:"onItemClick"},{subscribe:"itemContextMenu",emit:"onItemContextMenu"},{subscribe:"itemHold",emit:"onItemHold"},{subscribe:"itemRendered",emit:"onItemRendered"},{subscribe:"optionChanged",emit:"onOptionChanged"},{emit:"accessKeyChange"},{emit:"activeStateEnabledChange"},{emit:"baseItemHeightChange"},{emit:"baseItemWidthChange"},{emit:"dataSourceChange"},{emit:"directionChange"},{emit:"disabledChange"},{emit:"elementAttrChange"},{emit:"focusStateEnabledChange"},{emit:"heightChange"},{emit:"hintChange"},{emit:"hoverStateEnabledChange"},{emit:"itemHoldTimeoutChange"},{emit:"itemMarginChange"},{emit:"itemsChange"},{emit:"itemTemplateChange"},{emit:"noDataTextChange"},{emit:"rtlEnabledChange"},{emit:"showScrollbarChange"},{emit:"tabIndexChange"},{emit:"visibleChange"},{emit:"widthChange"}]),this._idh.setHost(this),n.setHost(this)}get accessKey(){return this._getOption("accessKey")}set accessKey(e){this._setOption("accessKey",e)}get activeStateEnabled(){return this._getOption("activeStateEnabled")}set activeStateEnabled(e){this._setOption("activeStateEnabled",e)}get baseItemHeight(){return this._getOption("baseItemHeight")}set baseItemHeight(e){this._setOption("baseItemHeight",e)}get baseItemWidth(){return this._getOption("baseItemWidth")}set baseItemWidth(e){this._setOption("baseItemWidth",e)}get dataSource(){return this._getOption("dataSource")}set dataSource(e){this._setOption("dataSource",e)}get direction(){return this._getOption("direction")}set direction(e){this._setOption("direction",e)}get disabled(){return this._getOption("disabled")}set disabled(e){this._setOption("disabled",e)}get elementAttr(){return this._getOption("elementAttr")}set elementAttr(e){this._setOption("elementAttr",e)}get focusStateEnabled(){return this._getOption("focusStateEnabled")}set focusStateEnabled(e){this._setOption("focusStateEnabled",e)}get height(){return this._getOption("height")}set height(e){this._setOption("height",e)}get hint(){return this._getOption("hint")}set hint(e){this._setOption("hint",e)}get hoverStateEnabled(){return this._getOption("hoverStateEnabled")}set hoverStateEnabled(e){this._setOption("hoverStateEnabled",e)}get itemHoldTimeout(){return this._getOption("itemHoldTimeout")}set itemHoldTimeout(e){this._setOption("itemHoldTimeout",e)}get itemMargin(){return this._getOption("itemMargin")}set itemMargin(e){this._setOption("itemMargin",e)}get items(){return this._getOption("items")}set items(e){this._setOption("items",e)}get itemTemplate(){return this._getOption("itemTemplate")}set itemTemplate(e){this._setOption("itemTemplate",e)}get noDataText(){return this._getOption("noDataText")}set noDataText(e){this._setOption("noDataText",e)}get rtlEnabled(){return this._getOption("rtlEnabled")}set rtlEnabled(e){this._setOption("rtlEnabled",e)}get showScrollbar(){return this._getOption("showScrollbar")}set showScrollbar(e){this._setOption("showScrollbar",e)}get tabIndex(){return this._getOption("tabIndex")}set tabIndex(e){this._setOption("tabIndex",e)}get visible(){return this._getOption("visible")}set visible(e){this._setOption("visible",e)}get width(){return this._getOption("width")}set width(e){this._setOption("width",e)}get itemsChildren(){return this._getOption("items")}set itemsChildren(e){this.setChildren("items",e)}_createInstance(e,t){return new Mo(e,t)}ngOnDestroy(){this._destroyWidget()}ngOnChanges(e){super.ngOnChanges(e),this.setupChanges("dataSource",e),this.setupChanges("items",e)}setupChanges(e,t){e in this._optionsToUpdate||this._idh.setup(e,t)}ngDoCheck(){this._idh.doCheck("dataSource"),this._idh.doCheck("items"),this._watcherHelper.checkWatchers(),super.ngDoCheck(),super.clearChangedOptions()}_setOption(e,t){let i=this._idh.setupSingle(e,t),o=null!==this._idh.getChanges(e,t);(i||o)&&super._setOption(e,t)}};return e.\u0275fac=function(t){return new(t||e)(a.Y36(a.SBq),a.Y36(a.R0b),a.Y36(zi._5),a.Y36(zi._h),a.Y36(zi.i9),a.Y36(zi.al),a.Y36(r.ki),a.Y36(a.Lbi))},e.\u0275cmp=a.Xpm({type:e,selectors:[["dx-tile-view"]],contentQueries:function(e,t,i){if(1&e&&a.Suo(i,$i.ZT3,4),2&e){let e;a.iGM(e=a.CRH())&&(t.itemsChildren=e)}},inputs:{accessKey:"accessKey",activeStateEnabled:"activeStateEnabled",baseItemHeight:"baseItemHeight",baseItemWidth:"baseItemWidth",dataSource:"dataSource",direction:"direction",disabled:"disabled",elementAttr:"elementAttr",focusStateEnabled:"focusStateEnabled",height:"height",hint:"hint",hoverStateEnabled:"hoverStateEnabled",itemHoldTimeout:"itemHoldTimeout",itemMargin:"itemMargin",items:"items",itemTemplate:"itemTemplate",noDataText:"noDataText",rtlEnabled:"rtlEnabled",showScrollbar:"showScrollbar",tabIndex:"tabIndex",visible:"visible",width:"width"},outputs:{onContentReady:"onContentReady",onDisposing:"onDisposing",onInitialized:"onInitialized",onItemClick:"onItemClick",onItemContextMenu:"onItemContextMenu",onItemHold:"onItemHold",onItemRendered:"onItemRendered",onOptionChanged:"onOptionChanged",accessKeyChange:"accessKeyChange",activeStateEnabledChange:"activeStateEnabledChange",baseItemHeightChange:"baseItemHeightChange",baseItemWidthChange:"baseItemWidthChange",dataSourceChange:"dataSourceChange",directionChange:"directionChange",disabledChange:"disabledChange",elementAttrChange:"elementAttrChange",focusStateEnabledChange:"focusStateEnabledChange",heightChange:"heightChange",hintChange:"hintChange",hoverStateEnabledChange:"hoverStateEnabledChange",itemHoldTimeoutChange:"itemHoldTimeoutChange",itemMarginChange:"itemMarginChange",itemsChange:"itemsChange",itemTemplateChange:"itemTemplateChange",noDataTextChange:"noDataTextChange",rtlEnabledChange:"rtlEnabledChange",showScrollbarChange:"showScrollbarChange",tabIndexChange:"tabIndexChange",visibleChange:"visibleChange",widthChange:"widthChange"},features:[a._Bn([zi._5,zi._h,zi.al,zi.i9]),a.qOj,a.TTD],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e=(0,n.gn)([(0,n.fM)(7,(0,a.tBr)(a.Lbi)),(0,n.w6)("design:paramtypes",[a.SBq,a.R0b,zi._5,zi._h,zi.i9,zi.al,r.ki,Object])],e),e})(),Oo=(()=>{let e=class{};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[$i.Q8p,zi.Lz,zi.ie,r.Cu],$i.Q8p,zi.ie]}),e})();function Po(e,t){if(1&e&&(a.TgZ(0,"div",14),a.TgZ(1,"p",15),a.TgZ(2,"b"),a._uU(3),a.qZA(),a.qZA(),a.TgZ(4,"p",15),a._uU(5," Size: "),a.TgZ(6,"i"),a._uU(7),a.qZA(),a.qZA(),a.TgZ(8,"div",16),a._UZ(9,"img",17),a.qZA(),a.qZA()),2&e){const e=t.$implicit;a.xp6(3),a.hij("Name: ",null==e?null:e.fileName,""),a.xp6(4),a.hij("",null==e?null:e.fileSize," byte"),a.xp6(2),a.Q6J("src",null==e?null:e.url,a.LSH)}}function Fo(e,t){if(1&e&&(a.TgZ(0,"div"),a.TgZ(1,"div",18),a._uU(2),a.qZA(),a.qZA()),2&e){const e=a.oxw();a.xp6(2),a.hij(" ",e.directory," ")}}function Eo(e,t){if(1&e){const e=a.EpF();a.TgZ(0,"div"),a.TgZ(1,"div",19),a.TgZ(2,"input",20),a.NdJ("change",function(t){return a.CHM(e),a.oxw().handleInputChange(t)}),a.qZA(),a.qZA(),a.qZA()}2&e&&(a.xp6(2),a.Q6J("multiple",!0))}const Ao=function(e,t){return{"photo-popup-content":e,"photo-popup-loading":t}},ko=function(){return["upload-form"]};let Zo=(()=>{class e{constructor(e,t){this.fileStore=e,this.store=t,this.submitButtonOptions={text:"Submit",icon:"save",type:"normal",useSubmitBehavior:!0},this.resetButtonOptions={text:"Reset",icon:"refresh",type:"normal",useSubmitBehavior:!1,onClick:this.resetValues.bind(this)},this.fileList=[],this.imageList=[],this.pageSize=100,this.tempUrl=[],this.onSubmit=e=>{e.preventDefault(),this.fileList.length?(this.fileStore.uploadFiles(this.fileList),this.resetValues()):this.store.showNotif("Please select a file","custom")}}handleInputChange(e){var t=e.dataTransfer?e.dataTransfer.files:e.target.files;if(console.log(t),0!==t.length)for(let o=0;o<t.length;o++){const e=t[o];if(console.log(e),e.size<=2e7){var i=new FileReader;i.onload=this.handleReaderLoaded.bind(this),i.readAsDataURL(e);const t={sourceID:"7d87bb3b-6eec-649e-42c2-eb6dabb6355a",category:this.directory,container:this.directory,fileName:e.name,title:e.name,fileType:e.type,fileSize:e.size};this.imageList=this.imageList.concat({sourceID:"",category:this.directory,container:this.directory,title:e.name,fileName:e.name,fileSize:e.size,fileType:e.type,url:""}),this.fileList=this.fileList.concat(t)}else this.store.showNotif("Image cannot exceed 2MB","custom")}}lazyInsertImage(){for(let e=0;e<this.tempUrl.length;e++){const t=this.tempUrl[e];this.imageList[e].url=t,this.fileList[e].data=t.split(",")[1]}console.log(this.imageList),console.log(this.fileList)}handleReaderLoaded(e){this.tempUrl.push(e.target.result),this.lazyInsertImage()}resetValues(){this.fileList=[],this.imageList=[],this.tempUrl=[]}isUploadingFilesListener(){return this.fileStore.$isUploadingFiles.subscribe(e=>{this.isUploading=e})}ngOnInit(){this.isUploadingFilesListener(),this.resetValues()}ngOnChanges(){this.resetValues()}ngOnDestroy(){this.isUploadingFilesListener().unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(Gi.V),a.Y36(qi.d))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-upload-batch"]],viewQuery:function(e,t){if(1&e&&a.Gf(Wi.Y,5),2&e){let e;a.iGM(e=a.CRH())&&(t.dxForm=e.first)}},inputs:{directory:"directory"},features:[a.TTD],decls:16,vars:19,consts:[[3,"ngClass"],["itemTemplate","uploadedImages",3,"dataSource","baseItemHeight","baseItemWidth","itemMargin","width","height","direction"],["class","tile",4,"dxTemplate","dxTemplateOf"],[1,"container"],["id","form-container",3,"classList","submit"],["id","form","validationGroup","uploadBatch",3,"showValidationSummary"],["itemType","group"],["itemType","group","caption","Batch Upload"],["name","directory"],["text","Current Directory"],[4,"dxTemplate"],["name","file"],["itemType","group",3,"colCount","cssClass"],["itemType","button","horizontalAlignment","center",3,"buttonOptions"],[1,"tile"],[2,"font-size","small"],[1,"img-container"],[3,"src"],[2,"font-size","large"],[1,"file-container"],["type","file","id","file",1,"file-input",3,"multiple","change"]],template:function(e,t){1&e&&(a.TgZ(0,"div",0),a.TgZ(1,"dx-tile-view",1),a.YNc(2,Po,10,3,"div",2),a.qZA(),a.TgZ(3,"div",3),a.TgZ(4,"form",4),a.NdJ("submit",function(e){return t.onSubmit(e)}),a.TgZ(5,"dx-form",5),a.TgZ(6,"dxi-item",6),a.TgZ(7,"dxi-item",7),a.TgZ(8,"dxi-item",8),a._UZ(9,"dxo-label",9),a.YNc(10,Fo,3,1,"div",10),a.qZA(),a.TgZ(11,"dxi-item",11),a.YNc(12,Eo,3,1,"div",10),a.qZA(),a.TgZ(13,"dxi-item",12),a._UZ(14,"dxi-item",13),a._UZ(15,"dxi-item",13),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&e&&(a.Q6J("ngClass",a.WLB(15,Ao,!1===t.isUploading,!0===t.isUploading)),a.xp6(1),a.Q6J("dataSource",t.imageList)("baseItemHeight",250)("baseItemWidth",200)("itemMargin",10)("width","100%")("height","100%")("direction","vertical"),a.xp6(1),a.Q6J("dxTemplateOf","uploadedImages"),a.xp6(2),a.Q6J("classList",a.DdM(18,ko)),a.xp6(1),a.Q6J("showValidationSummary",!0),a.xp6(8),a.Q6J("colCount",2)("cssClass","buttonGroup"),a.xp6(1),a.Q6J("buttonOptions",t.submitButtonOptions),a.xp6(1),a.Q6J("buttonOptions",t.resetButtonOptions))},directives:[o.mk,To,zi.p6,Wi.Y,$i.ZT3,$i.sBj],styles:['.img-container[_ngcontent-%COMP%]{display:flex;justify-content:center;height:70%;width:70%;align-items:center;margin:10px}.info-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:10px}.info-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:700;border-bottom:2px solid orchid}.tile[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;border-radius:5px;box-shadow:inset 0 -23px 25px 0 #0000002b,inset 0 -36px 30px 0 #00000026,inset 0 -79px 40px 0 #0000001a,0 2px 1px #0000000f,0 4px 2px #00000017,0 8px 4px #00000017,0 16px 8px #00000017,0 32px 16px #00000017}@media screen and (max-width:450px){.photo-popup-content[_ngcontent-%COMP%], .photo-popup-loading[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-evenly;align-items:flex-start;font-size:large}.photo-popup-loading[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.514);filter:blur(2rem);animation:color-change 3s infinite}.info-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;height:100%;width:100%;align-items:flex-start;margin-bottom:5px}.img-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100px;width:100px;border-radius:5px;box-shadow:0 25px 50px -12px #4fcdff40}}@media screen and (min-width:451px){.photo-popup-content[_ngcontent-%COMP%], .photo-popup-loading[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-evenly;align-items:flex-start;font-size:large}.photo-popup-loading[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.514);filter:blur(2rem);animation:color-change 3s infinite alternate}.info-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;height:100%;width:30%;align-items:flex-start;margin-bottom:5px}.img-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:70%;border-radius:5px;box-shadow:0 25px 50px -12px #4fcdff40}}.file-input[_ngcontent-%COMP%]{color:#0000;width:65px}.file-input[_ngcontent-%COMP%]::-webkit-file-upload-button{visibility:hidden}.file-input[_ngcontent-%COMP%]:before{content:"Upload";display:inline-block;border:1px solid #999;border-radius:3px;padding:5px 8px;outline:none;white-space:nowrap;-webkit-user-select:none;user-select:none;cursor:pointer;text-shadow:1px 1px #fff;font-weight:700;font-size:15px}.file-input[_ngcontent-%COMP%]:hover:before{border-color:#fcffff}.file-input[_ngcontent-%COMP%]:active:before{background:-webkit-linear-gradient(top,#e3e3e3,#f9f9f9)}@keyframes color-change{0%{background-color:red}to{background-color:blue}}']}),e})();const Bo=function(e,t){return{"folder-popup-content":e,"folder-popup-loading":t}},Uo=function(){return["upload-folder-form"]},Vo=function(){return{text:"Folder Name"}};let Ko=(()=>{class e{constructor(e,t){this.store=e,this.fileStore=t,this.submitButtonOptions={text:"Submit",icon:"save",type:"normal",useSubmitBehavior:!0},this.resetButtonOptions={text:"Reset",icon:"refresh",type:"normal",useSubmitBehavior:!1,onClick:this.resetValues.bind(this)},this.containerData={name:"",parentDir:this.directory},this.onSubmit=e=>{e.preventDefault(),this.fileStore.uploadContainer(this.containerData),this.resetValues()}}isUploadingListener(){return this.fileStore.$isUploadingFolder.subscribe(e=>{this.isUploading=e})}resetValues(){this.containerData={name:"",parentDir:this.directory}}ngOnInit(){this.isUploadingListener()}ngOnChanges(){this.resetValues()}ngOnDestroy(){this.isUploadingListener().unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(qi.d),a.Y36(Gi.V))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-upload-folder"]],viewQuery:function(e,t){if(1&e&&a.Gf(Wi.Y,5),2&e){let e;a.iGM(e=a.CRH())&&(t.dxForm=e.first)}},inputs:{directory:"directory",selectedItem:"selectedItem"},features:[a.TTD],decls:11,vars:14,consts:[[3,"ngClass"],[1,"container"],["id","form-upload-folder-container",3,"classList","submit"],["id","form-upload-folder","validationGroup","uploadFolder",3,"formData","showValidationSummary"],["itemType","group"],["itemType","group","caption","Type in name"],["dataField","name","editorType","dxTextBox",3,"label"],["type","required","message","Folder name is required"],["itemType","group",3,"colCount","cssClass"],["itemType","button","horizontalAlignment","center",3,"buttonOptions"]],template:function(e,t){1&e&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"form",2),a.NdJ("submit",function(e){return t.onSubmit(e)}),a.TgZ(3,"dx-form",3),a.TgZ(4,"dxi-item",4),a.TgZ(5,"dxi-item",5),a.TgZ(6,"dxi-item",6),a._UZ(7,"dxi-validation-rule",7),a.qZA(),a.TgZ(8,"dxi-item",8),a._UZ(9,"dxi-item",9),a._UZ(10,"dxi-item",9),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&e&&(a.Q6J("ngClass",a.WLB(9,Bo,!1===t.isUploading,!0===t.isUploading)),a.xp6(2),a.Q6J("classList",a.DdM(12,Uo)),a.xp6(1),a.Q6J("formData",t.containerData)("showValidationSummary",!0),a.xp6(3),a.Q6J("label",a.DdM(13,Vo)),a.xp6(2),a.Q6J("colCount",2)("cssClass","buttonGroup"),a.xp6(1),a.Q6J("buttonOptions",t.submitButtonOptions),a.xp6(1),a.Q6J("buttonOptions",t.resetButtonOptions))},directives:[o.mk,Wi.Y,$i.ZT3,$i.vrV],styles:["@media screen and (max-width:450px){.folder-popup-content[_ngcontent-%COMP%]{font-size:large}.folder-popup-loading[_ngcontent-%COMP%]{font-size:large;background-color:rgba(0,0,0,.514);filter:blur(2rem);animation:color-change 3s infinite}}@media screen and (min-width:451px){.folder-popup-content[_ngcontent-%COMP%]{font-size:large}.folder-popup-loading[_ngcontent-%COMP%]{font-size:large;background-color:rgba(0,0,0,.514);filter:blur(2rem);animation:color-change 3s infinite alternate}}@keyframes color-change{0%{background-color:red}to{background-color:blue}}"]}),e})();const Lo=function(e,t){return{"folder-popup-content":e,"folder-popup-loading":t}},Ro=function(){return{text:"Folder Name"}};let zo=(()=>{class e{constructor(e){this.fileStore=e,this.selectedItem="",this.submitButtonOptions={text:"Submit",icon:"save",type:"normal",useSubmitBehavior:!0},this.resetButtonOptions={text:"Reset",icon:"refresh",type:"normal",useSubmitBehavior:!1,onClick:this.resetValues.bind(this)},this.containerData={name:""},this.onSubmit=e=>{e.preventDefault(),this.fileStore.updateContainer(this.selectedItem,this.containerData.name),this.resetValues()}}isUploadingListener(){return this.fileStore.$isUpdatingFolder.subscribe(e=>{this.isUploading=e})}resetValues(){this.containerData={name:this.selectedItem}}ngOnInit(){this.isUploadingListener()}ngOnChanges(){this.resetValues()}ngOnDestroy(){this.isUploadingListener().unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(Gi.V))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-update-folder"]],viewQuery:function(e,t){if(1&e&&a.Gf(Wi.Y,5),2&e){let e;a.iGM(e=a.CRH())&&(t.dxForm=e.first)}},inputs:{selectedItem:"selectedItem"},features:[a.TTD],decls:11,vars:12,consts:[[3,"ngClass"],[1,"container"],["id","form-container",3,"submit"],["id","form","validationGroup","renameFolder",3,"formData","showValidationSummary"],["itemType","group"],["itemType","group","caption","Type in new name"],["dataField","name","editorType","dxTextBox",3,"label"],["type","required","message","Folder name is required"],["itemType","group",3,"colCount","cssClass"],["itemType","button","horizontalAlignment","center",3,"buttonOptions"]],template:function(e,t){1&e&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"form",2),a.NdJ("submit",function(e){return t.onSubmit(e)}),a.TgZ(3,"dx-form",3),a.TgZ(4,"dxi-item",4),a.TgZ(5,"dxi-item",5),a.TgZ(6,"dxi-item",6),a._UZ(7,"dxi-validation-rule",7),a.qZA(),a.TgZ(8,"dxi-item",8),a._UZ(9,"dxi-item",9),a._UZ(10,"dxi-item",9),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&e&&(a.Q6J("ngClass",a.WLB(8,Lo,!1===t.isUploading,!0===t.isUploading)),a.xp6(3),a.Q6J("formData",t.containerData)("showValidationSummary",!0),a.xp6(3),a.Q6J("label",a.DdM(11,Ro)),a.xp6(2),a.Q6J("colCount",2)("cssClass","buttonGroup"),a.xp6(1),a.Q6J("buttonOptions",t.submitButtonOptions),a.xp6(1),a.Q6J("buttonOptions",t.resetButtonOptions))},directives:[o.mk,Wi.Y,$i.ZT3,$i.vrV],styles:["@media screen and (max-width:450px){.folder-popup-content[_ngcontent-%COMP%]{font-size:large}.folder-popup-loading[_ngcontent-%COMP%]{font-size:large;background-color:rgba(0,0,0,.514);filter:blur(2rem);animation:color-change 3s infinite}}@media screen and (min-width:451px){.folder-popup-content[_ngcontent-%COMP%]{font-size:large}.folder-popup-loading[_ngcontent-%COMP%]{font-size:large;background-color:rgba(0,0,0,.514);filter:blur(2rem);animation:color-change 3s infinite alternate}}@keyframes color-change{0%{background-color:red}to{background-color:blue}}"]}),e})();function $o(e,t){1&e&&(a.ynx(0),a._UZ(1,"dxi-column",20),a._UZ(2,"dxi-column",21),a._UZ(3,"dxi-column",22),a._UZ(4,"dxi-column",23),a._UZ(5,"dxi-column",24),a.BQk()),2&e&&(a.xp6(1),a.Q6J("width",150),a.xp6(2),a.Q6J("width",120),a.xp6(1),a.Q6J("width",120))}function No(e,t){1&e&&(a.ynx(0),a._UZ(1,"dxi-column",25),a._UZ(2,"dxi-column",26),a._UZ(3,"dxi-column",24),a.BQk()),2&e&&(a.xp6(1),a.Q6J("width",150))}function Ho(e,t){if(1&e&&a._UZ(0,"dxi-item",9),2&e){const e=a.oxw(2);a.Q6J("options",e.deleteFolderMenuOptions)}}function qo(e,t){if(1&e&&a._UZ(0,"dxi-item",9),2&e){const e=a.oxw(2);a.Q6J("options",e.renameFolderMenuOptions)}}function Go(e,t){if(1&e&&a._UZ(0,"dxi-item",9),2&e){const e=a.oxw(2);a.Q6J("options",e.cloneFolderMenuOptions)}}function jo(e,t){if(1&e&&(a.ynx(0),a._UZ(1,"dxi-item",9),a.BQk()),2&e){const e=a.oxw(2);a.xp6(1),a.Q6J("options",e.newFilesMenuOptions)}}function Qo(e,t){if(1&e&&(a.ynx(0),a._UZ(1,"dxi-item",9),a._UZ(2,"dxi-item",9),a.BQk()),2&e){const e=a.oxw(3);a.xp6(1),a.Q6J("options",e.pasteMenuOptions),a.xp6(1),a.Q6J("options",e.clearClipboardMenuOptions)}}function Jo(e,t){if(1&e&&(a.ynx(0),a._UZ(1,"dxi-file-selection-item",8),a._UZ(2,"dxi-file-selection-item",9),a._UZ(3,"dxi-file-selection-item",9),a._UZ(4,"dxi-file-selection-item",9),a._UZ(5,"dxi-file-selection-item",9),a._UZ(6,"dxi-file-selection-item",9),a.YNc(7,Qo,3,2,"ng-container",0),a._UZ(8,"dxi-file-selection-item",27),a.BQk()),2&e){const e=a.oxw(2);a.xp6(2),a.Q6J("options",e.deleteMenuOptions),a.xp6(1),a.Q6J("options",e.updateMenuOptions),a.xp6(1),a.Q6J("options",e.downloadZipMenuOptions),a.xp6(1),a.Q6J("options",e.copyMenuOptions),a.xp6(1),a.Q6J("options",e.moveMenuOptions),a.xp6(1),a.Q6J("ngIf",!0===e.isCopying||!0===e.isMoving)}}function Wo(e,t){1&e&&(a.ynx(0),a._UZ(1,"dxi-item",29),a._UZ(2,"dxi-item",30),a.BQk())}function Yo(e,t){if(1&e&&(a.ynx(0),a._UZ(1,"dxi-item",28),a.YNc(2,Wo,3,0,"ng-container",0),a.BQk()),2&e){const e=a.oxw(2);a.xp6(2),a.Q6J("ngIf",""!==e.currentDirectory)}}function Xo(e,t){1&e&&(a.ynx(0),a._UZ(1,"dxi-item",31),a._UZ(2,"dxi-item",32),a._UZ(3,"dxi-item",33),a._UZ(4,"dxi-item",34),a._UZ(5,"dxi-item",35),a.BQk())}function es(e,t){if(1&e&&(a.TgZ(0,"div"),a.TgZ(1,"dx-scroll-view",36),a.TgZ(2,"div",37),a.TgZ(3,"div",38),a._UZ(4,"img",39),a.qZA(),a.TgZ(5,"div",40),a.TgZ(6,"p"),a._uU(7,"Detail Information"),a.qZA(),a.TgZ(8,"div"),a._uU(9),a.qZA(),a.TgZ(10,"div"),a._uU(11),a.qZA(),a.TgZ(12,"div"),a._uU(13),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&e){const e=a.oxw(2);a.xp6(1),a.Q6J("bounceEnabled",!0)("scrollByContent",!0)("scrollByThumb",!0)("height","100%")("width","100%"),a.xp6(3),a.Q6J("src",null==e.currentFile?null:e.currentFile.thumbnail,a.LSH),a.xp6(5),a.hij("Title: ",null==e.currentFile?null:e.currentFile.dataItem.title,""),a.xp6(2),a.hij("Type: ",null==e.currentFile?null:e.currentFile.dataItem.type,""),a.xp6(2),a.hij("Size: ",null==e.currentFile?null:e.currentFile.dataItem.size," byte")}}function ts(e,t){if(1&e&&(a.TgZ(0,"div"),a.TgZ(1,"dx-scroll-view",36),a._UZ(2,"app-update-file",41),a.qZA(),a.qZA()),2&e){const e=a.oxw(2);a.xp6(1),a.Q6J("bounceEnabled",!0)("scrollByContent",!0)("scrollByThumb",!0)("height","100%")("width","100%"),a.xp6(1),a.Q6J("selectedItem",e.selectedItem)}}function is(e,t){if(1&e&&(a.TgZ(0,"div"),a.TgZ(1,"dx-scroll-view",36),a._UZ(2,"app-rename-file",41),a.qZA(),a.qZA()),2&e){const e=a.oxw(2);a.xp6(1),a.Q6J("bounceEnabled",!0)("scrollByContent",!0)("scrollByThumb",!0)("height","100%")("width","100%"),a.xp6(1),a.Q6J("selectedItem",e.selectedItem)}}function os(e,t){if(1&e&&(a.TgZ(0,"div"),a.TgZ(1,"dx-scroll-view",36),a._UZ(2,"app-upload-batch",42),a.qZA(),a.qZA()),2&e){const e=a.oxw(2);a.xp6(1),a.Q6J("bounceEnabled",!0)("scrollByContent",!0)("scrollByThumb",!0)("height","100%")("width","100%"),a.xp6(1),a.Q6J("directory",e.currentDirectory)}}function ss(e,t){if(1&e&&(a.TgZ(0,"div"),a.TgZ(1,"dx-scroll-view",36),a._UZ(2,"app-upload-folder",43),a.qZA(),a.qZA()),2&e){const e=a.oxw(2);a.xp6(1),a.Q6J("bounceEnabled",!0)("scrollByContent",!0)("scrollByThumb",!0)("height","100%")("width","100%"),a.xp6(1),a.Q6J("directory",e.currentDirectory)("selectedItem",e.currentDirectory)}}function ns(e,t){if(1&e&&(a.TgZ(0,"div"),a.TgZ(1,"dx-scroll-view",36),a._UZ(2,"app-update-folder",41),a.qZA(),a.qZA()),2&e){const e=a.oxw(2);a.xp6(1),a.Q6J("bounceEnabled",!0)("scrollByContent",!0)("scrollByThumb",!0)("height","100%")("width","100%"),a.xp6(1),a.Q6J("selectedItem",e.currentDirectory)}}function rs(e,t){if(1&e){const e=a.EpF();a.ynx(0),a.TgZ(1,"dx-file-manager",5),a.NdJ("onSelectedFileOpened",function(t){return a.CHM(e),a.oxw().displayImagePopup(t)})("onSelectionChanged",function(t){return a.CHM(e),a.oxw().onSelectionChanged(t)})("onToolbarItemClick",function(t){return a.CHM(e),a.oxw().onToolbarItemClick(t)})("onContextMenuItemClick",function(t){return a.CHM(e),a.oxw().onContextItemClick(t)})("onOptionChanged",function(t){return a.CHM(e),a.oxw().onOptionChanged(t)}),a.TgZ(2,"dxo-item-view",6),a.TgZ(3,"dxo-details"),a.YNc(4,$o,6,3,"ng-container",0),a.YNc(5,No,4,1,"ng-container",0),a.qZA(),a.qZA(),a.TgZ(6,"dxo-toolbar"),a._UZ(7,"dxi-item",7),a._UZ(8,"dxi-item",8),a._UZ(9,"dxi-item",9),a.YNc(10,Ho,1,1,"dxi-item",10),a.YNc(11,qo,1,1,"dxi-item",10),a.YNc(12,Go,1,1,"dxi-item",10),a.YNc(13,jo,2,1,"ng-container",0),a._UZ(14,"dxi-item",11),a._UZ(15,"dxi-item",12),a._UZ(16,"dxi-item",13),a.YNc(17,Jo,9,6,"ng-container",0),a.qZA(),a.TgZ(18,"dxo-context-menu"),a.YNc(19,Yo,3,1,"ng-container",0),a.YNc(20,Xo,6,0,"ng-container",0),a.qZA(),a.qZA(),a.TgZ(21,"dx-popup",14),a.NdJ("visibleChange",function(t){return a.CHM(e),a.oxw().isPopupVisible=t}),a.YNc(22,es,14,9,"div",2),a.qZA(),a.TgZ(23,"dx-popup",15),a.NdJ("visibleChange",function(t){return a.CHM(e),a.oxw().isUpdateFilePopupVisible=t}),a.YNc(24,ts,3,6,"div",2),a.qZA(),a.TgZ(25,"dx-popup",16),a.NdJ("visibleChange",function(t){return a.CHM(e),a.oxw().isRenameFilePopupVisible=t}),a.YNc(26,is,3,6,"div",2),a.qZA(),a.TgZ(27,"dx-popup",17),a.NdJ("visibleChange",function(t){return a.CHM(e),a.oxw().isUploadBatchPopupVisible=t}),a.YNc(28,os,3,6,"div",2),a.qZA(),a.TgZ(29,"dx-popup",18),a.NdJ("visibleChange",function(t){return a.CHM(e),a.oxw().isUploadContainerPopupVisible=t}),a.YNc(30,ss,3,7,"div",2),a.qZA(),a.TgZ(31,"dx-popup",19),a.NdJ("visibleChange",function(t){return a.CHM(e),a.oxw().isUpdateContainerPopupVisible=t}),a.YNc(32,ns,3,6,"div",2),a.qZA(),a.BQk()}if(2&e){const e=a.oxw();a.xp6(1),a.Q6J("fileSystemProvider",e.fileItems),a.xp6(1),a.Q6J("showParentFolder",!1),a.xp6(2),a.Q6J("ngIf",e.isItemMode),a.xp6(1),a.Q6J("ngIf",!e.isItemMode),a.xp6(4),a.Q6J("options",e.newContainerMenuOptions),a.xp6(1),a.Q6J("ngIf",""!==e.currentDirectory),a.xp6(1),a.Q6J("ngIf",""!==e.currentDirectory),a.xp6(1),a.Q6J("ngIf",""!==e.currentDirectory),a.xp6(1),a.Q6J("ngIf",""!==e.currentDirectory),a.xp6(1),a.Q6J("options",e.refreshMenuOptions),a.xp6(3),a.Q6J("ngIf",!1===e.isDirectorySelected),a.xp6(2),a.Q6J("ngIf",!0===e.isDirectorySelected),a.xp6(1),a.Q6J("ngIf",!1===e.isDirectorySelected),a.xp6(1),a.Q6J("height","90%")("width","70%")("showTitle",!0)("shading",!0)("showCloseButton",!0)("title",null==e.currentFile?null:e.currentFile.dataItem.name)("visible",e.isPopupVisible),a.xp6(1),a.Q6J("dxTemplateOf","content"),a.xp6(1),a.Q6J("height","90%")("width","90%")("showTitle",!0)("shading",!0)("showCloseButton",!0)("title","Link Source")("visible",e.isUpdateFilePopupVisible),a.xp6(1),a.Q6J("dxTemplateOf","content"),a.xp6(1),a.Q6J("height","60%")("width","80%")("showTitle",!0)("shading",!0)("showCloseButton",!0)("title","Rename File")("visible",e.isRenameFilePopupVisible),a.xp6(1),a.Q6J("dxTemplateOf","content"),a.xp6(1),a.Q6J("height","90%")("width","90%")("showTitle",!0)("shading",!0)("showCloseButton",!0)("title","Upload Batch")("visible",e.isUploadBatchPopupVisible),a.xp6(1),a.Q6J("dxTemplateOf","content"),a.xp6(1),a.Q6J("height","70%")("width","70%")("showTitle",!0)("shading",!0)("showCloseButton",!0)("title","New Folder")("visible",e.isUploadContainerPopupVisible),a.xp6(1),a.Q6J("dxTemplateOf","content"),a.xp6(1),a.Q6J("height","70%")("width","70%")("showTitle",!0)("shading",!0)("showCloseButton",!0)("title","Rename Folder")("visible",e.isUpdateContainerPopupVisible),a.xp6(1),a.Q6J("dxTemplateOf","content")}}function as(e,t){1&e&&(a.TgZ(0,"div"),a.TgZ(1,"dx-scroll-view",36),a.TgZ(2,"div",44),a.TgZ(3,"p"),a._uU(4,"'F2': Rename Folder/ Update a file"),a.qZA(),a.TgZ(5,"p"),a._uU(6,"'Escape': Clear clipboard"),a.qZA(),a.TgZ(7,"p"),a._uU(8,"'Control' + 'C': Copy file(s)/ Clone folder"),a.qZA(),a.TgZ(9,"p"),a._uU(10,"'Control' + 'X': Move file(s)"),a.qZA(),a.TgZ(11,"p"),a._uU(12,"'Control' + 'V': Paste file(s)"),a.qZA(),a.TgZ(13,"p"),a._uU(14,"'Delete': Delete file(s)/ folder"),a.qZA(),a.TgZ(15,"p"),a._uU(16,"'Pageup': Upload a file"),a.qZA(),a.TgZ(17,"p"),a._uU(18,"'Insert': Upload batch"),a.qZA(),a.TgZ(19,"p"),a._uU(20,"'Control' + 'ArrowUp': New Folder"),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&e&&(a.xp6(1),a.Q6J("bounceEnabled",!0)("scrollByContent",!0)("scrollByThumb",!0)("height","100%")("width","100%"))}const ls=[{path:"",component:(()=>{class e{constructor(e,t,i){this.router=e,this.store=t,this.fileStore=i,this.keyCombination=[],this.isItemMode=!1,this.isDirectorySelected=!0,this.currentDirectory="",this.fileItems=[],this.tempCopyItems=[],this.uploadButtonOption={},this.fileList=[],this.selectedKeys=[],this.pageSize=5,this.newFilesMenuOptions={items:[{text:"Upload Batch",icon:"upload",hint:"Upload multiple files"}],onItemClick:this.uploadBatch.bind(this)},this.newContainerMenuOptions={items:[{text:"Create Folder",icon:"newfolder",hint:"Upload new folder"}],onItemClick:this.uploadContainer.bind(this)},this.refreshMenuOptions={items:[{text:"Refresh",icon:"refresh",hint:"Refresh folder directory"}],onItemClick:this.refresh.bind(this)},this.deleteMenuOptions={items:[{text:"Delete File",icon:"trash",hint:"Delete current file"}],onItemClick:this.deleteFiles.bind(this)},this.downloadZipMenuOptions={items:[{text:"Download Zip",icon:"download",hint:"Download as zip"}],onItemClick:this.downloadZip.bind(this)},this.copyMenuOptions={items:[{text:"Copy",icon:"copy",hint:"Copy selected items"}],onItemClick:this.copyFiles.bind(this)},this.pasteMenuOptions={items:[{text:"Paste",icon:"paste",hint:"Paste selected items"}],onItemClick:this.pasteFiles.bind(this)},this.clearClipboardMenuOptions={items:[{text:"Clear Clipboard",icon:"clear",hint:"Clear memory of clipboard"}],onItemClick:this.clearClipboard.bind(this)},this.moveMenuOptions={items:[{text:"Cut",icon:"cut",hint:"Cut selected items"}],onItemClick:this.moveFiles.bind(this)},this.updateMenuOptions={items:[{text:"Link Source",icon:"link",hint:"Edit current file"}],onItemClick:this.updateFile.bind(this)},this.deleteFolderMenuOptions={items:[{text:"Delete Folder",icon:"deletetable",hint:"Delete current folder"}],onItemClick:this.deleteSelectedContainer.bind(this)},this.renameFolderMenuOptions={items:[{text:"Rename Folder",icon:"edit",hint:"Rename current folder"}],onItemClick:this.updateContainer.bind(this)},this.containerList=[]}handleKeyboardEvent(e){e.preventDefault(),this.keyCombination.push(e.key),this.keyCombination.length>2&&(this.keyCombination=[]),this.handleOperation(this.keyCombination)}uploadContainer(){this.isUploadContainerPopupVisible=!0}updateContainer(){this.isUpdateContainerPopupVisible=!0}deleteSelectedContainer(){this.currentDirectory&&this.fileStore.confirmDialog(`Delete '${this.currentDirectory}' folder?`).then(e=>{e&&this.fileStore.deleteContainer([this.currentDirectory]).then(()=>{this.refreshFolder(),this.store.showNotif(`'${this.currentDirectory}' folder deleted`,"custom"),this.store.setIsLoading(!1),this.currentDirectory=""})})}renameFile(){""!==this.currentDirectory&&(this.isRenameFilePopupVisible=!0)}uploadBatch(){""===this.currentDirectory?this.store.showNotif("Please select a folder to upload file(s)","custom"):this.isUploadBatchPopupVisible=!0}deleteFiles(){""!==this.currentDirectory&&(0!==this.selectedKeys.length?this.fileStore.confirmDialog("Delete selected items?").then(e=>{e&&this.fileStore.deleteSelectedFiles(this.selectedKeys).then(()=>{this.refresh(),this.store.showNotif(`${this.selectedKeys.length} item deleted`,"custom"),this.store.setIsLoading(!1)})}):this.store.showNotif("Nothing to delete!","custom"))}clearClipboard(){this.tempCopyItems.length?(this.isMoving=!1,this.isCopying=!1,this.sourceDirectory="",this.tempCopyItems=[],this.store.showNotif("Clipboard cleared!","custom")):this.store.showNotif("No item is copied or cut!","custom")}copyFiles(){0!==this.selectedKeys.length?(this.isMoving=!1,this.isCopying=!0,this.sourceDirectory=this.currentDirectory,this.tempCopyItems=this.selectedKeys,this.store.showNotif(`Copied ${this.selectedKeys.length} item(s)`,"custom")):this.store.showNotif("No item selected!","custom")}moveFiles(){0!==this.selectedKeys.length?(this.isCopying=!1,this.isMoving=!0,this.sourceDirectory=this.currentDirectory,this.tempCopyItems=this.selectedKeys,this.store.showNotif(`Cut ${this.selectedKeys.length} item(s)`,"custom")):this.store.showNotif("No item selected!","custom")}pasteFiles(){if(0!==this.tempCopyItems.length)switch(this.checkEditorMode()){case"copy":this.performCopy();break;case"move":this.performMove()}}performCopy(){this.fileStore.confirmDialog(`Paste in ${this.currentDirectory} folder?`).then(e=>{e&&(this.isCopying=!1,this.fileStore.copySelectedFiles(this.tempCopyItems,this.currentDirectory).then(e=>{this.refresh(),this.store.showNotif(e.responseMessage,"custom"),this.store.setIsLoading(!1),this.tempCopyItems=[]}).catch(e=>{this.store.showNotif(e,"error")}))})}performMove(){this.fileStore.confirmDialog(`Paste in ${this.currentDirectory} folder?`).then(e=>{e&&(this.isMoving=!1,this.fileStore.moveSelectedFiles(this.tempCopyItems,this.currentDirectory).then(e=>{this.refresh(),this.store.showNotif(e.responseMessage,"custom"),this.store.setIsLoading(!1),this.tempCopyItems=[]}).catch(e=>{this.store.showNotif(e.responseMessage,"error")}))})}deleteSelectedImage(){""!==this.currentDirectory&&0!==this.selectedItemKey.length&&this.fileStore.confirmDialog("Delete this item?").then(e=>{e&&this.fileStore.deleteSelectedFiles([this.selectedItemKey]).then(()=>{this.refresh(),this.store.showNotif("1 item deleted","custom"),this.store.setIsLoading(!1)})})}updateFile(){""!==this.currentDirectory&&(this.isUpdateFilePopupVisible=!0)}downloadImage(){0!==this.selectedItemKey.length&&this.fileStore.confirmDialog("Download this item?").then(e=>{e&&this.fileStore.downloadFile(this.selectedItemKey)})}downloadZip(){0!==this.selectedKeys.length&&this.fileStore.confirmDialog("Download selected items as zip?").then(e=>{e&&this.fileStore.downloadFiles(this.selectedKeys)})}showKeyShortcut(){this.isKeyShortcutPopupVisible=!0}checkEditorMode(){return this.isCopying?"copy":this.isMoving?"move":""}refreshFolder(){this.fileStore.initInfiniteContainer().then(()=>{this.containerDataListener()})}refresh(){this.mapContainerToFolder(),setTimeout(()=>{this.loadFileByFolder()},500)}loadFileByFolder(){console.log(this.fileItems),this.fileList=[],""!==this.currentDirectory&&this.fileStore.initInfiniteDataByContainer(this.currentDirectory).then(()=>{this.mapFileToImage()})}onSelectionChanged(e){var t,i,o;console.log("SELECTION CHANGED"),console.log(e),this.selectedKeys=e.selectedItemKeys,this.selectedItemKey=e.currentSelectedItemKeys[0],e.selectedItems&&e.selectedItems.forEach(e=>{this.isDirectorySelected=e.isDirectory}),this.selectedItem=null===(t=e.selectedItems[0])||void 0===t?void 0:t.dataItem,!0===(null===(i=e.selectedItems[0])||void 0===i?void 0:i.isDirectory)&&(this.currentDirectory=null===(o=e.selectedItems[0])||void 0===o?void 0:o.dataItem.name),console.log("IS DIRECTORY SELECTED: ",this.isDirectorySelected)}onToolbarItemClick(e){console.log("TOOLBAR ITEM"),console.log(e)}onContextItemClick(e){switch(console.log("CONTEXT MENU ITEM"),console.log(e),e.itemData.name){case"downloadImage":this.downloadImage();break;case"renameFile":this.renameFile();break;case"deleteImage":this.deleteSelectedImage();break;case"updateFile":this.updateFile();break;case"newFolder":this.uploadContainer();break;case"deleteFolder":this.deleteSelectedContainer();break;case"updateFolder":this.updateContainer()}}onOptionChanged(e){console.log("OPTION CHANGED"),console.log(e),"currentPath"===e.fullName&&(this.isItemMode=""!==e.value,console.log("IS ITEM MODE: ",this.isItemMode),this.currentDirectory=e.value,this.loadFileByFolder())}displayImagePopup(e){this.currentFile=e.file,this.isPopupVisible=!0,console.log("OPENED FILE: "),console.log(e.file)}navigateToStatistics(){this.router.navigate(["/statistics"])}fileDataListener(){return this.fileStore.$fileList.subscribe(e=>{0!==e.length&&(this.fileList=e,console.log("FILE LIST OF FILE MANAGEMENT"),console.log(this.fileList))})}isUploadingFilesListener(){return this.fileStore.$isUploadingFiles.subscribe(e=>{this.isUploadBatchPopupVisible=e,!1===e&&this.refresh()})}isUpdatingFileListener(){return this.fileStore.$isUpdatingFile.subscribe(e=>{this.isUpdateFilePopupVisible=e,!1===e&&this.refresh()})}isRenamingFileListener(){return this.fileStore.$isRenamingFile.subscribe(e=>{this.isRenameFilePopupVisible=e,!1===e&&this.refresh()})}isUploadingBatchListener(){return this.fileStore.$isUploading.subscribe(e=>{this.isUploadBatchPopupVisible=e,!1===e&&this.refresh()})}isUploadingFolderListener(){return this.fileStore.$isUploadingFolder.subscribe(e=>{this.isUploadContainerPopupVisible=e,!1===this.isUploadContainerPopupVisible&&this.refreshFolder()})}isUpdatingFolderListener(){return this.fileStore.$isUpdatingFolder.subscribe(e=>{this.isUpdateContainerPopupVisible=e,!1===e&&this.refreshFolder()})}mapContainerToFolder(){var e,t;if(this.fileItems=[],0!==(null===(e=this.containerList)||void 0===e?void 0:e.length)){for(let e=0;e<(null===(t=this.containerList)||void 0===t?void 0:t.length);e++){const t=this.containerList[e];console.log(t),t.name&&this.fileItems.push({name:t.name,isDirectory:!0,items:[]})}setTimeout(()=>{this.dxFileManager.instance.refresh()},100)}}mapFileToImage(){const e=this.fileItems.findIndex(e=>e.name===this.currentDirectory);if(this.fileItems[e].items=[],console.log(`Folder for inserting item index: ${e}`),0!==this.fileList.length)for(let t=0;t<this.fileList.length;t++){const i=this.fileList[t];this.fileItems[e].items.push({type:i.fileType,__KEY__:i.id,name:i.fileName,title:i.title,isDirectory:!1,size:i.fileSize,thumbnail:i.url,id:i.id,sourceID:i.sourceID})}console.log(this.fileItems[e].items),console.log("CURRENT DX FILES"),console.log(this.fileItems),setTimeout(()=>{this.dxFileManager.instance.refresh()},500)}containerDataListener(){return this.fileStore.$containerList.subscribe(e=>{0!==(null==e?void 0:e.length)&&(this.containerList=e,this.mapContainerToFolder())})}overwriteKeyHandler(){var e;const t=["backspace","tab","enter","escape","pageUp","pageDown","end","home","leftArrow","upArrow","rightArrow","downArrow","del","space","F","A","asterisk","minus"];for(let i=0;i<t.length;i++){const o=t[i];null===(e=this.dxFileManager)||void 0===e||e.instance.registerKeyHandler(o,()=>{})}}handleOperation(e){console.log("COMBINATION"),console.log(e);const t=e.find(e=>"Escape"===e),i=e.find(e=>"Delete"===e)&&!1===this.isDirectorySelected,o=e.find(e=>"Control"===e)&&e.find(e=>"c"===e)&&!1===this.isDirectorySelected,s=e.find(e=>"Control"===e)&&e.find(e=>"x"===e)&&!1===this.isDirectorySelected,n=e.find(e=>"Control"===e)&&e.find(e=>"v"===e),r=e.find(e=>"F2"===e)&&!1===this.isDirectorySelected&&""!==this.currentDirectory,a=e.find(e=>"PageUp"===e&&!1===this.isDirectorySelected&&""!==this.currentDirectory),l=e.find(e=>"Insert"===e),h=e.find(e=>"F2"===e)&&!0===this.isDirectorySelected&&""!==this.currentDirectory,d=e.find(e=>"Control"===e)&&e.find(e=>"ArrowUp"===e),c=e.find(e=>"Delete"===e)&&!0===this.isDirectorySelected;t&&(this.clearClipboard(),this.keyCombination=[]),i&&(this.deleteFiles(),this.keyCombination=[]),a&&(this.updateFile(),this.keyCombination=[]),r&&(this.renameFile(),this.keyCombination=[]),l&&(this.uploadBatch(),this.keyCombination=[]),o&&(this.copyFiles(),this.keyCombination=[]),s&&(this.moveFiles(),this.keyCombination=[]),n&&(this.pasteFiles(),this.keyCombination=[]),h&&this.updateContainer(),d&&this.uploadContainer(),c&&this.deleteSelectedContainer(),a&&this.updateFile()}ngOnInit(){this.refreshFolder(),this.fileDataListener(),this.isUpdatingFileListener(),this.isRenamingFileListener(),this.isUploadingFilesListener(),this.isUploadingFolderListener(),this.isUpdatingFolderListener(),setTimeout(()=>{this.overwriteKeyHandler()},1500)}ngOnDestroy(){this.containerDataListener().unsubscribe(),this.fileDataListener().unsubscribe(),this.isUpdatingFileListener().unsubscribe(),this.isRenamingFileListener().unsubscribe(),this.isUploadingFilesListener().unsubscribe(),this.isUploadingFolderListener().unsubscribe(),this.isUpdatingFolderListener().unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(s.F0),a.Y36(qi.d),a.Y36(Gi.V))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-file-management"]],viewQuery:function(e,t){if(1&e&&a.Gf(Ni,5),2&e){let e;a.iGM(e=a.CRH())&&(t.dxFileManager=e.first)}},hostBindings:function(e,t){1&e&&a.NdJ("keyup",function(e){return t.handleKeyboardEvent(e)},!1,a.evT)},decls:5,vars:11,consts:[[4,"ngIf"],["id","key-shortcut-popup",3,"height","width","showTitle","shading","showCloseButton","title","visible","visibleChange"],[4,"dxTemplate","dxTemplateOf"],["icon","warning","label","Key Shortcut",3,"index","onClick"],["icon","like","label","Sub Menu 2",3,"index"],["id","fileManager","height","'100%'",3,"fileSystemProvider","onSelectedFileOpened","onSelectionChanged","onToolbarItemClick","onContextMenuItemClick","onOptionChanged"],[3,"showParentFolder"],["name","showNavPane","visible","true"],["name","separator"],["widget","dxMenu","location","before","locateInMenu","auto",3,"options"],["widget","dxMenu","location","before","locateInMenu","auto",3,"options",4,"ngIf"],["widget","dxMenu","location","after","locateInMenu","auto",3,"options"],["name","separator","location","after"],["name","switchView"],["id","photo-popup",3,"height","width","showTitle","shading","showCloseButton","title","visible","visibleChange"],["id","update-file-popup",3,"height","width","showTitle","shading","showCloseButton","title","visible","visibleChange"],["id","rename-file-popup",3,"height","width","showTitle","shading","showCloseButton","title","visible","visibleChange"],["id","upload-batch-popup",3,"height","width","showTitle","shading","showCloseButton","title","visible","visibleChange"],["id","upload-folder-popup",3,"height","width","showTitle","shading","showCloseButton","title","visible","visibleChange"],["id","rename-folder-popup",3,"height","width","showTitle","shading","showCloseButton","title","visible","visibleChange"],["dataField","thumbnail","caption","Preview",3,"width"],["dataField","name","caption","Title"],["dataField","type","caption","Type",3,"width"],["dataField","size","caption","Size",3,"width"],["dataField","dateModified","caption","Date Modified"],["dataField","thumbnail","caption","...",3,"width"],["dataField","name","caption","Name"],["name","clearSelection","locateInMenu","auto"],["name","newFolder","text","New Folder","icon","newfolder","beginGroup","true"],["name","deleteFolder","text","Delete Folder","icon","trash"],["name","updateFolder","text","Rename Folder","icon","edit","beginGroup","true"],["name","downloadImage","text","Download Image","icon","download","beginGroup","true"],["name","newImage","text","New image","icon","plus","beginGroup","true"],["name","deleteImage","text","Delete image","icon","trash"],["name","updateFile","text","Link Source","icon","link","beginGroup","true"],["name","renameFile","text","Rename File","icon","edit","beginGroup","true"],[3,"bounceEnabled","scrollByContent","scrollByThumb","height","width"],[1,"photo-popup-content"],[1,"img-container"],["alt","...",3,"src"],[1,"info-container"],[3,"selectedItem"],[3,"directory"],[3,"directory","selectedItem"],[2,"display","flex","justify-content","center","align-items","flex-start","flex-direction","column"]],template:function(e,t){1&e&&(a.YNc(0,rs,33,61,"ng-container",0),a.TgZ(1,"dx-popup",1),a.NdJ("visibleChange",function(e){return t.isKeyShortcutPopupVisible=e}),a.YNc(2,as,21,5,"div",2),a.qZA(),a.TgZ(3,"dx-speed-dial-action",3),a.NdJ("onClick",function(){return t.showKeyShortcut()}),a.qZA(),a._UZ(4,"dx-speed-dial-action",4)),2&e&&(a.Q6J("ngIf",t.fileItems),a.xp6(1),a.Q6J("height","70%")("width","70%")("showTitle",!0)("shading",!0)("showCloseButton",!0)("title","Keyboard Shortcut")("visible",t.isKeyShortcutPopupVisible),a.xp6(1),a.Q6J("dxTemplateOf","content"),a.xp6(1),a.Q6J("index",1),a.xp6(1),a.Q6J("index",2))},directives:[o.O5,ji.x,zi.p6,Qi.D,Ni,$i.FQg,$i.Zo,$i.y1f,$i.ZT3,$i.uhE,$i.qvW,$i.F_4,Ji.N,Io,xo,Zo,Ko,zo],styles:[".img-container[_ngcontent-%COMP%]{display:flex;justify-content:center;height:100%;width:70%;align-items:center;margin:10px}.info-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:10px}.info-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:700;border-bottom:2px solid orchid}@media screen and (max-width:450px){.photo-popup-content[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-evenly;align-items:flex-start;font-size:large}.info-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;height:100%;width:100%;align-items:flex-start;margin-bottom:5px}.img-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100px;width:100px;border-radius:5px;box-shadow:0 25px 50px -12px #4fcdff40}}@media screen and (min-width:451px){.photo-popup-content[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-evenly;align-items:flex-start;font-size:large}.info-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;height:100%;width:30%;align-items:flex-start;margin-bottom:5px}.img-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:100%;border-radius:5px;box-shadow:0 25px 50px -12px #4fcdff40}}"]}),e})()}];let hs=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[s.Bz.forChild(ls)],s.Bz]}),e})(),ds=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[o.ez,hs,Hi,ji.C,Ji.r,Wi.A,Oo,po,ro.D,Qi.B]]}),e})()},91019:(e,t,i)=>{"use strict";i.d(t,{Y:()=>n});var o=i(42693),s=i(8619);let n=(()=>{class e{constructor(e){this.http=e,this.apiUrl="https://ta-sys-online-server.azurewebsites.net/api/Course"}fetchCourse(e,t){const i=(new o.LE).set("PageNumber",e).set("PageSize",t);return console.log(i.toString()),this.http.get(this.apiUrl+"/paging",{params:i,reportProgress:!0,observe:"body"})}fetchCourseByLearnerID(e,t,i){const s=(new o.LE).set("PageNumber",e).set("PageSize",t).set("Id",i);return console.log(s.toString()),this.http.get(this.apiUrl+"/byLearnerID",{params:s,reportProgress:!0,observe:"body"})}searchCourseByProperty(e,t,i,s){const n=(new o.LE).set("Property",e).set("Value",t).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl+"/search",{params:n,reportProgress:!0,observe:"body"})}filterCourseByProperty(e,t,i,s){const n=(new o.LE).set("Value",t).set("Property",e).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl+"/filter",{params:n,reportProgress:!0,observe:"body"})}sortCourseByProperty(e,t,i,s){const n=(new o.LE).set("SortBy",e).set("Order",t).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl+"/paging",{params:n,reportProgress:!0,observe:"body"})}uploadCourse(e){return this.http.post(this.apiUrl,e,{reportProgress:!0,observe:"body"})}generateRandomCourse(){return this.http.post(this.apiUrl+"/randomCourse",{reportProgress:!0,observe:"body"})}deleteCourse(e){return this.http.post(this.apiUrl+"/delete",e,{reportProgress:!0,observe:"body"})}deleteAll(){return this.http.delete(this.apiUrl,{reportProgress:!0,observe:"body"})}getCourse(e){return this.http.get(this.apiUrl+`/${e}`,{reportProgress:!0,observe:"body"})}updateCourse(e){return this.http.put(this.apiUrl,e,{reportProgress:!0,observe:"body"})}fetchAll(){return this.http.get(this.apiUrl,{reportProgress:!0,observe:"body"})}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(o.eN))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},98439:(e,t,i)=>{"use strict";i.d(t,{L:()=>n});var o=i(42693),s=i(8619);let n=(()=>{class e{constructor(e){this.http=e,this.apiUrl="https://ta-sys-online-server.azurewebsites.net/api/Lesson"}fetchLesson(e,t){const i=(new o.LE).set("PageNumber",e).set("PageSize",t);return console.log(i.toString()),this.http.get(this.apiUrl+"/paging",{params:i,reportProgress:!0,observe:"body"})}fetchLessonByLearnerID(e,t,i){const s=(new o.LE).set("PageNumber",e).set("PageSize",t).set("Id",i);return console.log(s.toString()),this.http.get(this.apiUrl+"/byLearnerID",{params:s,reportProgress:!0,observe:"body"})}searchLessonByProperty(e,t,i,s){const n=(new o.LE).set("Property",e).set("Value",t).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl+"/search",{params:n,reportProgress:!0,observe:"body"})}filterLessonByProperty(e,t,i,s){const n=(new o.LE).set("Value",t).set("Property",e).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl+"/filter",{params:n,reportProgress:!0,observe:"body"})}filterSearchLessonByProperty(e,t,i,s,n,r){const a=(new o.LE).set("FilterValue",t).set("FilterProperty",e).set("SearchValue",s).set("SearchProperty",i).set("PageNumber",n).set("PageSize",r);return console.log(a.toString()),this.http.get(this.apiUrl+"/filter-search",{params:a,reportProgress:!0,observe:"body"})}sortLessonByProperty(e,t,i,s){const n=(new o.LE).set("SortBy",e).set("Order",t).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl+"/paging",{params:n,reportProgress:!0,observe:"body"})}uploadLesson(e){return this.http.post(this.apiUrl,e,{reportProgress:!0,observe:"body"})}generateRandomLesson(){return this.http.post(this.apiUrl+"/randomLesson",{reportProgress:!0,observe:"body"})}deleteLesson(e){return this.http.post(this.apiUrl+"/delete",e,{reportProgress:!0,observe:"body"})}deleteAll(){return this.http.delete(this.apiUrl,{reportProgress:!0,observe:"body"})}getLesson(e){return this.http.get(this.apiUrl+`/${e}`,{reportProgress:!0,observe:"body"})}updateLesson(e){return this.http.put(this.apiUrl,e,{reportProgress:!0,observe:"body"})}fetchAll(){return this.http.get(this.apiUrl,{reportProgress:!0,observe:"body"})}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(o.eN))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},53938:(e,t,i)=>{"use strict";i.d(t,{Q:()=>n});var o=i(42693),s=i(8619);let n=(()=>{class e{constructor(e){this.http=e,this.apiUrl="https://ta-sys-online-server.azurewebsites.net/api/Question"}fetchQuestion(e,t){const i=(new o.LE).set("PageNumber",e).set("PageSize",t);return console.log(i.toString()),this.http.get(this.apiUrl+"/paging",{params:i,reportProgress:!0,observe:"body"})}fetchQuestionByLearnerID(e,t,i){const s=(new o.LE).set("PageNumber",e).set("PageSize",t).set("Id",i);return console.log(s.toString()),this.http.get(this.apiUrl+"/byLearnerID",{params:s,reportProgress:!0,observe:"body"})}searchQuestionByProperty(e,t,i,s){const n=(new o.LE).set("Property",e).set("Value",t).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl+"/search",{params:n,reportProgress:!0,observe:"body"})}filterQuestionByProperty(e,t,i,s){const n=(new o.LE).set("Value",t).set("Property",e).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl+"/filter",{params:n,reportProgress:!0,observe:"body"})}filterSearchQuestionByProperty(e,t,i,s,n,r){const a=(new o.LE).set("FilterValue",t).set("FilterProperty",e).set("SearchValue",s).set("SearchProperty",i).set("PageNumber",n).set("PageSize",r);return console.log(a.toString()),this.http.get(this.apiUrl+"/filter-search",{params:a,reportProgress:!0,observe:"body"})}sortQuestionByProperty(e,t,i,s){const n=(new o.LE).set("SortBy",e).set("Order",t).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl+"/paging",{params:n,reportProgress:!0,observe:"body"})}uploadQuestion(e){return this.http.post(this.apiUrl,e,{reportProgress:!0,observe:"body"})}generateRandomQuestion(){return this.http.post(this.apiUrl+"/randomQuestion",{reportProgress:!0,observe:"body"})}deleteQuestion(e){return this.http.post(this.apiUrl+"/delete",e,{reportProgress:!0,observe:"body"})}deleteAll(){return this.http.delete(this.apiUrl,{reportProgress:!0,observe:"body"})}getQuestion(e){return this.http.get(this.apiUrl+`/${e}`,{reportProgress:!0,observe:"body"})}updateQuestion(e){return this.http.put(this.apiUrl,e,{reportProgress:!0,observe:"body"})}fetchAll(){return this.http.get(this.apiUrl,{reportProgress:!0,observe:"body"})}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(o.eN))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},1100:(e,t,i)=>{"use strict";i.d(t,{L:()=>n});var o=i(42693),s=i(8619);let n=(()=>{class e{constructor(e){this.http=e,this.apiUrl="https://ta-sys-online-server.azurewebsites.net/api/Subject"}fetchSubject(e,t){const i=(new o.LE).set("PageNumber",e).set("PageSize",t);return console.log(i.toString()),this.http.get(this.apiUrl+"/paging",{params:i,reportProgress:!0,observe:"body"})}fetchSubjectByLearnerID(e,t,i){const s=(new o.LE).set("PageNumber",e).set("PageSize",t).set("Id",i);return console.log(s.toString()),this.http.get(this.apiUrl+"/byLearnerID",{params:s,reportProgress:!0,observe:"body"})}searchSubjectByProperty(e,t,i,s){const n=(new o.LE).set("Property",e).set("Value",t).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl+"/search",{params:n,reportProgress:!0,observe:"body"})}filterSubjectByProperty(e,t,i,s){const n=(new o.LE).set("Property",e).set("Value",t).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl,{params:n,reportProgress:!0,observe:"body"})}sortSubjectByProperty(e,t,i,s){const n=(new o.LE).set("SortBy",e).set("Order",t).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl+"/paging",{params:n,reportProgress:!0,observe:"body"})}uploadSubject(e){return this.http.post(this.apiUrl,e,{reportProgress:!0,observe:"body"})}generateRandomSubject(){return this.http.post(this.apiUrl+"/randomSubject",{reportProgress:!0,observe:"body"})}deleteAllSubjects(){return this.http.post(this.apiUrl+"/deleteAll",{reportProgress:!0,observe:"body"})}deleteSubject(e){const t=(new o.LE).set("subjectId",e);return this.http.delete(this.apiUrl,{reportProgress:!0,params:t,observe:"body"})}getSubject(e){return this.http.get(this.apiUrl+`/${e}`,{reportProgress:!0,observe:"body"})}deleteSelectedSubjects(e){return this.http.post(this.apiUrl+"/batch",e,{reportProgress:!0,observe:"body"})}updateSubject(e){return this.http.put(this.apiUrl,e,{reportProgress:!0,observe:"body"})}fetchAll(){return this.http.get(this.apiUrl,{reportProgress:!0,observe:"body"})}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(o.eN))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},12819:(e,t,i)=>{"use strict";i.d(t,{v:()=>n});var o=i(42693),s=i(8619);let n=(()=>{class e{constructor(e){this.http=e,this.apiUrl="https://ta-sys-online-server.azurewebsites.net/api/Test"}fetchTest(e,t){const i=(new o.LE).set("PageNumber",e).set("PageSize",t);return console.log(i.toString()),this.http.get(this.apiUrl+"/paging",{params:i,reportProgress:!0,observe:"body"})}fetchTestByLearnerID(e,t,i){const s=(new o.LE).set("PageNumber",e).set("PageSize",t).set("Id",i);return console.log(s.toString()),this.http.get(this.apiUrl+"/byLearnerID",{params:s,reportProgress:!0,observe:"body"})}searchTestByProperty(e,t,i,s){const n=(new o.LE).set("Property",e).set("Value",t).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl+"/search",{params:n,reportProgress:!0,observe:"body"})}filterTestByProperty(e,t,i,s){const n=(new o.LE).set("Value",t).set("Property",e).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl+"/filter",{params:n,reportProgress:!0,observe:"body"})}filterSearchTestByProperty(e,t,i,s,n,r){const a=(new o.LE).set("FilterValue",t).set("FilterProperty",e).set("SearchValue",s).set("SearchProperty",i).set("PageNumber",n).set("PageSize",r);return console.log(a.toString()),this.http.get(this.apiUrl+"/filter-search",{params:a,reportProgress:!0,observe:"body"})}sortTestByProperty(e,t,i,s){const n=(new o.LE).set("SortBy",e).set("Order",t).set("PageNumber",i).set("PageSize",s);return console.log(n.toString()),this.http.get(this.apiUrl+"/paging",{params:n,reportProgress:!0,observe:"body"})}uploadTest(e){return this.http.post(this.apiUrl,e,{reportProgress:!0,observe:"body"})}generateRandomTest(){return this.http.post(this.apiUrl+"/randomTest",{reportProgress:!0,observe:"body"})}deleteTest(e){return this.http.post(this.apiUrl+"/delete",e,{reportProgress:!0,observe:"body"})}deleteAll(){return this.http.delete(this.apiUrl,{reportProgress:!0,observe:"body"})}getTest(e){return this.http.get(this.apiUrl+`/${e}`,{reportProgress:!0,observe:"body"})}updateTest(e){return this.http.put(this.apiUrl,e,{reportProgress:!0,observe:"body"})}fetchAll(){return this.http.get(this.apiUrl,{reportProgress:!0,observe:"body"})}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(o.eN))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);