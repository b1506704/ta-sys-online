(self.webpackChunkta_sys_online=self.webpackChunkta_sys_online||[]).push([[544],{98439:(t,s,e)=>{"use strict";e.d(s,{L:()=>i});var o=e(42693),r=e(8619);let i=(()=>{class t{constructor(t){this.http=t,this.apiUrl="https://ta-sys-online-server.azurewebsites.net/api/Lesson"}fetchLesson(t,s){const e=(new o.LE).set("PageNumber",t).set("PageSize",s);return console.log(e.toString()),this.http.get(this.apiUrl+"/paging",{params:e,reportProgress:!0,observe:"body"})}fetchLessonByLearnerID(t,s,e){const r=(new o.LE).set("PageNumber",t).set("PageSize",s).set("Id",e);return console.log(r.toString()),this.http.get(this.apiUrl+"/byLearnerID",{params:r,reportProgress:!0,observe:"body"})}searchLessonByProperty(t,s,e,r){const i=(new o.LE).set("Property",t).set("Value",s).set("PageNumber",e).set("PageSize",r);return console.log(i.toString()),this.http.get(this.apiUrl+"/search",{params:i,reportProgress:!0,observe:"body"})}filterLessonByProperty(t,s,e,r){const i=(new o.LE).set("Value",s).set("Property",t).set("PageNumber",e).set("PageSize",r);return console.log(i.toString()),this.http.get(this.apiUrl+"/filter",{params:i,reportProgress:!0,observe:"body"})}filterSearchLessonByProperty(t,s,e,r,i,a){const n=(new o.LE).set("FilterValue",s).set("FilterProperty",t).set("SearchValue",r).set("SearchProperty",e).set("PageNumber",i).set("PageSize",a);return console.log(n.toString()),this.http.get(this.apiUrl+"/filter-search",{params:n,reportProgress:!0,observe:"body"})}sortLessonByProperty(t,s,e,r){const i=(new o.LE).set("SortBy",t).set("Order",s).set("PageNumber",e).set("PageSize",r);return console.log(i.toString()),this.http.get(this.apiUrl+"/paging",{params:i,reportProgress:!0,observe:"body"})}uploadLesson(t){return this.http.post(this.apiUrl,t,{reportProgress:!0,observe:"body"})}generateRandomLesson(){return this.http.post(this.apiUrl+"/randomLesson",{reportProgress:!0,observe:"body"})}deleteLesson(t){return this.http.post(this.apiUrl+"/delete",t,{reportProgress:!0,observe:"body"})}deleteAll(){return this.http.delete(this.apiUrl,{reportProgress:!0,observe:"body"})}getLesson(t){return this.http.get(this.apiUrl+`/${t}`,{reportProgress:!0,observe:"body"})}updateLesson(t){return this.http.put(this.apiUrl,t,{reportProgress:!0,observe:"body"})}fetchAll(){return this.http.get(this.apiUrl,{reportProgress:!0,observe:"body"})}}return t.\u0275fac=function(s){return new(s||t)(r.LFG(o.eN))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},7544:(t,s,e)=>{"use strict";e.d(s,{V:()=>c});var o=e(61305),r=e(41142),i=e(8619),a=e(98439),n=e(10418),l=e(6614);const h={lessonList:[],selectedLesson:{},lessonInstance:void 0,exportData:[],totalPages:0,currentPage:0,totalItems:0,responseMsg:""};let c=(()=>{class t extends o.b{constructor(t,s,e){super(h),this.lessonService=t,this.store=s,this.fileStore=e,this.$lessonList=this.select(t=>t.lessonList),this.$exportData=this.select(t=>t.exportData),this.$totalPages=this.select(t=>t.totalPages),this.$totalItems=this.select(t=>t.totalItems),this.$currentPage=this.select(t=>t.currentPage),this.$selectedLesson=this.select(t=>t.selectedLesson),this.$lessonInstance=this.select(t=>t.lessonInstance)}fillEmpty(t,s,e,o){let r=e;console.log("FILL INDEX");let i=t*s;console.log(i);for(var a=0;a<o.length;a++)r[i]=o[a],i++;return console.log("Filled array result"),console.log(r),r}fetchMediaBySourceID(t){const s=t.map(t=>t.id);this.fileStore.getFiles(s)}initInfiniteData(t,s){return this.lessonService.fetchLesson(t,s).toPromise().then(t=>{this.setState({lessonList:t.data}),this.fetchMediaBySourceID(t.data),console.log("Current flag: infite list"),console.log(this.state.lessonList),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber})})}loadInfiniteDataAsync(t,s){this.setIsLoading(!0),this.lessonService.fetchLesson(t,s).subscribe({next:t=>{this.setState({lessonList:this.state.lessonList.concat(t.data)}),console.log("Infinite list"),console.log(this.state.lessonList),console.log("Server response"),console.log(t),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}loadDataAsyncByLearnerID(t,s,e){this.setIsLoading(!0),this.lessonService.fetchLessonByLearnerID(t,s,e).subscribe({next:e=>{this.setState({lessonList:this.fillEmpty(t-1,s,this.state.lessonList,e.data)}),console.log("Pure list"),console.log(this.state.lessonList),console.log("Server response"),console.log(e),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}initInfiniteDataByLearnerID(t,s,e){return this.lessonService.fetchLessonByLearnerID(t,s,e).toPromise().then(t=>{this.setState({lessonList:t.data}),console.log("Current flag: infite list"),console.log(this.state.lessonList),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber})})}loadInfiniteDataAsyncByLearnerID(t,s,e){this.setIsLoading(!0),this.lessonService.fetchLessonByLearnerID(t,s,e).subscribe({next:t=>{this.setState({lessonList:this.state.lessonList.concat(t.data)}),console.log("Infinite list"),console.log(this.state.lessonList),console.log("Server response"),console.log(t),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}initData(t,s){this.lessonService.fetchLesson(t,s).toPromise().then(t=>{this.setState({lessonList:new Array(t.totalRecords)}),console.log("Current flag: pure list"),console.log(this.state.lessonList),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber})}).then(()=>{this.loadDataAsync(t,s)})}initFilterByPropertyData(t,s,e,o){this.store.showNotif("Filtered Mode On","custom"),this.lessonService.filterLessonByProperty(t,s,e,o).toPromise().then(t=>{this.setState({lessonList:new Array(t.totalRecords)}),console.log("Current flag: filtered list"),console.log(this.state.lessonList),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber})}).then(()=>{this.filterLessonByProperty(t,s,e,o)})}initInfiniteFilterByPropertyData(t,s,e,o){this.store.showNotif("Filtered Mode On","custom"),this.lessonService.filterLessonByProperty(t,s,e,o).toPromise().then(t=>{this.setState({lessonList:t.data}),this.fetchMediaBySourceID(t.data),console.log("Current flag: infinite filtered list"),console.log(this.state.lessonList),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber})})}initSearchByPropertyData(t,s,e,o){this.store.showNotif("Searched Mode On","custom"),this.lessonService.searchLessonByProperty(t,s,e,o).toPromise().then(t=>{this.setState({lessonList:new Array(t.totalRecords)}),console.log("Current flag: searched list"),console.log(this.state.lessonList),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber})}).then(()=>{this.searchLessonByProperty(t,s,e,o)})}initInfiniteSearchByPropertyData(t,s,e,o){this.store.showNotif("Searched Mode On","custom"),this.lessonService.searchLessonByProperty(t,s,e,o).toPromise().then(t=>{0!==t.totalRecords?(this.setState({lessonList:t.data}),this.fetchMediaBySourceID(t.data)):this.store.showNotif("No result found!","custom"),console.log("Current flag: infitite searched list"),console.log(this.state.lessonList),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber})})}initInfiniteFilterSearchByPropertyData(t,s,e,o,r,i){this.store.showNotif("Searched Mode On","custom"),this.lessonService.filterSearchLessonByProperty(t,s,e,o,r,i).toPromise().then(t=>{0!==t.totalRecords?(this.setState({lessonList:t.data}),this.fetchMediaBySourceID(t.data)):this.store.showNotif("No result found!","custom"),console.log("Current flag: infitite searched list"),console.log(this.state.lessonList),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber})})}initSortByPropertyData(t,s,e,o){this.store.showNotif("Sort Mode On","custom"),this.lessonService.sortLessonByProperty(t,s,e,o).toPromise().then(t=>{this.setState({lessonList:new Array(t.totalRecords)}),console.log("Current flag: sort list"),console.log(this.state.lessonList),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber})}).then(()=>{this.sortLessonByProperty(t,s,e,o)})}initInfiniteSortByPropertyData(t,s,e,o){this.store.showNotif("Sort Mode On","custom"),this.lessonService.sortLessonByProperty(t,s,e,o).toPromise().then(t=>{this.setState({lessonList:t.data}),this.fetchMediaBySourceID(t.data),console.log("Current flag: sort list"),console.log(this.state.lessonList),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber})})}loadDataAsync(t,s){this.setIsLoading(!0),this.lessonService.fetchLesson(t,s).subscribe({next:e=>{this.setState({lessonList:this.fillEmpty(t-1,s,this.state.lessonList,e.data)}),console.log("Pure list"),console.log(this.state.lessonList),console.log("Server response"),console.log(e),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}refresh(t,s){this.setIsLoading(!0),this.lessonService.fetchLesson(t,s).subscribe({next:e=>{this.setState({lessonList:this.fillEmpty(t-1,s,this.state.lessonList,e.data)}),this.setState({totalItems:e.totalRecords}),this.setState({totalPages:e.totalPages}),this.setState({currentPage:e.pageNumber}),console.log("Pure list"),console.log(this.state.lessonList),console.log("Server response"),console.log(e),this.store.showNotif("Refresh successfully","custom"),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}setIsLoading(t){this.store.setIsLoading(t)}uploadLesson(t,s,e){this.confirmDialog("").then(o=>{o&&(this.setIsLoading(!0),this.lessonService.uploadLesson(t).subscribe({next:t=>{this.setState({responseMsg:t}),this.setTotalItems(this.state.totalItems+1),console.log(t),this.loadDataAsync(s,e),this.setIsLoading(!1),this.store.showNotif(t.responseMessage,"custom")},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}}))})}updateLesson(t,s,e){this.confirmDialog("").then(o=>{o&&(this.setIsLoading(!0),this.lessonService.updateLesson(t).subscribe({next:t=>{this.setState({responseMsg:t}),console.log(t),this.loadDataAsync(s,e),this.setIsLoading(!1),this.store.showNotif(t.responseMessage,"custom")},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}}))})}confirmDialog(t){return(0,r.iG)(""!=t?`<b>${t}</b>`:"<b>Are you sure?</b>","Confirm changes")}deleteSelectedLessons(t,s,e){this.confirmDialog("").then(o=>{o&&(this.setIsLoading(!0),this.lessonService.deleteLesson(t).subscribe({next:t=>{this.setState({responseMsg:t}),console.log(t),this.loadDataAsync(s,e),console.log(this.state.lessonList),this.setIsLoading(!1),this.store.showNotif(t.responseMessage,"custom")},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}}))})}deleteAll(){this.confirmDialog("Delete all items?").then(t=>{t&&(this.setIsLoading(!0),this.lessonService.deleteAll().subscribe({next:t=>{this.resetState(),console.log(t),this.setIsLoading(!1),this.store.showNotif(t.responseMessage,"custom")},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}}))})}deleteLesson(t,s,e){this.confirmDialog("").then(o=>{o&&(this.setIsLoading(!0),this.lessonService.deleteLesson(t).subscribe({next:t=>{this.setState({responseMsg:t}),this.setTotalItems(this.state.totalItems-1),console.log(t),this.loadDataAsync(s,e),this.setIsLoading(!1),this.store.showNotif(t.responseMessage,"custom")},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}}))})}selectLesson(t){this.setState({selectedLesson:t})}setTotalPages(t){this.setState({totalPages:t})}setTotalItems(t){this.setState({totalItems:t})}setCurrentPage(t){this.setState({currentPage:t})}filterLessonByProperty(t,s,e,o){this.setIsLoading(!0),this.lessonService.filterLessonByProperty(t,s,e,o).subscribe({next:t=>{0!==t.totalRecords&&(this.setState({lessonList:this.fillEmpty(e-1,o,this.state.lessonList,t.data)}),console.log("Filtered list"),console.log(this.state.lessonList),console.log("Server response"),console.log(t),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber})),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}filterInfiniteLessonByProperty(t,s,e,o){this.setIsLoading(!0),this.lessonService.filterLessonByProperty(t,s,e,o).subscribe({next:t=>{t.data.length&&(this.setState({lessonList:this.state.lessonList.concat(t.data)}),this.fetchMediaBySourceID(t.data)),console.log("Filtered list"),console.log(this.state.lessonList),console.log("Server response"),console.log(t),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}filterSearchInfiniteLessonByProperty(t,s,e,o,r,i){this.setIsLoading(!0),this.lessonService.filterSearchLessonByProperty(t,s,e,o,r,i).subscribe({next:t=>{0!==t.totalRecords?t.data.length&&(this.setState({lessonList:this.state.lessonList.concat(t.data)}),this.fetchMediaBySourceID(t.data)):this.store.showNotif("No result found!","custom"),console.log("Infite searched list"),console.log(this.state.lessonList),console.log("Server response"),console.log(t),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}searchLessonByProperty(t,s,e,o){this.setIsLoading(!0),this.lessonService.searchLessonByProperty(t,s,e,o).subscribe({next:t=>{0!==t.totalRecords?this.setState({lessonList:this.fillEmpty(e-1,o,this.state.lessonList,t.data)}):this.store.showNotif("No result found!","custom"),console.log("Searched list"),console.log(this.state.lessonList),console.log("Server response"),console.log(t),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}searchInfiniteLessonByProperty(t,s,e,o){this.setIsLoading(!0),this.lessonService.searchLessonByProperty(t,s,e,o).subscribe({next:t=>{0!==t.totalRecords?t.data.length&&(this.setState({lessonList:this.state.lessonList.concat(t.data)}),this.fetchMediaBySourceID(t.data)):this.store.showNotif("No result found!","custome"),console.log("Infite searched list"),console.log(this.state.lessonList),console.log("Server response"),console.log(t),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}sortLessonByProperty(t,s,e,o){this.setIsLoading(!0),this.lessonService.sortLessonByProperty(t,s,e,o).subscribe({next:t=>{this.setState({responseMsg:t}),this.setState({lessonList:this.fillEmpty(e-1,o,this.state.lessonList,t.data)}),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber}),console.log("Sorted list"),console.log(this.state.lessonList),console.log("Server response"),console.log(t),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}sortInfiniteLessonByProperty(t,s,e,o){this.setIsLoading(!0),this.lessonService.sortLessonByProperty(t,s,e,o).subscribe({next:t=>{t.data.length&&(this.setState({lessonList:this.state.lessonList.concat(t.data)}),this.fetchMediaBySourceID(t.data)),console.log("Infite sorted list"),console.log(this.state.lessonList),console.log("Server response"),console.log(t),this.setState({totalItems:t.totalRecords}),this.setState({totalPages:t.totalPages}),this.setState({currentPage:t.pageNumber}),this.setIsLoading(!1)},error:t=>{this.setIsLoading(!1),this.store.showNotif(t.error.responseMessage,"error"),console.log(t)}})}getLesson(t){return this.setIsLoading(!0),this.lessonService.getLesson(t).toPromise().then(t=>{this.setState({lessonInstance:t}),console.log(t),this.setIsLoading(!1)})}setExportData(t){this.setState({lessonList:t})}resetState(){this.setState(h)}}return t.\u0275fac=function(s){return new(s||t)(i.LFG(a.L),i.LFG(n.d),i.LFG(l.V))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);